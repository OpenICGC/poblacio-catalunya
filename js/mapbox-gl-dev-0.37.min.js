/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 @license  MIT
*/
var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(M,a,k){if(k.get||k.set)throw new TypeError("ES3 does not support getters and setters.");M!=Array.prototype&&M!=Object.prototype&&(M[a]=k.value)};$jscomp.getGlobal=function(M){return"undefined"!=typeof window&&window===M?M:"undefined"!=typeof global&&null!=global?global:M};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(M){return $jscomp.SYMBOL_PREFIX+(M||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var M=$jscomp.global.Symbol.iterator;M||(M=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[M]&&$jscomp.defineProperty(Array.prototype,M,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(M){var a=0;return $jscomp.iteratorPrototype(function(){return a<M.length?{done:!1,value:M[a++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(M){$jscomp.initSymbolIterator();M={next:M};M[$jscomp.global.Symbol.iterator]=function(){return this};return M};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(M,a){$jscomp.initSymbolIterator();M instanceof String&&(M+="");var k=0,m={next:function(){if(k<M.length){var f=k++;return{value:a(f,M[f]),done:!1}}m.next=function(){return{done:!0,value:void 0}};return m.next()}};m[Symbol.iterator]=function(){return m};return m};
$jscomp.polyfill=function(M,a,k,m){if(a){k=$jscomp.global;M=M.split(".");for(m=0;m<M.length-1;m++){var f=M[m];f in k||(k[f]={});k=k[f]}M=M[M.length-1];m=k[M];a=a(m);a!=m&&null!=a&&$jscomp.defineProperty(k,M,{configurable:!0,writable:!0,value:a})}};$jscomp.polyfill("Array.prototype.keys",function(M){return M?M:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.fill",function(M){return M?M:function(a,k,m){var f=this.length||0;0>k&&(k=Math.max(0,f+k));if(null==m||m>f)m=f;m=Number(m);0>m&&(m=Math.max(0,f+m));for(k=Number(k||0);k<m;k++)this[k]=a;return this}},"es6-impl","es3");$jscomp.polyfill("Array.prototype.values",function(M){return M?M:function(){return $jscomp.iteratorFromArray(this,function(a,k){return k})}},"es6","es3");
$jscomp.checkStringArgs=function(M,a,k){if(null==M)throw new TypeError("The 'this' value for String.prototype."+k+" must not be null or undefined");if(a instanceof RegExp)throw new TypeError("First argument to String.prototype."+k+" must not be a regular expression");return M+""};
$jscomp.polyfill("String.prototype.endsWith",function(M){return M?M:function(a,k){var m=$jscomp.checkStringArgs(this,a,"endsWith");a+="";void 0===k&&(k=m.length);for(var f=Math.max(0,Math.min(k|0,m.length)),d=a.length;0<d&&0<f;)if(m[--f]!=a[--d])return!1;return 0>=d}},"es6-impl","es3");
(function(M){"object"===typeof exports&&"undefined"!==typeof module?module.exports=M():"function"===typeof define&&define.amd?define([],M):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).mapboxgl=M()})(function(){return function a(k,m,f){function d(c,g){if(!m[c]){if(!k[c]){var h="function"==typeof require&&require;if(!g&&h)return h(c,!0);if(n)return n(c,!0);h=Error("Cannot find module '"+c+"'");throw h.code="MODULE_NOT_FOUND",h;}h=m[c]={exports:{}};
k[c][0].call(h.exports,function(e){var b=k[c][1][e];return d(b?b:e)},h,h.exports,a,k,m,f)}return m[c].exports}for(var n="function"==typeof require&&require,l=0;l<f.length;l++)d(f[l]);return d}({1:[function(a,k,m){(function(f,d){"object"===typeof m&&"undefined"!==typeof k?k.exports=d():f.glMatrix=d()})(this,function(){(function(){var f=new Float32Array(3);f[0]=0;f[1]=0;f[2]=0;return f})();(function(){var f=new Float32Array(4);f[0]=0;f[1]=0;f[2]=0;f[3]=0;return f})();return{vec3:{transformMat3:function(f,
d,a){var l=d[0],c=d[1];d=d[2];f[0]=l*a[0]+c*a[3]+d*a[6];f[1]=l*a[1]+c*a[4]+d*a[7];f[2]=l*a[2]+c*a[5]+d*a[8];return f}},vec4:{transformMat4:function(f,d,a){var l=d[0],c=d[1],g=d[2];d=d[3];f[0]=a[0]*l+a[4]*c+a[8]*g+a[12]*d;f[1]=a[1]*l+a[5]*c+a[9]*g+a[13]*d;f[2]=a[2]*l+a[6]*c+a[10]*g+a[14]*d;f[3]=a[3]*l+a[7]*c+a[11]*g+a[15]*d;return f}},mat2:{create:function(){var f=new Float32Array(4);f[0]=1;f[1]=0;f[2]=0;f[3]=1;return f},rotate:function(f,d,a){var l=d[0],c=d[1],g=d[2];d=d[3];var h=Math.sin(a);a=Math.cos(a);
f[0]=l*a+g*h;f[1]=c*a+d*h;f[2]=l*-h+g*a;f[3]=c*-h+d*a;return f},scale:function(f,d,a){var l=d[1],c=d[2],g=d[3],h=a[0];a=a[1];f[0]=d[0]*h;f[1]=l*h;f[2]=c*a;f[3]=g*a;return f}},mat3:{create:function(){var f=new Float32Array(9);f[0]=1;f[1]=0;f[2]=0;f[3]=0;f[4]=1;f[5]=0;f[6]=0;f[7]=0;f[8]=1;return f},fromRotation:function(f,d){var a=Math.sin(d),l=Math.cos(d);f[0]=l;f[1]=a;f[2]=0;f[3]=-a;f[4]=l;f[5]=0;f[6]=0;f[7]=0;f[8]=1;return f}},mat4:{create:function(){var f=new Float32Array(16);f[0]=1;f[1]=0;f[2]=
0;f[3]=0;f[4]=0;f[5]=1;f[6]=0;f[7]=0;f[8]=0;f[9]=0;f[10]=1;f[11]=0;f[12]=0;f[13]=0;f[14]=0;f[15]=1;return f},identity:function(f){f[0]=1;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=1;f[6]=0;f[7]=0;f[8]=0;f[9]=0;f[10]=1;f[11]=0;f[12]=0;f[13]=0;f[14]=0;f[15]=1;return f},translate:function(f,d,a){var l=a[0],c=a[1];a=a[2];var g,h,e,b,p,q,r,u,n,y,t,v;d===f?(f[12]=d[0]*l+d[4]*c+d[8]*a+d[12],f[13]=d[1]*l+d[5]*c+d[9]*a+d[13],f[14]=d[2]*l+d[6]*c+d[10]*a+d[14],f[15]=d[3]*l+d[7]*c+d[11]*a+d[15]):(g=d[0],h=d[1],e=d[2],
b=d[3],p=d[4],q=d[5],r=d[6],u=d[7],n=d[8],y=d[9],t=d[10],v=d[11],f[0]=g,f[1]=h,f[2]=e,f[3]=b,f[4]=p,f[5]=q,f[6]=r,f[7]=u,f[8]=n,f[9]=y,f[10]=t,f[11]=v,f[12]=g*l+p*c+n*a+d[12],f[13]=h*l+q*c+y*a+d[13],f[14]=e*l+r*c+t*a+d[14],f[15]=b*l+u*c+v*a+d[15]);return f},scale:function(f,d,a){var l=a[0],c=a[1];a=a[2];f[0]=d[0]*l;f[1]=d[1]*l;f[2]=d[2]*l;f[3]=d[3]*l;f[4]=d[4]*c;f[5]=d[5]*c;f[6]=d[6]*c;f[7]=d[7]*c;f[8]=d[8]*a;f[9]=d[9]*a;f[10]=d[10]*a;f[11]=d[11]*a;f[12]=d[12];f[13]=d[13];f[14]=d[14];f[15]=d[15];
return f},multiply:function(f,d,a){var l=d[0],c=d[1],g=d[2],h=d[3],e=d[4],b=d[5],p=d[6],q=d[7],r=d[8],u=d[9],n=d[10],y=d[11],t=d[12],v=d[13],B=d[14];d=d[15];var w=a[0],x=a[1],C=a[2],z=a[3];f[0]=w*l+x*e+C*r+z*t;f[1]=w*c+x*b+C*u+z*v;f[2]=w*g+x*p+C*n+z*B;f[3]=w*h+x*q+C*y+z*d;w=a[4];x=a[5];C=a[6];z=a[7];f[4]=w*l+x*e+C*r+z*t;f[5]=w*c+x*b+C*u+z*v;f[6]=w*g+x*p+C*n+z*B;f[7]=w*h+x*q+C*y+z*d;w=a[8];x=a[9];C=a[10];z=a[11];f[8]=w*l+x*e+C*r+z*t;f[9]=w*c+x*b+C*u+z*v;f[10]=w*g+x*p+C*n+z*B;f[11]=w*h+x*q+C*y+z*d;
w=a[12];x=a[13];C=a[14];z=a[15];f[12]=w*l+x*e+C*r+z*t;f[13]=w*c+x*b+C*u+z*v;f[14]=w*g+x*p+C*n+z*B;f[15]=w*h+x*q+C*y+z*d;return f},perspective:function(f,d,a,l,c){d=1/Math.tan(d/2);var g=1/(l-c);f[0]=d/a;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=d;f[6]=0;f[7]=0;f[8]=0;f[9]=0;f[10]=(c+l)*g;f[11]=-1;f[12]=0;f[13]=0;f[14]=2*c*l*g;f[15]=0;return f},rotateX:function(f,d,a){var l=Math.sin(a);a=Math.cos(a);var c=d[4],g=d[5],h=d[6],e=d[7],b=d[8],p=d[9],q=d[10],r=d[11];d!==f&&(f[0]=d[0],f[1]=d[1],f[2]=d[2],f[3]=d[3],
f[12]=d[12],f[13]=d[13],f[14]=d[14],f[15]=d[15]);f[4]=c*a+b*l;f[5]=g*a+p*l;f[6]=h*a+q*l;f[7]=e*a+r*l;f[8]=b*a-c*l;f[9]=p*a-g*l;f[10]=q*a-h*l;f[11]=r*a-e*l;return f},rotateZ:function(f,d,a){var l=Math.sin(a);a=Math.cos(a);var c=d[0],g=d[1],h=d[2],e=d[3],b=d[4],p=d[5],q=d[6],r=d[7];d!==f&&(f[8]=d[8],f[9]=d[9],f[10]=d[10],f[11]=d[11],f[12]=d[12],f[13]=d[13],f[14]=d[14],f[15]=d[15]);f[0]=c*a+b*l;f[1]=g*a+p*l;f[2]=h*a+q*l;f[3]=e*a+r*l;f[4]=b*a-c*l;f[5]=p*a-g*l;f[6]=q*a-h*l;f[7]=r*a-e*l;return f},invert:function(f,
d){var a=d[0],l=d[1],c=d[2],g=d[3],h=d[4],e=d[5],b=d[6],p=d[7],q=d[8],r=d[9],u=d[10],A=d[11],y=d[12],t=d[13],v=d[14],B=d[15],w=a*e-l*h,x=a*b-c*h,C=a*p-g*h,z=l*b-c*e,E=l*p-g*e,k=c*p-g*b,m=q*t-r*y,I=q*v-u*y,G=q*B-A*y,F=r*v-u*t,K=r*B-A*t,J=u*B-A*v,L=w*J-x*K+C*F+z*G-E*I+k*m;if(!L)return null;L=1/L;f[0]=(e*J-b*K+p*F)*L;f[1]=(c*K-l*J-g*F)*L;f[2]=(t*k-v*E+B*z)*L;f[3]=(u*E-r*k-A*z)*L;f[4]=(b*G-h*J-p*I)*L;f[5]=(a*J-c*G+g*I)*L;f[6]=(v*C-y*k-B*x)*L;f[7]=(q*k-u*C+A*x)*L;f[8]=(h*K-e*G+p*m)*L;f[9]=(l*G-a*K-g*m)*
L;f[10]=(y*E-t*C+B*w)*L;f[11]=(r*C-q*E-A*w)*L;f[12]=(e*I-h*F-b*m)*L;f[13]=(a*F-l*I+c*m)*L;f[14]=(t*x-y*z-v*w)*L;f[15]=(q*z-r*x+u*w)*L;return f},ortho:function(f,d,a,l,c,g,h){var e=1/(d-a),b=1/(l-c),p=1/(g-h);f[0]=-2*e;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=-2*b;f[6]=0;f[7]=0;f[8]=0;f[9]=0;f[10]=2*p;f[11]=0;f[12]=(d+a)*e;f[13]=(c+l)*b;f[14]=(h+g)*p;f[15]=1;return f}}}})},{}],2:[function(a,k,m){(function(f,d){"object"===typeof m&&"undefined"!==typeof k?k.exports=d():f.ShelfPack=d()})(this,function(){function f(d,
c,g){g=g||{};this.w=d||64;this.h=c||64;this.autoResize=!!g.autoResize;this.shelves=[];this.freebins=[];this.stats={};this.bins={};this.maxId=0}function d(d,c,g){this.x=0;this.y=d;this.w=this.free=c;this.h=g}function a(d,c,g,h,e,b,p){this.id=d;this.x=c;this.y=g;this.w=h;this.h=e;this.maxw=b||h;this.maxh=p||e;this.refcount=0}f.prototype.pack=function(d,c){d=[].concat(d);c=c||{};for(var g=[],h,e,b,p=0;p<d.length;p++)if(h=d[p].w||d[p].width,e=d[p].h||d[p].height,b=d[p].id,h&&e&&(h=this.packOne(h,e,b)))c.inPlace&&
(d[p].x=h.x,d[p].y=h.y,d[p].id=h.id),g.push(h);if(0<this.shelves.length){for(e=h=p=0;e<this.shelves.length;e++)b=this.shelves[e],h+=b.h,p=Math.max(b.w-b.free,p);this.resize(p,h)}return g};f.prototype.packOne=function(f,c,g){var h=-1,e=-1,b=Infinity,p=0,q,a;if("string"===typeof g||"number"===typeof g){if(q=this.getBin(g))return this.ref(q),q;"number"===typeof g&&(this.maxId=Math.max(g,this.maxId))}else g=++this.maxId;for(a=0;a<this.freebins.length;a++){q=this.freebins[a];if(c===q.maxh&&f===q.maxw)return this.allocFreebin(a,
f,c,g);!(c>q.maxh||f>q.maxw)&&c<=q.maxh&&f<=q.maxw&&(q=q.maxw*q.maxh-f*c,q<b&&(b=q,h=a))}for(a=0;a<this.shelves.length;a++)if(q=this.shelves[a],p+=q.h,!(f>q.free)){if(c===q.h)return this.allocShelf(a,f,c,g);!(c>q.h)&&c<q.h&&(q=(q.h-c)*f,q<b&&(h=-1,b=q,e=a))}if(-1!==h)return this.allocFreebin(h,f,c,g);if(-1!==e)return this.allocShelf(e,f,c,g);if(c<=this.h-p&&f<=this.w)return q=new d(p,this.w,c),this.allocShelf(this.shelves.push(q)-1,f,c,g);if(this.autoResize){h=e=this.h;b=p=this.w;if(b<=h||f>b)p=2*
Math.max(f,b);if(h<b||c>h)e=2*Math.max(c,h);this.resize(p,e);return this.packOne(f,c,g)}return null};f.prototype.allocFreebin=function(d,c,g,h){d=this.freebins.splice(d,1)[0];d.id=h;d.w=c;d.h=g;d.refcount=0;this.bins[h]=d;this.ref(d);return d};f.prototype.allocShelf=function(d,c,g,h){d=this.shelves[d].alloc(c,g,h);this.bins[h]=d;this.ref(d);return d};f.prototype.getBin=function(d){return this.bins[d]};f.prototype.ref=function(d){if(1===++d.refcount){var c=d.h;this.stats[c]=(this.stats[c]|0)+1}return d.refcount};
f.prototype.unref=function(d){if(0===d.refcount)return 0;0===--d.refcount&&(this.stats[d.h]--,delete this.bins[d.id],this.freebins.push(d));return d.refcount};f.prototype.clear=function(){this.shelves=[];this.freebins=[];this.stats={};this.bins={};this.maxId=0};f.prototype.resize=function(d,c){this.w=d;this.h=c;for(var g=0;g<this.shelves.length;g++)this.shelves[g].resize(d);return!0};d.prototype.alloc=function(d,c,g){if(d>this.free||c>this.h)return null;var h=this.x;this.x+=d;this.free-=d;return new a(g,
h,this.y,d,c,d,this.h)};d.prototype.resize=function(d){this.free+=d-this.w;this.w=d;return!0};return f})},{}],3:[function(a,k,m){function f(d,f,a,c){this.cx=3*d;this.bx=3*(a-d)-this.cx;this.ax=1-this.cx-this.bx;this.cy=3*f;this.by=3*(c-f)-this.cy;this.ay=1-this.cy-this.by;this.p1x=d;this.p1y=c;this.p2x=a;this.p2y=c}k.exports=f;f.prototype.sampleCurveX=function(d){return((this.ax*d+this.bx)*d+this.cx)*d};f.prototype.sampleCurveY=function(d){return((this.ay*d+this.by)*d+this.cy)*d};f.prototype.sampleCurveDerivativeX=
function(d){return(3*this.ax*d+2*this.bx)*d+this.cx};f.prototype.solveCurveX=function(d,f){"undefined"===typeof f&&(f=1E-6);var a,c,g,h;g=d;for(a=0;8>a;a++){h=this.sampleCurveX(g)-d;if(Math.abs(h)<f)return g;c=this.sampleCurveDerivativeX(g);if(1E-6>Math.abs(c))break;g-=h/c}a=0;c=1;g=d;if(g<a)return a;if(g>c)return c;for(;a<c;){h=this.sampleCurveX(g);if(Math.abs(h-d)<f)break;d>h?a=g:c=g;g=.5*(c-a)+a}return g};f.prototype.solve=function(d,f){return this.sampleCurveY(this.solveCurveX(d,f))}},{}],4:[function(a,
k,m){(function(f,d){"object"===typeof m&&"undefined"!==typeof k?d(m):d(f.WhooTS=f.WhooTS||{})})(this,function(f){function d(d,c,g){c=Math.pow(2,g)-c-1;var h=a(256*d,256*c,g);d=a(256*(d+1),256*(c+1),g);return h[0]+","+h[1]+","+d[0]+","+d[1]}function a(d,c,g){g=12756274*Math.PI/256/Math.pow(2,g);return[d*g-12756274*Math.PI/2,c*g-12756274*Math.PI/2]}f.getURL=function(f,c,g,h,e,b){b=b||{};return f+"?"+["bbox="+d(g,h,e),"format="+(b.format||"image/png"),"service="+(b.service||"WMS"),"version="+(b.version||
"1.1.1"),"request="+(b.request||"GetMap"),"srs="+(b.srs||"EPSG:3857"),"width="+(b.width||256),"height="+(b.height||256),"layers="+c].join("&")};f.getTileBBox=d;f.getMercCoords=a;Object.defineProperty(f,"__esModule",{value:!0})})},{}],5:[function(a,k,m){(function(f){function d(b,e){if(b===e)return 0;for(var c=b.length,h=e.length,g=0,d=Math.min(c,h);g<d;++g)if(b[g]!==e[g]){c=b[g];h=e[g];break}return c<h?-1:h<c?1:0}function n(b){return f.Buffer&&"function"===typeof f.Buffer.isBuffer?f.Buffer.isBuffer(b):
!(null==b||!b._isBuffer)}function l(b){return n(b)||"function"!==typeof f.ArrayBuffer?!1:"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(b):b?b instanceof DataView||b.buffer&&b.buffer instanceof ArrayBuffer?!0:!1:!1}function c(b){if(t.isFunction(b))return w?b.name:(b=b.toString().match(C))&&b[1]}function g(b,e){return"string"===typeof b?b.length<e?b:b.slice(0,e):b}function h(b){if(w||!t.isFunction(b))return t.inspect(b);b=c(b);return"[Function"+(b?": "+b:"")+"]"}function e(b,e,c,h,g){throw new x.AssertionError({message:c,
actual:b,expected:e,operator:h,stackStartFunction:g});}function b(b,c){b||e(b,!0,c,"==",x.ok)}function p(b,e,c,h){if(b===e)return!0;if(n(b)&&n(e))return 0===d(b,e);if(t.isDate(b)&&t.isDate(e))return b.getTime()===e.getTime();if(t.isRegExp(b)&&t.isRegExp(e))return b.source===e.source&&b.global===e.global&&b.multiline===e.multiline&&b.lastIndex===e.lastIndex&&b.ignoreCase===e.ignoreCase;if(null!==b&&"object"===typeof b||null!==e&&"object"===typeof e){if(!l(b)||!l(e)||Object.prototype.toString.call(b)!==
Object.prototype.toString.call(e)||b instanceof Float32Array||b instanceof Float64Array){if(n(b)!==n(e))return!1;h=h||{actual:[],expected:[]};var g=h.actual.indexOf(b);if(-1!==g&&g===h.expected.indexOf(e))return!0;h.actual.push(b);h.expected.push(e);return r(b,e,c,h)}return 0===d(new Uint8Array(b.buffer),new Uint8Array(e.buffer))}return c?b===e:b==e}function q(b){return"[object Arguments]"==Object.prototype.toString.call(b)}function r(b,e,c,h){if(null===b||void 0===b||null===e||void 0===e)return!1;
if(t.isPrimitive(b)||t.isPrimitive(e))return b===e;if(c&&Object.getPrototypeOf(b)!==Object.getPrototypeOf(e))return!1;var g=q(b),d=q(e);if(g&&!d||!g&&d)return!1;if(g)return b=B.call(b),e=B.call(e),p(b,e,c);var g=z(b),f=z(e);if(g.length!==f.length)return!1;g.sort();f.sort();for(d=g.length-1;0<=d;d--)if(g[d]!==f[d])return!1;for(d=g.length-1;0<=d;d--)if(f=g[d],!p(b[f],e[f],c,h))return!1;return!0}function u(b,c,h){p(b,c,!0)&&e(b,c,h,"notDeepStrictEqual",u)}function A(b,e){if(!b||!e)return!1;if("[object RegExp]"==
Object.prototype.toString.call(e))return e.test(b);try{if(b instanceof e)return!0}catch(H){}return Error.isPrototypeOf(e)?!1:!0===e.call({},b)}function y(b,c,h,g){if("function"!==typeof c)throw new TypeError('"block" argument must be a function');"string"===typeof h&&(g=h,h=null);var d;try{c()}catch(J){d=J}c=d;g=(h&&h.name?" ("+h.name+").":".")+(g?" "+g:".");b&&!c&&e(c,h,"Missing expected exception"+g);d="string"===typeof g;var q=!b&&t.isError(c),f=!b&&c&&!h;(q&&d&&A(c,h)||f)&&e(c,h,"Got unwanted exception"+
g);if(b&&c&&h&&!A(c,h)||!b&&c)throw c;}var t=a("util/"),v=Object.prototype.hasOwnProperty,B=Array.prototype.slice,w=function(){return"foo"===function(){}.name}(),x=k.exports=b,C=/\s*function\s+([^\(\s]*)\s*/;x.AssertionError=function(b){this.name="AssertionError";this.actual=b.actual;this.expected=b.expected;this.operator=b.operator;b.message?(this.message=b.message,this.generatedMessage=!1):(this.message=g(h(this.actual),128)+" "+this.operator+" "+g(h(this.expected),128),this.generatedMessage=!0);
var d=b.stackStartFunction||e;Error.captureStackTrace?Error.captureStackTrace(this,d):(b=Error(),b.stack&&(b=b.stack,d=c(d),d=b.indexOf("\n"+d),0<=d&&(d=b.indexOf("\n",d+1),b=b.substring(d+1)),this.stack=b))};t.inherits(x.AssertionError,Error);x.fail=e;x.ok=b;x.equal=function(b,c,h){b!=c&&e(b,c,h,"==",x.equal)};x.notEqual=function(b,c,h){b==c&&e(b,c,h,"!=",x.notEqual)};x.deepEqual=function(b,c,h){p(b,c,!1)||e(b,c,h,"deepEqual",x.deepEqual)};x.deepStrictEqual=function(b,c,h){p(b,c,!0)||e(b,c,h,"deepStrictEqual",
x.deepStrictEqual)};x.notDeepEqual=function(b,c,h){p(b,c,!1)&&e(b,c,h,"notDeepEqual",x.notDeepEqual)};x.notDeepStrictEqual=u;x.strictEqual=function(b,c,h){b!==c&&e(b,c,h,"===",x.strictEqual)};x.notStrictEqual=function(b,c,h){b===c&&e(b,c,h,"!==",x.notStrictEqual)};x["throws"]=function(b,e,c){y(!0,b,e,c)};x.doesNotThrow=function(b,e,c){y(!1,b,e,c)};x.ifError=function(b){if(b)throw b;};var z=Object.keys||function(b){var e=[],c;for(c in b)v.call(b,c)&&e.push(c);return e}}).call(this,"undefined"!==typeof global?
global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"util/":33}],6:[function(a,k,m){function f(b,h,q){q=q||2;var f=h&&h.length,p=f?h[0]*q:b.length,a=d(b,0,p,q,!0),r=[];if(!a)return r;var u,t,v,y;if(f){var w=q,f=[],B,x,C;y=0;for(B=h.length;y<B;y++)x=h[y]*w,C=y<B-1?h[y+1]*w:b.length,x=d(b,x,C,w,!1),x===x.next&&(x.steiner=!0),f.push(e(x));f.sort(c);for(y=0;y<f.length;y++){h=f[y];w=a;if(w=g(h,w))h=A(w,h),n(h,h.next);a=n(a,a.next)}}if(b.length>80*q){u=v=b[0];t=f=b[1];for(w=q;w<
p;w+=q)y=b[w],h=b[w+1],y<u&&(u=y),h<t&&(t=h),y>v&&(v=y),h>f&&(f=h);v=Math.max(v-u,f-t)}l(a,r,q,u,t,v);return r}function d(b,e,c,h,g){var d;if(g===0<B(b,e,c,h))for(g=e;g<c;g+=h)d=y(g,b[g],b[g+1],d);else for(g=c-h;g>=e;g-=h)d=y(g,b[g],b[g+1],d);d&&q(d,d.next)&&(t(d),d=d.next);return d}function n(b,e){if(!b)return b;e||(e=b);var c=b,h;do if(h=!1,c.steiner||!q(c,c.next)&&0!==p(c.prev,c,c.next))c=c.next;else{t(c);c=e=c.prev;if(c===c.next)return null;h=!0}while(h||c!==e);return e}function l(c,e,g,d,f,a,
v){if(c){if(!v&&a){var y=c,w=y;do null===w.z&&(w.z=h(w.x,w.y,d,f,a)),w.prevZ=w.prev,w=w.nextZ=w.next;while(w!==y);w.prevZ.nextZ=null;w.prevZ=null;var y=w,B,z,x,k,C,m,E=1;do{w=y;x=y=null;for(k=0;w;){k++;z=w;for(B=C=0;B<E&&(C++,z=z.nextZ,z);B++);for(m=E;0<C||0<m&&z;)0===C?(B=z,z=z.nextZ,m--):0!==m&&z?w.z<=z.z?(B=w,w=w.nextZ,C--):(B=z,z=z.nextZ,m--):(B=w,w=w.nextZ,C--),x?x.nextZ=B:y=B,B.prevZ=x,x=B;w=z}x.nextZ=null;E*=2}while(1<k)}for(y=c;c.prev!==c.next;){w=c.prev;z=c.next;if(a)a:{x=c;m=d;var D=f,H=
a;k=x.prev;C=x;E=x.next;if(0<=p(k,C,E))x=!1;else{var R=k.x>C.x?k.x>E.x?k.x:E.x:C.x>E.x?C.x:E.x,X=k.y>C.y?k.y>E.y?k.y:E.y:C.y>E.y?C.y:E.y;B=h(k.x<C.x?k.x<E.x?k.x:E.x:C.x<E.x?C.x:E.x,k.y<C.y?k.y<E.y?k.y:E.y:C.y<E.y?C.y:E.y,m,D,H);m=h(R,X,m,D,H);for(D=x.nextZ;D&&D.z<=m;){if(D!==x.prev&&D!==x.next&&b(k.x,k.y,C.x,C.y,E.x,E.y,D.x,D.y)&&0<=p(D.prev,D,D.next)){x=!1;break a}D=D.nextZ}for(D=x.prevZ;D&&D.z>=B;){if(D!==x.prev&&D!==x.next&&b(k.x,k.y,C.x,C.y,E.x,E.y,D.x,D.y)&&0<=p(D.prev,D,D.next)){x=!1;break a}D=
D.prevZ}x=!0}}else a:if(x=c,k=x.prev,C=x,E=x.next,0<=p(k,C,E))x=!1;else{for(B=x.next.next;B!==x.prev;){if(b(k.x,k.y,C.x,C.y,E.x,E.y,B.x,B.y)&&0<=p(B.prev,B,B.next)){x=!1;break a}B=B.next}x=!0}if(x)e.push(w.i/g),e.push(c.i/g),e.push(z.i/g),t(c),y=c=z.next;else if(c=z,c===y){if(!v)l(n(c),e,g,d,f,a,1);else if(1===v){v=e;y=g;w=c;do z=w.prev,x=w.next.next,!q(z,x)&&r(z,w,w.next,x)&&u(z,x)&&u(x,z)&&(v.push(z.i/y),v.push(w.i/y),v.push(x.i/y),t(w),t(w.next),w=c=x),w=w.next;while(w!==c);c=w;l(c,e,g,d,f,a,2)}else if(2===
v)a:{v=c;do{for(y=v.next.next;y!==v.prev;){if(w=v.i!==y.i){w=v;z=y;if(x=w.next.i!==z.i&&w.prev.i!==z.i){b:{x=w;do{if(x.i!==w.i&&x.next.i!==w.i&&x.i!==z.i&&x.next.i!==z.i&&r(x,x.next,w,z)){x=!0;break b}x=x.next}while(x!==w);x=!1}x=!x}if(x=x&&u(w,z)&&u(z,w)){x=w;k=!1;C=(w.x+z.x)/2;z=(w.y+z.y)/2;do x.y>z!==x.next.y>z&&C<(x.next.x-x.x)*(z-x.y)/(x.next.y-x.y)+x.x&&(k=!k),x=x.next;while(x!==w);x=k}w=x}if(w){c=A(v,y);v=n(v,v.next);c=n(c,c.next);l(v,e,g,d,f,a);l(c,e,g,d,f,a);break a}y=y.next}v=v.next}while(v!==
c)}break}}}}function c(b,c){return b.x-c.x}function g(c,e){var h=e,g=c.x,d=c.y,q=-Infinity,f;do{if(d<=h.y&&d>=h.next.y){var a=h.x+(d-h.y)*(h.next.x-h.x)/(h.next.y-h.y);if(a<=g&&a>q){q=a;if(a===g){if(d===h.y)return h;if(d===h.next.y)return h.next}f=h.x<h.next.x?h:h.next}}h=h.next}while(h!==e);if(!f)return null;if(g===q)return f.prev;for(var a=f,p=f.x,r=f.y,l=Infinity,n,h=f.next;h!==a;)g>=h.x&&h.x>=p&&b(d<r?g:q,d,p,r,d<r?q:g,d,h.x,h.y)&&(n=Math.abs(d-h.y)/(g-h.x),(n<l||n===l&&h.x>f.x)&&u(h,c)&&(f=h,
l=n)),h=h.next;return f}function h(b,c,e,h,g){b=32767*(b-e)/g;c=32767*(c-h)/g;b=(b|b<<8)&16711935;b=(b|b<<4)&252645135;b=(b|b<<2)&858993459;c=(c|c<<8)&16711935;c=(c|c<<4)&252645135;c=(c|c<<2)&858993459;return(b|b<<1)&1431655765|((c|c<<1)&1431655765)<<1}function e(b){var c=b,e=b;do c.x<e.x&&(e=c),c=c.next;while(c!==b);return e}function b(b,c,e,h,g,d,q,f){return 0<=(g-q)*(c-f)-(b-q)*(d-f)&&0<=(b-q)*(h-f)-(e-q)*(c-f)&&0<=(e-q)*(d-f)-(g-q)*(h-f)}function p(b,c,e){return(c.y-b.y)*(e.x-c.x)-(c.x-b.x)*(e.y-
c.y)}function q(b,c){return b.x===c.x&&b.y===c.y}function r(b,c,e,h){return q(b,c)&&q(e,h)||q(b,h)&&q(e,c)?!0:0<p(b,c,e)!==0<p(b,c,h)&&0<p(e,h,b)!==0<p(e,h,c)}function u(b,c){return 0>p(b.prev,b,b.next)?0<=p(b,c,b.next)&&0<=p(b,b.prev,c):0>p(b,c,b.prev)||0>p(b,b.next,c)}function A(b,c){var e=new v(b.i,b.x,b.y),h=new v(c.i,c.x,c.y),g=b.next,d=c.prev;b.next=c;c.prev=b;e.next=g;g.prev=e;h.next=e;e.prev=h;d.next=h;h.prev=d;return h}function y(b,c,e,h){b=new v(b,c,e);h?(b.next=h.next,b.prev=h,h.next.prev=
b,h.next=b):(b.prev=b,b.next=b);return b}function t(b){b.next.prev=b.prev;b.prev.next=b.next;b.prevZ&&(b.prevZ.nextZ=b.nextZ);b.nextZ&&(b.nextZ.prevZ=b.prevZ)}function v(b,c,e){this.i=b;this.x=c;this.y=e;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function B(b,c,e,h){for(var g=0,d=e-h;c<e;c+=h)g+=(b[d]-b[c])*(b[c+1]+b[d+1]),d=c;return g}k.exports=f;f.deviation=function(b,c,e,h){var g=c&&c.length,d=Math.abs(B(b,0,g?c[0]*e:b.length,e));if(g)for(var g=0,q=c.length;g<q;g++)d-=
Math.abs(B(b,c[g]*e,g<q-1?c[g+1]*e:b.length,e));for(g=c=0;g<h.length;g+=3){var q=h[g]*e,f=h[g+1]*e,a=h[g+2]*e;c+=Math.abs((b[q]-b[a])*(b[f+1]-b[q+1])-(b[q]-b[f])*(b[a+1]-b[q+1]))}return 0===d&&0===c?0:Math.abs((c-d)/d)};f.flatten=function(b){for(var c=b[0][0].length,e={vertices:[],holes:[],dimensions:c},h=0,g=0;g<b.length;g++){for(var d=0;d<b[g].length;d++)for(var q=0;q<c;q++)e.vertices.push(b[g][d][q]);0<g&&(h+=b[g-1].length,e.holes.push(h))}return e}},{}],7:[function(a,k,m){function f(f){var c=
0;if(f&&0<f.length)for(var c=c+Math.abs(d(f[0])),g=1;g<f.length;g++)c-=Math.abs(d(f[g]));return c}function d(d){var c=0;if(2<d.length){for(var g,h,e=0;e<d.length-1;e++)g=d[e],h=d[e+1],c+=(h[0]-g[0])*Math.PI/180*(2+Math.sin(g[1]*Math.PI/180)+Math.sin(h[1]*Math.PI/180));c=c*n.RADIUS*n.RADIUS/2}return c}var n=a("wgs84");k.exports.geometry=function(d){if("Polygon"===d.type)return f(d.coordinates);if("MultiPolygon"===d.type){for(var c=0,g=0;g<d.coordinates.length;g++)c+=f(d.coordinates[g]);return c}return null};
k.exports.ring=d},{wgs84:42}],8:[function(a,k,m){function f(c,h){switch(c&&c.type||null){case "FeatureCollection":return c.features=c.features.map(d(f,h)),c;case "Feature":return c.geometry=f(c.geometry,h),c;case "Polygon":case "MultiPolygon":return"Polygon"===c.type?c.coordinates=n(c.coordinates,h):"MultiPolygon"===c.type&&(c.coordinates=c.coordinates.map(d(n,h))),c;default:return c}}function d(c,h){return function(e){return c(e,h)}}function n(c,h){h=!!h;c[0]=l(c[0],!h);for(var e=1;e<c.length;e++)c[e]=
l(c[e],h);return c}function l(g,h){return 0<=c.ring(g)===h?g:g.reverse()}var c=a("geojson-area");k.exports=f},{"geojson-area":7}],9:[function(a,k,m){function f(d,f,c,g,h){f.length&&(f.area=c,f.dist=g,void 0!==h&&(f.outer=h),d.push(f));return[]}k.exports=function(a,l,c,g,h,e,b,p){c/=l;g/=l;if(b>=c&&p<=g)return a;if(b>g||p<c)return null;l=[];for(b=0;b<a.length;b++){p=a[b];var q=p.geometry,r=p.type,u,n;u=p.min[h];n=p.max[h];if(u>=c&&n<=g)l.push(p);else if(!(u>g||n<c)){if(1===r){u=c;n=g;for(var y=h,t=
[],v=0;v<q.length;v++){var B=q[v],w=B[y];w>=u&&w<=n&&t.push(B)}q=t}else{u=c;n=g;y=h;t=e;v=3===r;B=[];for(w=0;w<q.length;w++){var x,k=0,z=null,m=q[w],D=m.area,H=m.dist,I=m.outer,G=m.length,F,K,J=[];for(K=0;K<G-1;K++)F=z||m[K],z=m[K+1],x=k||F[y],k=z[y],x<u?k>n?(J.push(t(F,z,u),t(F,z,n)),v||(J=f(B,J,D,H,I))):k>=u&&J.push(t(F,z,u)):x>n?k<u?(J.push(t(F,z,n),t(F,z,u)),v||(J=f(B,J,D,H,I))):k<=n&&J.push(t(F,z,n)):(J.push(F),k<u?(J.push(t(F,z,u)),v||(J=f(B,J,D,H,I))):k>n&&(J.push(t(F,z,n)),v||(J=f(B,J,D,H,
I))));F=m[G-1];x=F[y];x>=u&&x<=n&&J.push(F);x=J[J.length-1];v&&x&&(J[0][0]!==x[0]||J[0][1]!==x[1])&&J.push(J[0]);f(B,J,D,H,I)}q=B}q.length&&l.push(d(p.tags,r,q,p.id))}}return l.length?l:null};var d=a("./feature")},{"./feature":11}],10:[function(a,k,m){function f(g,h,e){if(null!==h.geometry){var b=h.geometry,a=b.type,q=b.coordinates,r=h.properties;h=h.id;var u,l;if("Point"===a)g.push(c(r,1,[n(q)],h));else if("MultiPoint"===a)g.push(c(r,1,d(q),h));else if("LineString"===a)g.push(c(r,2,[d(q,e)],h));
else if("MultiLineString"===a||"Polygon"===a){b=[];for(u=0;u<q.length;u++)l=d(q[u],e),"Polygon"===a&&(l.outer=0===u),b.push(l);g.push(c(r,"Polygon"===a?3:2,b,h))}else if("MultiPolygon"===a){b=[];for(u=0;u<q.length;u++)for(a=0;a<q[u].length;a++)l=d(q[u][a],e),l.outer=0===a,b.push(l);g.push(c(r,3,b,h))}else if("GeometryCollection"===a)for(u=0;u<b.geometries.length;u++)f(g,{geometry:b.geometries[u],properties:r},e);else throw Error("Input data is not a valid GeoJSON object.");}}function d(c,h){for(var e=
[],b=0;b<c.length;b++)e.push(n(c[b]));if(h){l(e,h);for(var g=b=0,d=0,f,a;d<e.length-1;d++)f=a||e[d],a=e[d+1],b+=f[0]*a[1]-a[0]*f[1],g+=Math.abs(a[0]-f[0])+Math.abs(a[1]-f[1]);e.area=Math.abs(b/2);e.dist=g}return e}function n(c){var h=Math.sin(c[1]*Math.PI/180),h=.5-.25*Math.log((1+h)/(1-h))/Math.PI;return[c[0]/360+.5,0>h?0:1<h?1:h,0]}k.exports=function(c,h){var e=[];if("FeatureCollection"===c.type)for(var b=0;b<c.features.length;b++)f(e,c.features[b],h);else"Feature"===c.type?f(e,c,h):f(e,{geometry:c},
h);return e};var l=a("./simplify"),c=a("./feature")},{"./feature":11,"./simplify":13}],11:[function(a,k,m){function f(d,f,a){for(var c=0,g;c<a.length;c++)g=a[c],d[0]=Math.min(g[0],d[0]),f[0]=Math.max(g[0],f[0]),d[1]=Math.min(g[1],d[1]),f[1]=Math.max(g[1],f[1])}k.exports=function(d,a,l,c){d={id:c||null,type:a,geometry:l,tags:d||null,min:[Infinity,Infinity],max:[-Infinity,-Infinity]};a=d.geometry;l=d.min;c=d.max;if(1===d.type)f(l,c,a);else for(var g=0;g<a.length;g++)f(l,c,a[g]);return d}},{}],12:[function(a,
k,m){function f(b,h){var g=Object.create(this.options),f=h,q;for(q in f)g[q]=f[q];h=this.options=g;(g=h.debug)&&console.time("preprocess data");f=c(b,h.tolerance/((1<<h.maxZoom)*h.extent));this.tiles={};this.tileCoords=[];g&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",h.indexMaxZoom,h.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0);f=e(f,h.buffer/h.extent,d);f.length&&this.splitTile(f,0,0,0);g&&(f.length&&console.log("features: %d, points: %d",
this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function d(b,c,e){return[e,(e-b[0])*(c[1]-b[1])/(c[0]-b[0])+b[1],1]}function n(b,c,e){return[(e-b[1])*(c[0]-b[0])/(c[1]-b[1])+b[0],e,1]}function l(b,c,e){var h=b.source;if(1!==h.length)return!1;h=h[0];if(3!==h.type||1<h.geometry.length)return!1;var d=h.geometry[0].length;if(5!==d)return!1;for(var f=0;f<d;f++){var a=g.point(h.geometry[0][f],c,b.z2,
b.x,b.y);if(a[0]!==-e&&a[0]!==c+e||a[1]!==-e&&a[1]!==c+e)return!1}return!0}k.exports=function(b,c){return new f(b,c)};var c=a("./convert"),g=a("./transform"),h=a("./clip"),e=a("./wrap"),b=a("./tile");f.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1E5,solidChildren:!1,tolerance:3,extent:4096,buffer:64,debug:0};f.prototype.splitTile=function(c,e,g,f,a,y,t){for(var q=[c,e,g,f],p=this.options,r=p.debug,u=null;q.length;){f=q.pop();g=q.pop();e=q.pop();c=q.pop();var A=1<<e,z=32*((1<<e)*f+
g)+e,k=this.tiles[z],m=e===p.maxZoom?0:p.tolerance/(A*p.extent);k||(1<r&&console.time("creation"),k=this.tiles[z]=b(c,A,g,f,m,e===p.maxZoom),this.tileCoords.push({z:e,x:g,y:f}),r&&(1<r&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,g,f,k.numFeatures,k.numPoints,k.numSimplified),console.timeEnd("creation")),z="z"+e,this.stats[z]=(this.stats[z]||0)+1,this.total++));k.source=c;if(a){if(e===p.maxZoom||e===a)continue;z=1<<a-e;if(g!==Math.floor(y/z)||f!==Math.floor(t/z))continue}else if(e===
p.indexMaxZoom||k.numPoints<=p.indexMaxPoints)continue;if(!p.solidChildren&&l(k,p.extent,p.buffer))a&&(u=e);else{k.source=null;1<r&&console.time("clipping");var z=.5*p.buffer/p.extent,m=.5-z,H=.5+z,I=1+z,G,F,K,J,L,N;G=F=K=J=null;L=h(c,A,g-z,g+H,0,d,k.min[0],k.max[0]);N=h(c,A,g+m,g+I,0,d,k.min[0],k.max[0]);L&&(G=h(L,A,f-z,f+H,1,n,k.min[1],k.max[1]),F=h(L,A,f+m,f+I,1,n,k.min[1],k.max[1]));N&&(K=h(N,A,f-z,f+H,1,n,k.min[1],k.max[1]),J=h(N,A,f+m,f+I,1,n,k.min[1],k.max[1]));1<r&&console.timeEnd("clipping");
c.length&&(q.push(G||[],e+1,2*g,2*f),q.push(F||[],e+1,2*g,2*f+1),q.push(K||[],e+1,2*g+1,2*f),q.push(J||[],e+1,2*g+1,2*f+1))}}return u};f.prototype.getTile=function(b,c,e){var h=this.options,d=h.extent,f=h.debug,a=1<<b;c=(c%a+a)%a;a=32*((1<<b)*e+c)+b;if(this.tiles[a])return g.tile(this.tiles[a],d);1<f&&console.log("drilling down to z%d-%d-%d",b,c,e);for(var q=b,p=c,r=e,n;!n&&0<q;)q--,p=Math.floor(p/2),r=Math.floor(r/2),n=this.tiles[32*((1<<q)*r+p)+q];if(!n||!n.source)return null;1<f&&console.log("found parent tile z%d-%d-%d",
q,p,r);if(l(n,d,h.buffer))return g.tile(n,d);1<f&&console.time("drilling down");h=this.splitTile(n.source,q,p,r,b,c,e);1<f&&console.timeEnd("drilling down");null!==h&&(b=1<<b-h,a=32*((1<<h)*Math.floor(e/b)+Math.floor(c/b))+h);return this.tiles[a]?g.tile(this.tiles[a],d):null}},{"./clip":9,"./convert":10,"./tile":14,"./transform":15,"./wrap":16}],13:[function(a,k,m){k.exports=function(f,d){var a=d*d,l=0,c=f.length-1,g=[],h,e,b,p;f[l][2]=1;for(f[c][2]=1;c;){e=0;for(h=l+1;h<c;h++){var q=f[h],r=f[l],
u=f[c];b=r[0];var r=r[1],A=u[0],u=u[1],y=q[0],q=q[1],t=A-b,v=u-r;if(0!==t||0!==v){var B=((y-b)*t+(q-r)*v)/(t*t+v*v);1<B?(b=A,r=u):0<B&&(b+=t*B,r+=v*B)}t=y-b;v=q-r;b=t*t+v*v;b>e&&(p=h,e=b)}e>a?(f[p][2]=e,g.push(l),g.push(p),l=p):(c=g.pop(),l=g.pop())}}},{}],14:[function(a,k,m){k.exports=function(f,d,a,l,c,g){d={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:a,y:l,z2:d,transformed:!1,min:[2,1],max:[-1,0]};for(a=0;a<f.length;a++){d.numFeatures++;var h,e,b,p;l=d;var q=f[a],r=c,u=
g,n=q.geometry,y=q.type,t=[],v=r*r;if(1===y)for(p=0;p<n.length;p++)t.push(n[p]),l.numPoints++,l.numSimplified++;else for(p=0;p<n.length;p++)if(e=n[p],!u&&(2===y&&e.dist<r||3===y&&e.area<v))l.numPoints+=e.length;else{var B=[];for(b=0;b<e.length;b++){h=e[b];if(u||h[2]>v)B.push(h),l.numSimplified++;l.numPoints++}if(3===y){var k,x=b=0,m=B.length;for(k=m-1;x<m;k=x++)h=B[x],k=B[k],b+=(k[0]-h[0])*(h[1]+k[1]);0>b===e.outer&&B.reverse()}t.push(B)}t.length&&(e={geometry:t,type:y,tags:q.tags||null},null!==q.id&&
(e.id=q.id),l.features.push(e));l=f[a].min;q=f[a].max;l[0]<d.min[0]&&(d.min[0]=l[0]);l[1]<d.min[1]&&(d.min[1]=l[1]);q[0]>d.max[0]&&(d.max[0]=q[0]);q[1]>d.max[1]&&(d.max[1]=q[1])}return d}},{}],15:[function(a,k,m){function f(d,f,a,c,g){return[Math.round(f*(d[0]*a-c)),Math.round(f*(d[1]*a-g))]}m.tile=function(d,a){if(d.transformed)return d;var l=d.z2,c=d.x,g=d.y,h,e,b;for(h=0;h<d.features.length;h++){e=d.features[h];var p=e.geometry;if(1===e.type)for(e=0;e<p.length;e++)p[e]=f(p[e],a,l,c,g);else for(e=
0;e<p.length;e++){var q=p[e];for(b=0;b<q.length;b++)q[b]=f(q[b],a,l,c,g)}}d.transformed=!0;return d};m.point=f},{}],16:[function(a,k,m){function f(c,g){for(var h=[],e=0;e<c.length;e++){var b=c[e],f=b.type,a;if(1===f)a=d(b.geometry,g);else{a=[];for(var r=0;r<b.geometry.length;r++)a.push(d(b.geometry[r],g))}h.push(l(b.tags,f,a,b.id))}return h}function d(c,g){var h=[];h.area=c.area;h.dist=c.dist;for(var e=0;e<c.length;e++)h.push([c[e][0]+g,c[e][1],c[e][2]]);return h}var n=a("./clip"),l=a("./feature");
k.exports=function(c,g,h){var e=c,b=n(c,1,-1-g,g,0,h,-1,2),d=n(c,1,1-g,2+g,0,h,-1,2);if(b||d)e=n(c,1,-g,1+g,0,h,-1,2)||[],b&&(e=f(b,1).concat(e)),d&&(e=e.concat(f(d,-1)));return e}},{"./clip":9,"./feature":11}],17:[function(a,k,m){function f(f,a,c){var g=this.cells=[];if(f instanceof ArrayBuffer){this.arrayBuffer=f;var h=new Int32Array(this.arrayBuffer);f=h[0];a=h[1];c=h[2];this.d=a+2*c;for(var e=0;e<this.d*this.d;e++){var b=h[d+e],p=h[d+e+1];g.push(b===p?null:h.subarray(b,p))}e=h[d+g.length+1];this.keys=
h.subarray(h[d+g.length],e);this.bboxes=h.subarray(e);this.insert=this._insertReadonly}else{this.d=a+2*c;for(h=0;h<this.d*this.d;h++)g.push([]);this.keys=[];this.bboxes=[]}this.n=a;this.extent=f;this.padding=c;this.scale=a/f;this.uid=0;a=c/a*f;this.min=-a;this.max=f+a}k.exports=f;var d=3;f.prototype.insert=function(d,f,c,g,h){this._forEachCell(f,c,g,h,this._insertCell,this.uid++);this.keys.push(d);this.bboxes.push(f);this.bboxes.push(c);this.bboxes.push(g);this.bboxes.push(h)};f.prototype._insertReadonly=
function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer.";};f.prototype._insertCell=function(d,f,c,g,h,e){this.cells[h].push(e)};f.prototype.query=function(d,f,c,g){var h=this.min,e=this.max;if(d<=h&&f<=h&&e<=c&&e<=g)return Array.prototype.slice.call(this.keys);h=[];this._forEachCell(d,f,c,g,this._queryCell,h,{});return h};f.prototype._queryCell=function(d,f,c,g,h,e,b){h=this.cells[h];if(null!==h)for(var a=this.keys,q=this.bboxes,r=0;r<h.length;r++){var u=h[r];if(void 0===b[u]){var l=
4*u;d<=q[l+2]&&f<=q[l+3]&&c>=q[l+0]&&g>=q[l+1]?(b[u]=!0,e.push(a[u])):b[u]=!1}}};f.prototype._forEachCell=function(d,f,c,g,h,e,b){for(var a=this._convertToCellCoord(d),q=this._convertToCellCoord(f),r=this._convertToCellCoord(c),u=this._convertToCellCoord(g);a<=r;a++)for(var l=q;l<=u;l++)if(h.call(this,d,f,c,g,this.d*l+a,e,b))return};f.prototype._convertToCellCoord=function(d){return Math.max(0,Math.min(this.d-1,Math.floor(d*this.scale)+this.padding))};f.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;
for(var f=this.cells,a=d+this.cells.length+1+1,c=0,g=0;g<this.cells.length;g++)c+=this.cells[g].length;c=new Int32Array(a+c+this.keys.length+this.bboxes.length);c[0]=this.extent;c[1]=this.n;c[2]=this.padding;for(g=0;g<f.length;g++){var h=f[g];c[d+g]=a;c.set(h,a);a+=h.length}c[d+f.length]=a;c.set(this.keys,a);a+=this.keys.length;c[d+f.length+1]=a;c.set(this.bboxes,a);return c.buffer}},{}],18:[function(a,k,m){m.read=function(f,d,a,l,c){var g;g=8*c-l-1;var h=(1<<g)-1,e=h>>1,b=-7;c=a?c-1:0;var p=a?-1:
1,q=f[d+c];c+=p;a=q&(1<<-b)-1;q>>=-b;for(b+=g;0<b;a=256*a+f[d+c],c+=p,b-=8);g=a&(1<<-b)-1;a>>=-b;for(b+=l;0<b;g=256*g+f[d+c],c+=p,b-=8);if(0===a)a=1-e;else{if(a===h)return g?NaN:Infinity*(q?-1:1);g+=Math.pow(2,l);a-=e}return(q?-1:1)*g*Math.pow(2,a-l)};m.write=function(f,d,a,l,c,g){var h,e=8*g-c-1,b=(1<<e)-1,p=b>>1,q=23===c?Math.pow(2,-24)-Math.pow(2,-77):0;g=l?0:g-1;var r=l?1:-1,u=0>d||0===d&&0>1/d?1:0;d=Math.abs(d);isNaN(d)||Infinity===d?(d=isNaN(d)?1:0,l=b):(l=Math.floor(Math.log(d)/Math.LN2),1>
d*(h=Math.pow(2,-l))&&(l--,h*=2),d=1<=l+p?d+q/h:d+q*Math.pow(2,1-p),2<=d*h&&(l++,h/=2),l+p>=b?(d=0,l=b):1<=l+p?(d=(d*h-1)*Math.pow(2,c),l+=p):(d=d*Math.pow(2,p-1)*Math.pow(2,c),l=0));for(;8<=c;f[a+g]=d&255,g+=r,d/=256,c-=8);l=l<<c|d;for(e+=c;0<e;f[a+g]=l&255,g+=r,l/=256,e-=8);f[a+g-r]|=128*u}},{}],19:[function(a,k,m){function f(c,e,b,g,a){e=e||d;b=b||n;a=a||Array;this.nodeSize=g||64;this.points=c;this.ids=new a(c.length);this.coords=new a(2*c.length);for(g=0;g<c.length;g++)this.ids[g]=g,this.coords[2*
g]=e(c[g]),this.coords[2*g+1]=b(c[g]);l(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function d(c){return c[0]}function n(c){return c[1]}var l=a("./sort"),c=a("./range"),g=a("./within");k.exports=function(c,e,b,g,d){return new f(c,e,b,g,d)};f.prototype={range:function(h,e,b,g){return c(this.ids,this.coords,h,e,b,g,this.nodeSize)},within:function(c,e,b){return g(this.ids,this.coords,c,e,b,this.nodeSize)}}},{"./range":20,"./sort":21,"./within":22}],20:[function(a,k,m){k.exports=function(a,
d,n,l,c,g,h){for(var e=[0,a.length-1,0],b=[],f,q;e.length;){var r=e.pop(),u=e.pop(),A=e.pop();if(u-A<=h)for(r=A;r<=u;r++)f=d[2*r],q=d[2*r+1],f>=n&&f<=c&&q>=l&&q<=g&&b.push(a[r]);else{var y=Math.floor((A+u)/2);f=d[2*y];q=d[2*y+1];f>=n&&f<=c&&q>=l&&q<=g&&b.push(a[y]);var t=(r+1)%2;if(0===r?n<=f:l<=q)e.push(A),e.push(y-1),e.push(t);if(0===r?c>=f:g>=q)e.push(y+1),e.push(u),e.push(t)}}return b}},{}],21:[function(a,k,m){function f(c,g,h,e,b,a){if(!(b-e<=h)){var q=Math.floor((e+b)/2);d(c,g,q,e,b,a%2);f(c,
g,h,e,q-1,a+1);f(c,g,h,q+1,b,a+1)}}function d(c,g,h,e,b,a){for(;b>e;){if(600<b-e){var f=b-e+1,p=h-e+1,u=Math.log(f),l=.5*Math.exp(2*u/3),u=.5*Math.sqrt(u*l*(f-l)/f)*(0>p-f/2?-1:1);d(c,g,h,Math.max(e,Math.floor(h-p*l/f+u)),Math.min(b,Math.floor(h+(f-p)*l/f+u)),a)}f=g[2*h+a];p=e;l=b;n(c,g,e,h);for(g[2*b+a]>f&&n(c,g,e,b);p<l;){n(c,g,p,l);p++;for(l--;g[2*p+a]<f;)p++;for(;g[2*l+a]>f;)l--}g[2*e+a]===f?n(c,g,e,l):(l++,n(c,g,l,b));l<=h&&(e=l+1);h<=l&&(b=l-1)}}function n(c,g,h,e){l(c,h,e);l(g,2*h,2*e);l(g,
2*h+1,2*e+1)}function l(c,g,h){var e=c[g];c[g]=c[h];c[h]=e}k.exports=f},{}],22:[function(a,k,m){k.exports=function(a,d,n,l,c,g){for(var h=[0,a.length-1,0],e=[],b=c*c;h.length;){var f=h.pop(),q=h.pop(),r=h.pop();if(q-r<=g)for(f=r;f<=q;f++){var r=d[2*f]-n,u=d[2*f+1]-l;r*r+u*u<=b&&e.push(a[f])}else{var u=Math.floor((r+q)/2),A=d[2*u],y=d[2*u+1],t=A-n,v=y-l;t*t+v*v<=b&&e.push(a[u]);t=(f+1)%2;if(0===f?n-c<=A:l-c<=y)h.push(r),h.push(u-1),h.push(t);if(0===f?n+c>=A:l+c>=y)h.push(u+1),h.push(q),h.push(t)}}return e}},
{}],23:[function(a,k,m){function f(a){var l;if(l="undefined"!==typeof window&&"undefined"!==typeof document&&Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray&&Function.prototype&&Function.prototype.bind&&Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&
Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions&&"JSON"in window&&"parse"in JSON&&"stringify"in JSON&&"Worker"in window&&"Uint8ClampedArray"in window){a=a&&a.failIfMajorPerformanceCaveat;if(void 0===d[a]){l=d;var c;c=document.createElement("canvas");var g=Object.create(f.webGLContextAttributes);g.failIfMajorPerformanceCaveat=a;c=c.probablySupportsContext?c.probablySupportsContext("webgl",
g)||c.probablySupportsContext("experimental-webgl",g):c.supportsContext?c.supportsContext("webgl",g)||c.supportsContext("experimental-webgl",g):c.getContext("webgl",g)||c.getContext("experimental-webgl",g);l[a]=c}l=d[a]}return!!l}"undefined"!==typeof k&&k.exports?k.exports=f:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=f);var d={};f.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}},{}],24:[function(a,k,m){function f(c){var e;c&&c.length&&(e=c,c=e.length);
c=new Uint8Array(c||0);e&&c.set(e);c.readUInt32LE=l.readUInt32LE;c.writeUInt32LE=l.writeUInt32LE;c.readInt32LE=l.readInt32LE;c.writeInt32LE=l.writeInt32LE;c.readFloatLE=l.readFloatLE;c.writeFloatLE=l.writeFloatLE;c.readDoubleLE=l.readDoubleLE;c.writeDoubleLE=l.writeDoubleLE;c.toString=l.toString;c.write=l.write;c.slice=l.slice;c.copy=l.copy;c._isBuffer=!0;return c}function d(c){for(var e=c.length,b=[],h=0,g,d;h<e;h++){g=c.charCodeAt(h);if(55295<g&&57344>g)if(d)if(56320>g){b.push(239,191,189);d=g;
continue}else g=d-55296<<10|g-56320|65536,d=null;else{56319<g||h+1===e?b.push(239,191,189):d=g;continue}else d&&(b.push(239,191,189),d=null);128>g?b.push(g):2048>g?b.push(g>>6|192,g&63|128):65536>g?b.push(g>>12|224,g>>6&63|128,g&63|128):b.push(g>>18|240,g>>12&63|128,g>>6&63|128,g&63|128)}return b}k.exports=f;var n=a("ieee754"),l,c,g;l={readUInt32LE:function(c){return(this[c]|this[c+1]<<8|this[c+2]<<16)+16777216*this[c+3]},writeUInt32LE:function(c,e){this[e]=c;this[e+1]=c>>>8;this[e+2]=c>>>16;this[e+
3]=c>>>24},readInt32LE:function(c){return(this[c]|this[c+1]<<8|this[c+2]<<16)+(this[c+3]<<24)},readFloatLE:function(c){return n.read(this,c,!0,23,4)},readDoubleLE:function(c){return n.read(this,c,!0,52,8)},writeFloatLE:function(c,e){return n.write(this,c,e,!0,23,4)},writeDoubleLE:function(c,e){return n.write(this,c,e,!0,52,8)},toString:function(c,e,b){var g=c="";b=Math.min(this.length,b||this.length);for(e=e||0;e<b;e++){var h=this[e];127>=h?(c+=decodeURIComponent(g)+String.fromCharCode(h),g=""):g+=
"%"+h.toString(16)}return c+=decodeURIComponent(g)},write:function(h,e){for(var b=h===c?g:d(h),a=0;a<b.length;a++)this[e+a]=b[a]},slice:function(c,e){return this.subarray(c,e)},copy:function(c,e){e=e||0;for(var b=0;b<this.length;b++)c[e+b]=this[b]}};l.writeInt32LE=l.writeUInt32LE;f.byteLength=function(h){c=h;g=d(h);return g.length};f.isBuffer=function(c){return!(!c||!c._isBuffer)}},{ieee754:18}],25:[function(a,k,m){(function(f){function d(b){this.buf=u.isBuffer(b)?b:new u(b||0);this.pos=0;this.length=
this.buf.length}function n(b,c){var e=c.buf,g;g=e[c.pos++];b+=268435456*(g&127);if(128>g)return b;g=e[c.pos++];b+=34359738368*(g&127);if(128>g)return b;g=e[c.pos++];b+=4398046511104*(g&127);if(128>g)return b;g=e[c.pos++];b+=562949953421312*(g&127);if(128>g)return b;g=e[c.pos++];b+=72057594037927936*(g&127);if(128>g)return b;g=e[c.pos++];if(128>g)return b+0x7fffffffffffffff*(g&127);throw Error("Expected varint not more than 10 bytes");}function l(b,c){for(var e=0;e<b.length;e++)c.writeVarint(b[e])}
function c(b,c){for(var e=0;e<b.length;e++)c.writeSVarint(b[e])}function g(b,c){for(var e=0;e<b.length;e++)c.writeFloat(b[e])}function h(b,c){for(var e=0;e<b.length;e++)c.writeDouble(b[e])}function e(b,c){for(var e=0;e<b.length;e++)c.writeBoolean(b[e])}function b(b,c){for(var e=0;e<b.length;e++)c.writeFixed32(b[e])}function p(b,c){for(var e=0;e<b.length;e++)c.writeSFixed32(b[e])}function q(b,c){for(var e=0;e<b.length;e++)c.writeFixed64(b[e])}function r(b,c){for(var e=0;e<b.length;e++)c.writeSFixed64(b[e])}
k.exports=d;var u=f.Buffer||a("./buffer");d.Varint=0;d.Fixed64=1;d.Bytes=2;d.Fixed32=5;var A=1/4294967296,y=Math.pow(2,63);d.prototype={destroy:function(){this.buf=null},readFields:function(b,c,e){for(e=e||this.length;this.pos<e;){var g=this.readVarint(),h=this.pos;b(g>>3,c,this);this.pos===h&&this.skip(g)}return c},readMessage:function(b,c){return this.readFields(b,c,this.readVarint()+this.pos)},readFixed32:function(){var b=this.buf.readUInt32LE(this.pos);this.pos+=4;return b},readSFixed32:function(){var b=
this.buf.readInt32LE(this.pos);this.pos+=4;return b},readFixed64:function(){var b=this.buf.readUInt32LE(this.pos)+4294967296*this.buf.readUInt32LE(this.pos+4);this.pos+=8;return b},readSFixed64:function(){var b=this.buf.readUInt32LE(this.pos)+4294967296*this.buf.readInt32LE(this.pos+4);this.pos+=8;return b},readFloat:function(){var b=this.buf.readFloatLE(this.pos);this.pos+=4;return b},readDouble:function(){var b=this.buf.readDoubleLE(this.pos);this.pos+=8;return b},readVarint:function(){var b=this.buf,
c,e;e=b[this.pos++];c=e&127;if(128>e)return c;e=b[this.pos++];c|=(e&127)<<7;if(128>e)return c;e=b[this.pos++];c|=(e&127)<<14;if(128>e)return c;e=b[this.pos++];c|=(e&127)<<21;return 128>e?c:n(c,this)},readVarint64:function(){var b=this.pos,c=this.readVarint();if(c<y)return c;for(var e=this.pos-2;255===this.buf[e];)e--;e<b&&(e=b);for(var g=c=0;g<e-b+1;g++)var h=~this.buf[b+g]&127,c=c+(4>g?h<<7*g:h*Math.pow(2,7*g));return-c-1},readSVarint:function(){var b=this.readVarint();return 1===b%2?(b+1)/-2:b/
2},readBoolean:function(){return!!this.readVarint()},readString:function(){var b=this.readVarint()+this.pos,c=this.buf.toString("utf8",this.pos,b);this.pos=b;return c},readBytes:function(){var b=this.readVarint()+this.pos,c=this.buf.slice(this.pos,b);this.pos=b;return c},readPackedVarint:function(){for(var b=this.readVarint()+this.pos,c=[];this.pos<b;)c.push(this.readVarint());return c},readPackedSVarint:function(){for(var b=this.readVarint()+this.pos,c=[];this.pos<b;)c.push(this.readSVarint());return c},
readPackedBoolean:function(){for(var b=this.readVarint()+this.pos,c=[];this.pos<b;)c.push(this.readBoolean());return c},readPackedFloat:function(){for(var b=this.readVarint()+this.pos,c=[];this.pos<b;)c.push(this.readFloat());return c},readPackedDouble:function(){for(var b=this.readVarint()+this.pos,c=[];this.pos<b;)c.push(this.readDouble());return c},readPackedFixed32:function(){for(var b=this.readVarint()+this.pos,c=[];this.pos<b;)c.push(this.readFixed32());return c},readPackedSFixed32:function(){for(var b=
this.readVarint()+this.pos,c=[];this.pos<b;)c.push(this.readSFixed32());return c},readPackedFixed64:function(){for(var b=this.readVarint()+this.pos,c=[];this.pos<b;)c.push(this.readFixed64());return c},readPackedSFixed64:function(){for(var b=this.readVarint()+this.pos,c=[];this.pos<b;)c.push(this.readSFixed64());return c},skip:function(b){b&=7;if(b===d.Varint)for(;127<this.buf[this.pos++];);else if(b===d.Bytes)this.pos=this.readVarint()+this.pos;else if(b===d.Fixed32)this.pos+=4;else if(b===d.Fixed64)this.pos+=
8;else throw Error("Unimplemented type: "+b);},writeTag:function(b,c){this.writeVarint(b<<3|c)},realloc:function(b){for(var c=this.length||16;c<this.pos+b;)c*=2;c!==this.length&&(b=new u(c),this.buf.copy(b),this.buf=b,this.length=c)},finish:function(){this.length=this.pos;this.pos=0;return this.buf.slice(0,this.length)},writeFixed32:function(b){this.realloc(4);this.buf.writeUInt32LE(b,this.pos);this.pos+=4},writeSFixed32:function(b){this.realloc(4);this.buf.writeInt32LE(b,this.pos);this.pos+=4},writeFixed64:function(b){this.realloc(8);
this.buf.writeInt32LE(b&-1,this.pos);this.buf.writeUInt32LE(Math.floor(b*A),this.pos+4);this.pos+=8},writeSFixed64:function(b){this.realloc(8);this.buf.writeInt32LE(b&-1,this.pos);this.buf.writeInt32LE(Math.floor(b*A),this.pos+4);this.pos+=8},writeVarint:function(b){b=+b;if(268435455<b){this.realloc(10);for(var c=this.pos+10;1<=b;){if(this.pos>=c)throw Error("Given varint doesn't fit into 10 bytes");var e=b&255;this.buf[this.pos++]=e|(128<=b?128:0);b/=128}}else this.realloc(4),this.buf[this.pos++]=
b&127|(127<b?128:0),127>=b||(this.buf[this.pos++]=(b>>>=7)&127|(127<b?128:0),127>=b||(this.buf[this.pos++]=(b>>>=7)&127|(127<b?128:0),127>=b||(this.buf[this.pos++]=b>>>7&127)))},writeSVarint:function(b){this.writeVarint(0>b?2*-b-1:2*b)},writeBoolean:function(b){this.writeVarint(!!b)},writeString:function(b){b=String(b);var c=u.byteLength(b);this.writeVarint(c);this.realloc(c);this.buf.write(b,this.pos);this.pos+=c},writeFloat:function(b){this.realloc(4);this.buf.writeFloatLE(b,this.pos);this.pos+=
4},writeDouble:function(b){this.realloc(8);this.buf.writeDoubleLE(b,this.pos);this.pos+=8},writeBytes:function(b){var c=b.length;this.writeVarint(c);this.realloc(c);for(var e=0;e<c;e++)this.buf[this.pos++]=b[e]},writeRawMessage:function(b,c){this.pos++;var e=this.pos;b(c,this);var g=this.pos-e;if(128<=g){var h=16383>=g?1:2097151>=g?2:268435455>=g?3:Math.ceil(Math.log(g)/(7*Math.LN2));this.realloc(h);for(var d=this.pos-1;d>=e;d--)this.buf[d+h]=this.buf[d]}this.pos=e-1;this.writeVarint(g);this.pos+=
g},writeMessage:function(b,c,e){this.writeTag(b,d.Bytes);this.writeRawMessage(c,e)},writePackedVarint:function(b,c){this.writeMessage(b,l,c)},writePackedSVarint:function(b,e){this.writeMessage(b,c,e)},writePackedBoolean:function(b,c){this.writeMessage(b,e,c)},writePackedFloat:function(b,c){this.writeMessage(b,g,c)},writePackedDouble:function(b,c){this.writeMessage(b,h,c)},writePackedFixed32:function(c,e){this.writeMessage(c,b,e)},writePackedSFixed32:function(b,c){this.writeMessage(b,p,c)},writePackedFixed64:function(b,
c){this.writeMessage(b,q,c)},writePackedSFixed64:function(b,c){this.writeMessage(b,r,c)},writeBytesField:function(b,c){this.writeTag(b,d.Bytes);this.writeBytes(c)},writeFixed32Field:function(b,c){this.writeTag(b,d.Fixed32);this.writeFixed32(c)},writeSFixed32Field:function(b,c){this.writeTag(b,d.Fixed32);this.writeSFixed32(c)},writeFixed64Field:function(b,c){this.writeTag(b,d.Fixed64);this.writeFixed64(c)},writeSFixed64Field:function(b,c){this.writeTag(b,d.Fixed64);this.writeSFixed64(c)},writeVarintField:function(b,
c){this.writeTag(b,d.Varint);this.writeVarint(c)},writeSVarintField:function(b,c){this.writeTag(b,d.Varint);this.writeSVarint(c)},writeStringField:function(b,c){this.writeTag(b,d.Bytes);this.writeString(c)},writeFloatField:function(b,c){this.writeTag(b,d.Fixed32);this.writeFloat(c)},writeDoubleField:function(b,c){this.writeTag(b,d.Fixed64);this.writeDouble(c)},writeBooleanField:function(b,c){this.writeVarintField(b,!!c)}}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:
"undefined"!==typeof window?window:{})},{"./buffer":24}],26:[function(a,k,m){function f(d,a){this.x=d;this.y=a}k.exports=f;f.prototype={clone:function(){return new f(this.x,this.y)},add:function(d){return this.clone()._add(d)},sub:function(d){return this.clone()._sub(d)},mult:function(d){return this.clone()._mult(d)},div:function(d){return this.clone()._div(d)},rotate:function(d){return this.clone()._rotate(d)},matMult:function(d){return this.clone()._matMult(d)},unit:function(){return this.clone()._unit()},
perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(d){return this.x===d.x&&this.y===d.y},dist:function(d){return Math.sqrt(this.distSqr(d))},distSqr:function(d){var a=d.x-this.x;d=d.y-this.y;return a*a+d*d},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(d){return Math.atan2(this.y-d.y,this.x-d.x)},angleWith:function(d){return this.angleWithSep(d.x,d.y)},angleWithSep:function(d,
a){return Math.atan2(this.x*a-this.y*d,this.x*d+this.y*a)},_matMult:function(d){var a=d[2]*this.x+d[3]*this.y;this.x=d[0]*this.x+d[1]*this.y;this.y=a;return this},_add:function(d){this.x+=d.x;this.y+=d.y;return this},_sub:function(d){this.x-=d.x;this.y-=d.y;return this},_mult:function(d){this.x*=d;this.y*=d;return this},_div:function(d){this.x/=d;this.y/=d;return this},_unit:function(){this._div(this.mag());return this},_perp:function(){var d=this.y;this.y=this.x;this.x=-d;return this},_rotate:function(d){var a=
Math.cos(d);d=Math.sin(d);var f=d*this.x+a*this.y;this.x=a*this.x-d*this.y;this.y=f;return this},_round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this}};f.convert=function(d){return d instanceof f?d:Array.isArray(d)?new f(d[0],d[1]):d}},{}],27:[function(a,k,m){function f(){throw Error("setTimeout has not been defined");}function d(){throw Error("clearTimeout has not been defined");}function n(c){if(b===setTimeout)return setTimeout(c,0);if((b===f||!b)&&setTimeout)return b=
setTimeout,setTimeout(c,0);try{return b(c,0)}catch(t){try{return b.call(null,c,0)}catch(v){return b.call(this,c,0)}}}function l(b){if(p===clearTimeout)return clearTimeout(b);if((p===d||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(b);try{return p(b)}catch(t){try{return p.call(null,b)}catch(v){return p.call(this,b)}}}function c(){r&&u&&(r=!1,u.length?q=u.concat(q):A=-1,q.length&&g())}function g(){if(!r){var b=n(c);r=!0;for(var e=q.length;e;){u=q;for(q=[];++A<e;)u&&u[A].run();A=-1;e=q.length}u=
null;r=!1;l(b)}}function h(b,c){this.fun=b;this.array=c}function e(){}a=k.exports={};var b,p;try{b="function"===typeof setTimeout?setTimeout:f}catch(y){b=f}try{p="function"===typeof clearTimeout?clearTimeout:d}catch(y){p=d}var q=[],r=!1,u,A=-1;a.nextTick=function(b){var c=Array(arguments.length-1);if(1<arguments.length)for(var e=1;e<arguments.length;e++)c[e-1]=arguments[e];q.push(new h(b,c));1!==q.length||r||n(g)};h.prototype.run=function(){this.fun.apply(null,this.array)};a.title="browser";a.browser=
!0;a.env={};a.argv=[];a.version="";a.versions={};a.on=e;a.addListener=e;a.once=e;a.off=e;a.removeListener=e;a.removeAllListeners=e;a.emit=e;a.binding=function(b){throw Error("process.binding is not supported");};a.cwd=function(){return"/"};a.chdir=function(b){throw Error("process.chdir is not supported");};a.umask=function(){return 0}},{}],28:[function(a,k,m){function f(a,c,g,h,e){g=g||0;h=h||a.length-1;for(e=e||n;h>g;){if(600<h-g){var b=h-g+1,p=c-g+1,q=Math.log(b),r=.5*Math.exp(2*q/3),q=.5*Math.sqrt(q*
r*(b-r)/b)*(0>p-b/2?-1:1);f(a,c,Math.max(g,Math.floor(c-p*r/b+q)),Math.min(h,Math.floor(c+(b-p)*r/b+q)),e)}b=a[c];p=g;r=h;d(a,g,c);for(0<e(a[h],b)&&d(a,g,h);p<r;){d(a,p,r);p++;for(r--;0>e(a[p],b);)p++;for(;0<e(a[r],b);)r--}0===e(a[g],b)?d(a,g,r):(r++,d(a,r,h));r<=c&&(g=r+1);c<=r&&(h=r-1)}}function d(a,c,g){var h=a[c];a[c]=a[g];a[g]=h}function n(a,c){return a<c?-1:a>c?1:0}k.exports=f},{}],29:[function(a,k,m){function f(b){var c=Object.create(this.options),e;for(e in b)c[e]=b[e];this.options=c;this.trees=
Array(this.options.maxZoom+1)}function d(b,e){var g=b.geometry.coordinates,h=c(g[1]);return{x:g[0]/360+.5,y:h,zoom:Infinity,id:e,numPoints:1}}function n(b){return{type:"Feature",properties:l(b),geometry:{type:"Point",coordinates:[360*(b.x-.5),360*Math.atan(Math.exp((180-360*b.y)*Math.PI/180))/Math.PI-90]}}}function l(b){b=b.numPoints;return{cluster:!0,point_count:b,point_count_abbreviated:1E4<=b?Math.round(b/1E3)+"k":1E3<=b?Math.round(b/100)/10+"k":b}}function c(b){b=Math.sin(b*Math.PI/180);b=.5-
.25*Math.log((1+b)/(1-b))/Math.PI;return 0>b?0:1<b?1:b}function g(b){return b.x}function h(b){return b.y}var e=a("kdbush");k.exports=function(b){return new f(b)};f.prototype={options:{minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1},load:function(b){var c=this.options.log;c&&console.time("total time");var a="prepare "+b.length+" points";c&&console.time(a);this.points=b;b=b.map(d);c&&console.timeEnd(a);for(a=this.options.maxZoom;a>=this.options.minZoom;a--){var f=+Date.now();this.trees[a+
1]=e(b,g,h,this.options.nodeSize,Float32Array);b=this._cluster(b,a);c&&console.log("z%d: %d clusters in %dms",a,b.length,+Date.now()-f)}this.trees[this.options.minZoom]=e(b,g,h,this.options.nodeSize,Float32Array);c&&console.timeEnd("total time");return this},getClusters:function(b,e){for(var g=this.trees[this._limitZoom(e)],h=g.range(b[0]/360+.5,c(b[3]),b[2]/360+.5,c(b[1])),a=[],d=0;d<h.length;d++){var f=g.points[h[d]];a.push(-1!==f.id?this.points[f.id]:n(f))}return a},getTile:function(b,c,e){var g=
this.trees[this._limitZoom(b)];b=Math.pow(2,b);var h=this.options.radius/this.options.extent,a=(e-h)/b,d=(e+1+h)/b,f={features:[]};this._addTileFeatures(g.range((c-h)/b,a,(c+1+h)/b,d),g.points,c,e,b,f);0===c&&this._addTileFeatures(g.range(1-h/b,a,1,d),g.points,b,e,b,f);c===b-1&&this._addTileFeatures(g.range(0,a,h/b,d),g.points,-1,e,b,f);return f.features.length?f:null},_addTileFeatures:function(b,c,e,g,h,a){for(var d=0;d<b.length;d++){var f=c[b[d]];a.features.push({type:1,geometry:[[Math.round(this.options.extent*
(f.x*h-e)),Math.round(this.options.extent*(f.y*h-g))]],tags:-1!==f.id?this.points[f.id].properties:l(f)})}},_limitZoom:function(b){return Math.max(this.options.minZoom,Math.min(b,this.options.maxZoom+1))},_cluster:function(b,c){for(var e=[],g=this.options.radius/(this.options.extent*Math.pow(2,c)),h=0;h<b.length;h++){var a=b[h];if(!(a.zoom<=c)){a.zoom=c;for(var d=this.trees[c+1],f=d.within(a.x,a.y,g),p=!1,l=a.numPoints,n=a.x*l,k=a.y*l,m=0;m<f.length;m++){var z=d.points[f[m]];c<z.zoom&&(p=!0,z.zoom=
c,n+=z.x*z.numPoints,k+=z.y*z.numPoints,l+=z.numPoints)}e.push(p?{x:n/l,y:k/l,zoom:Infinity,id:-1,numPoints:l}:a)}}return e}}},{kdbush:19}],30:[function(a,k,m){function f(a,l){if(!(this instanceof f))return new f(a,l);this.data=a||[];this.length=this.data.length;this.compare=l||d;if(a)for(var c=Math.floor(this.length/2);0<=c;c--)this._down(c)}function d(a,d){return a<d?-1:a>d?1:0}k.exports=f;f.prototype={push:function(a){this.data.push(a);this.length++;this._up(this.length-1)},pop:function(){var a=
this.data[0];this.data[0]=this.data[this.length-1];this.length--;this.data.pop();this._down(0);return a},peek:function(){return this.data[0]},_up:function(a){for(var d=this.data,c=this.compare;0<a;){var g=Math.floor((a-1)/2);if(0>c(d[a],d[g])){var h=d,e=h[g];h[g]=h[a];h[a]=e;a=g}else break}},_down:function(a){for(var d=this.data,c=this.compare,g=this.length;;){var h=2*a+1,e=h+1,b=a;h<g&&0>c(d[h],d[b])&&(b=h);e<g&&0>c(d[e],d[b])&&(b=e);if(b===a)break;h=d;e=h[b];h[b]=h[a];h[a]=e;a=b}}}},{}],31:[function(a,
k,m){k.exports="function"===typeof Object.create?function(a,d){a.super_=d;a.prototype=Object.create(d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:function(a,d){a.super_=d;var f=function(){};f.prototype=d.prototype;a.prototype=new f;a.prototype.constructor=a}},{}],32:[function(a,k,m){k.exports=function(a){return a&&"object"===typeof a&&"function"===typeof a.copy&&"function"===typeof a.fill&&"function"===typeof a.readUInt8}},{}],33:[function(a,k,m){(function(f,d){function n(b,
e){var g={seen:[],stylize:c};3<=arguments.length&&(g.depth=arguments[2]);4<=arguments.length&&(g.colors=arguments[3]);A(e)?g.showHidden=e:e&&m._extend(g,e);v(g.showHidden)&&(g.showHidden=!1);v(g.depth)&&(g.depth=2);v(g.colors)&&(g.colors=!1);v(g.customInspect)&&(g.customInspect=!0);g.colors&&(g.stylize=l);return h(g,b,g.depth)}function l(b,c){var e=n.styles[c];return e?"\u001b["+n.colors[e][0]+"m"+b+"\u001b["+n.colors[e][1]+"m":b}function c(b,c){return b}function g(b){var c={};b.forEach(function(b,
e){c[b]=!0});return c}function h(c,a,d){if(c.customInspect&&a&&z(a.inspect)&&a.inspect!==m.inspect&&(!a.constructor||a.constructor.prototype!==a)){var f=a.inspect(d,c);t(f)||(f=h(c,f,d));return f}if(f=e(c,a))return f;var l=Object.keys(a),n=g(l);c.showHidden&&(l=Object.getOwnPropertyNames(a));if(C(a)&&(0<=l.indexOf("message")||0<=l.indexOf("description")))return b(a);if(0===l.length){if(z(a))return c.stylize("[Function"+(a.name?": "+a.name:"")+"]","special");if(k(a))return c.stylize(RegExp.prototype.toString.call(a),
"regexp");if(x(a))return c.stylize(Date.prototype.toString.call(a),"date");if(C(a))return b(a)}var f="",A=!1,y=["{","}"];u(a)&&(A=!0,y=["[","]"]);z(a)&&(f=" [Function"+(a.name?": "+a.name:"")+"]");k(a)&&(f=" "+RegExp.prototype.toString.call(a));x(a)&&(f=" "+Date.prototype.toUTCString.call(a));C(a)&&(f=" "+b(a));if(0===l.length&&(!A||0==a.length))return y[0]+f+y[1];if(0>d)return k(a)?c.stylize(RegExp.prototype.toString.call(a),"regexp"):c.stylize("[Object]","special");c.seen.push(a);l=A?p(c,a,d,n,
l):l.map(function(b){return q(c,a,d,n,b,A)});c.seen.pop();return r(l,f,y)}function e(b,c){if(v(c))return b.stylize("undefined","undefined");if(t(c)){var e="'"+JSON.stringify(c).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return b.stylize(e,"string")}if(y(c))return b.stylize(""+c,"number");if(A(c))return b.stylize(""+c,"boolean");if(null===c)return b.stylize("null","null")}function b(b){return"["+Error.prototype.toString.call(b)+"]"}function p(b,c,e,a,g){for(var h=[],d=0,f=c.length;d<
f;++d)Object.prototype.hasOwnProperty.call(c,String(d))?h.push(q(b,c,e,a,String(d),!0)):h.push("");g.forEach(function(g){g.match(/^\d+$/)||h.push(q(b,c,e,a,g,!0))});return h}function q(b,c,e,a,g,d){var f,q;c=Object.getOwnPropertyDescriptor(c,g)||{value:c[g]};c.get?q=c.set?b.stylize("[Getter/Setter]","special"):b.stylize("[Getter]","special"):c.set&&(q=b.stylize("[Setter]","special"));Object.prototype.hasOwnProperty.call(a,g)||(f="["+g+"]");q||(0>b.seen.indexOf(c.value)?(q=null===e?h(b,c.value,null):
h(b,c.value,e-1),-1<q.indexOf("\n")&&(q=d?q.split("\n").map(function(b){return"  "+b}).join("\n").substr(2):"\n"+q.split("\n").map(function(b){return"   "+b}).join("\n"))):q=b.stylize("[Circular]","special"));if(v(f)){if(d&&g.match(/^\d+$/))return q;f=JSON.stringify(""+g);f.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(f=f.substr(1,f.length-2),f=b.stylize(f,"name")):(f=f.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),f=b.stylize(f,"string"))}return f+": "+q}function r(b,c,e){var g=0;return 60<
b.reduce(function(b,c){g++;0<=c.indexOf("\n")&&g++;return b+c.replace(/\u001b\[\d\d?m/g,"").length+1},0)?e[0]+(""===c?"":c+"\n ")+" "+b.join(",\n  ")+" "+e[1]:e[0]+c+" "+b.join(", ")+" "+e[1]}function u(b){return Array.isArray(b)}function A(b){return"boolean"===typeof b}function y(b){return"number"===typeof b}function t(b){return"string"===typeof b}function v(b){return void 0===b}function k(b){return w(b)&&"[object RegExp]"===Object.prototype.toString.call(b)}function w(b){return"object"===typeof b&&
null!==b}function x(b){return w(b)&&"[object Date]"===Object.prototype.toString.call(b)}function C(b){return w(b)&&("[object Error]"===Object.prototype.toString.call(b)||b instanceof Error)}function z(b){return"function"===typeof b}function E(b){return 10>b?"0"+b.toString(10):b.toString(10)}function D(){var b=new Date,c=[E(b.getHours()),E(b.getMinutes()),E(b.getSeconds())].join(":");return[b.getDate(),F[b.getMonth()],c].join(" ")}var H=/%[sdj%]/g;m.format=function(b){if(!t(b)){for(var c=[],e=0;e<
arguments.length;e++)c.push(n(arguments[e]));return c.join(" ")}for(var e=1,g=arguments,a=g.length,c=String(b).replace(H,function(b){if("%%"===b)return"%";if(e>=a)return b;switch(b){case "%s":return String(g[e++]);case "%d":return Number(g[e++]);case "%j":try{return JSON.stringify(g[e++])}catch(Q){return"[Circular]"}default:return b}}),h=g[e];e<a;h=g[++e])c=null!==h&&w(h)?c+(" "+n(h)):c+(" "+h);return c};m.deprecate=function(b,c){if(v(d.process))return function(){return m.deprecate(b,c).apply(this,
arguments)};if(!0===f.noDeprecation)return b;var e=!1;return function(){if(!e){if(f.throwDeprecation)throw Error(c);f.traceDeprecation?console.trace(c):console.error(c);e=!0}return b.apply(this,arguments)}};var I={},G;m.debuglog=function(b){v(G)&&(G=f.env.NODE_DEBUG||"");b=b.toUpperCase();if(!I[b])if((new RegExp("\\b"+b+"\\b","i")).test(G)){var c=f.pid;I[b]=function(){var e=m.format.apply(m,arguments);console.error("%s %d: %s",b,c,e)}}else I[b]=function(){};return I[b]};m.inspect=n;n.colors={bold:[1,
22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};n.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"};m.isArray=u;m.isBoolean=A;m.isNull=function(b){return null===b};m.isNullOrUndefined=function(b){return null==b};m.isNumber=y;m.isString=t;m.isSymbol=function(b){return"symbol"===typeof b};m.isUndefined=
v;m.isRegExp=k;m.isObject=w;m.isDate=x;m.isError=C;m.isFunction=z;m.isPrimitive=function(b){return null===b||"boolean"===typeof b||"number"===typeof b||"string"===typeof b||"symbol"===typeof b||"undefined"===typeof b};m.isBuffer=a("./support/isBuffer");var F="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");m.log=function(){console.log("%s - %s",D(),m.format.apply(m,arguments))};m.inherits=a("inherits");m._extend=function(b,c){if(!c||!w(c))return b;for(var e=Object.keys(c),g=e.length;g--;)b[e[g]]=
c[e[g]];return b}}).call(this,a("_process"),"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./support/isBuffer":32,_process:27,inherits:31}],34:[function(a,k,m){k.exports.VectorTile=a("./lib/vectortile.js");k.exports.VectorTileFeature=a("./lib/vectortilefeature.js");k.exports.VectorTileLayer=a("./lib/vectortilelayer.js")},{"./lib/vectortile.js":35,"./lib/vectortilefeature.js":36,"./lib/vectortilelayer.js":37}],35:[function(a,k,m){function f(a,
f,c){3===a&&(a=new d(c,c.readVarint()+c.pos),a.length&&(f[a.name]=a))}var d=a("./vectortilelayer");k.exports=function(a,d){this.layers=a.readFields(f,{},d)}},{"./vectortilelayer":37}],36:[function(a,k,m){function f(c,g,a,e,b){this.properties={};this.extent=a;this.type=0;this._pbf=c;this._geometry=-1;this._keys=e;this._values=b;c.readFields(d,this,g)}function d(c,g,a){if(1==c)g.id=a.readVarint();else if(2==c)for(c=a.readVarint()+a.pos;a.pos<c;){var e=g._keys[a.readVarint()],b=g._values[a.readVarint()];
g.properties[e]=b}else 3==c?g.type=a.readVarint():4==c&&(g._geometry=a.pos)}function n(c){var a=c.length;if(1>=a)return[c];for(var h=[],e,b,d=0;d<a;d++){var f,r,u=c[d],l=0,n=0,t=u.length;for(r=t-1;n<t;r=n++)f=u[n],r=u[r],l+=(r.x-f.x)*(f.y+r.y);f=l;0!==f&&(void 0===b&&(b=0>f),b===0>f?(e&&h.push(e),e=[c[d]]):e.push(c[d]))}e&&h.push(e);return h}var l=a("point-geometry");k.exports=f;f.types=["Unknown","Point","LineString","Polygon"];f.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;
for(var a=c.readVarint()+c.pos,h=1,e=0,b=0,d=0,f=[],r;c.pos<a;)if(e||(e=c.readVarint(),h=e&7,e>>=3),e--,1===h||2===h)b+=c.readSVarint(),d+=c.readSVarint(),1===h&&(r&&f.push(r),r=[]),r.push(new l(b,d));else if(7===h)r&&r.push(r[0].clone());else throw Error("unknown command "+h);r&&f.push(r);return f};f.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var a=c.readVarint()+c.pos,h=1,e=0,b=0,d=0,f=Infinity,r=-Infinity,u=Infinity,l=-Infinity;c.pos<a;)if(e||(e=c.readVarint(),h=e&7,e>>=
3),e--,1===h||2===h)b+=c.readSVarint(),d+=c.readSVarint(),b<f&&(f=b),b>r&&(r=b),d<u&&(u=d),d>l&&(l=d);else if(7!==h)throw Error("unknown command "+h);return[f,u,r,l]};f.prototype.toGeoJSON=function(c,a,h){function e(c){for(var e=0;e<c.length;e++){var a=c[e];c[e]=[360*(a.x+g)/b-180,360/Math.PI*Math.atan(Math.exp((180-360*(a.y+d)/b)*Math.PI/180))-90]}}var b=this.extent*Math.pow(2,h),g=this.extent*c,d=this.extent*a;c=this.loadGeometry();a=f.types[this.type];var r;switch(this.type){case 1:r=[];for(h=
0;h<c.length;h++)r[h]=c[h][0];c=r;e(c);break;case 2:for(h=0;h<c.length;h++)e(c[h]);break;case 3:for(c=n(c),h=0;h<c.length;h++)for(r=0;r<c[h].length;r++)e(c[h][r])}1===c.length?c=c[0]:a="Multi"+a;c={type:"Feature",geometry:{type:a,coordinates:c},properties:this.properties};"id"in this&&(c.id=this.id);return c}},{"point-geometry":26}],37:[function(a,k,m){function f(c,a){this.version=1;this.name=null;this.extent=4096;this.length=0;this._pbf=c;this._keys=[];this._values=[];this._features=[];c.readFields(d,
this,a);this.length=this._features.length}function d(c,a,h){15===c?a.version=h.readVarint():1===c?a.name=h.readString():5===c?a.extent=h.readVarint():2===c?a._features.push(h.pos):3===c?a._keys.push(h.readString()):4===c&&a._values.push(n(h))}function n(c){for(var a=null,h=c.readVarint()+c.pos;c.pos<h;)a=c.readVarint()>>3,a=1===a?c.readString():2===a?c.readFloat():3===a?c.readDouble():4===a?c.readVarint64():5===a?c.readVarint():6===a?c.readSVarint():7===a?c.readBoolean():null;return a}var l=a("./vectortilefeature.js");
k.exports=f;f.prototype.feature=function(c){if(0>c||c>=this._features.length)throw Error("feature index out of bounds");this._pbf.pos=this._features[c];c=this._pbf.readVarint()+this._pbf.pos;return new l(this._pbf,c,this.extent,this._keys,this._values)}},{"./vectortilefeature.js":36}],38:[function(a,k,m){function f(c){var a=[],e;for(e in c.layers)a.push(d(c.layers[e]));c=new n;l.tile.write({layers:a},c);return c.finish()}function d(c){for(var a={name:c.name||"",version:c.version||1,extent:c.extent||
4096,keys:[],values:[],features:[]},e={},b={},g=0;g<c.length;g++){for(var d=c.feature(g),f=d,l=d.loadGeometry(),n=[],y=0,t=0,v=l.length,k=0;k<v;k++){var w=l[k];n.push(9);for(var x=0;x<w.length;x++){1===x&&n.push((w.length-1<<3)+2);var m=w[x].x-y,z=w[x].y-t;n.push(m<<1^m>>31,z<<1^z>>31);y+=m;t+=z}}f.geometry=n;var f=[],E;for(E in d.properties)l=e[E],"undefined"===typeof l&&(a.keys.push(E),l=a.keys.length-1,e[E]=l),y=d.properties[E],t=typeof y,"string"===t?n={string_value:y}:"boolean"===t?n={bool_value:y}:
"number"===t?n=0!==y%1?{double_value:y}:0>y?{sint_value:y}:{uint_value:y}:(y=JSON.stringify(y),n={string_value:y}),n.key=t+":"+y,y=b[n.key],"undefined"===typeof y&&(a.values.push(n),y=a.values.length-1,b[n.key]=y),f.push(l),f.push(y);d.tags=f;a.features.push(d)}return a}var n=a("pbf"),l=a("./vector-tile-pb"),c=a("./lib/geojson_wrapper");k.exports=f;k.exports.fromVectorTileJs=f;k.exports.fromGeojsonVt=function(a){var g={},e;for(e in a)g[e]=new c(a[e].features),g[e].name=e;return f({layers:g})};k.exports.GeoJSONWrapper=
c},{"./lib/geojson_wrapper":39,"./vector-tile-pb":40,pbf:25}],39:[function(a,k,m){function f(a){this.features=a;this.length=a.length}function d(a){this.id="number"===typeof a.id?a.id:void 0;this.type=a.type;this.rawGeometry=1===a.type?[a.geometry]:a.geometry;this.properties=a.tags;this.extent=4096}var n=a("point-geometry");a=a("vector-tile").VectorTileFeature;k.exports=f;f.prototype.feature=function(a){return new d(this.features[a])};d.prototype.loadGeometry=function(){var a=this.rawGeometry;this.geometry=
[];for(var c=0;c<a.length;c++){for(var g=a[c],d=[],e=0;e<g.length;e++)d.push(new n(g[e][0],g[e][1]));this.geometry.push(d)}return this.geometry};d.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var a=this.geometry,c=Infinity,g=-Infinity,d=Infinity,e=-Infinity,b=0;b<a.length;b++)for(var f=a[b],q=0;q<f.length;q++)var r=f[q],c=Math.min(c,r.x),g=Math.max(g,r.x),d=Math.min(d,r.y),e=Math.max(e,r.y);return[c,d,g,e]};d.prototype.toGeoJSON=a.prototype.toGeoJSON},{"point-geometry":26,"vector-tile":34}],
40:[function(a,k,m){function f(b,c,a){3===b&&c.layers.push(e(a,a.readVarint()+a.pos))}function d(b,c){return b.readFields(n,{},c)}function n(b,c,e){1===b?c.string_value=e.readString():2===b?c.float_value=e.readFloat():3===b?c.double_value=e.readDouble():4===b?c.int_value=e.readVarint():5===b?c.uint_value=e.readVarint():6===b?c.sint_value=e.readSVarint():7===b&&(c.bool_value=e.readBoolean())}function l(b,c){void 0!==b.string_value&&c.writeStringField(1,b.string_value);void 0!==b.float_value&&c.writeFloatField(2,
b.float_value);void 0!==b.double_value&&c.writeDoubleField(3,b.double_value);void 0!==b.int_value&&c.writeVarintField(4,b.int_value);void 0!==b.uint_value&&c.writeVarintField(5,b.uint_value);void 0!==b.sint_value&&c.writeSVarintField(6,b.sint_value);void 0!==b.bool_value&&c.writeBooleanField(7,b.bool_value)}function c(b,c){var e=b.readFields(g,{},c);void 0===e.type&&(e.type="Unknown");return e}function g(b,c,e){1===b?c.id=e.readVarint():2===b?c.tags=e.readPackedVarint():3===b?c.type=e.readVarint():
4===b&&(c.geometry=e.readPackedVarint())}function h(b,c){void 0!==b.id&&c.writeVarintField(1,b.id);void 0!==b.tags&&c.writePackedVarint(2,b.tags);void 0!==b.type&&c.writeVarintField(3,b.type);void 0!==b.geometry&&c.writePackedVarint(4,b.geometry)}function e(c,e){return c.readFields(b,{features:[],keys:[],values:[]},e)}function b(b,e,a){15===b?e.version=a.readVarint():1===b?e.name=a.readString():2===b?e.features.push(c(a,a.readVarint()+a.pos)):3===b?e.keys.push(a.readString()):4===b?e.values.push(d(a,
a.readVarint()+a.pos)):5===b&&(e.extent=a.readVarint())}function p(b,c){void 0!==b.version&&c.writeVarintField(15,b.version);void 0!==b.name&&c.writeStringField(1,b.name);var e;if(void 0!==b.features)for(e=0;e<b.features.length;e++)c.writeMessage(2,h,b.features[e]);if(void 0!==b.keys)for(e=0;e<b.keys.length;e++)c.writeStringField(3,b.keys[e]);if(void 0!==b.values)for(e=0;e<b.values.length;e++)c.writeMessage(4,l,b.values[e]);void 0!==b.extent&&c.writeVarintField(5,b.extent)}a=m.tile={read:function(b,
c){return b.readFields(f,{layers:[]},c)},write:function(b,c){var e;if(void 0!==b.layers)for(e=0;e<b.layers.length;e++)c.writeMessage(3,p,b.layers[e])}};a.GeomType={Unknown:0,Point:1,LineString:2,Polygon:3};a.value={read:d,write:l};a.feature={read:c,write:h};a.layer={read:e,write:p}},{}],41:[function(a,k,m,f,d,n){var l=JSON.stringify;k.exports=function(c,a){function g(b){A[b]=!0;for(var c in d[b][1]){var e=d[b][1][c];A[e]||g(e)}}for(var e,b=Object.keys(n),p=0,q=b.length;p<q;p++){var r=b[p],u=n[r].exports;
if(u===c||u&&u["default"]===c){e=r;break}}if(!e){e=Math.floor(Math.pow(16,8)*Math.random()).toString(16);u={};p=0;for(q=b.length;p<q;p++)r=b[p],u[r]=r;d[e]=[Function(["require","module","exports"],"("+c+")(self)"),u]}b=Math.floor(Math.pow(16,8)*Math.random()).toString(16);p={};p[e]=e;d[b]=[Function(["require"],"var f = require("+l(e)+");(f.default ? f.default : f)(self);"),p];var A={};g(b);b="("+f+")({"+Object.keys(A).map(function(b){return l(b)+":["+d[b][0]+","+l(d[b][1])+"]"}).join(",")+"},{},["+
l(b)+"])";e=window.URL||window.webkitURL||window.mozURL||window.msURL;b=new Blob([b],{type:"text/javascript"});if(a&&a.bare)return b;e=e.createObjectURL(b);b=new Worker(e);b.objectURL=e;return b}},{}],42:[function(a,k,m){k.exports.RADIUS=6378137;k.exports.FLATTENING=1/298.257223563;k.exports.POLAR_RADIUS=6356752.3142},{}],43:[function(a,k,m){k.exports={version:"0.37.0"}},{}],44:[function(a,k,m){var f=a("./program_configuration"),d=a("./vertex_array_type"),n=function(c,a){this.vertexOffset=c;this.primitiveOffset=
a;this.primitiveLength=this.vertexLength=0},l=function(c,a,h){this.globalProperties={zoom:h};this.layoutVertexArray=new (d(c.layoutAttributes));var e=c.elementArrayType;e&&(this.elementArray=new e);if(e=c.elementArrayType2)this.elementArray2=new e;this.layerData={};for(e=0;e<a.length;e+=1){var b=a[e],g=f.createDynamic(c.paintAttributes||[],b,h);this.layerData[b.id]={layer:b,programConfiguration:g,paintVertexArray:new g.PaintVertexArray,paintPropertyStatistics:g.createPaintPropertyStatistics()}}this.segments=
[];this.segments2=[]};l.prototype.prepareSegment=function(c){var a=this.segments[this.segments.length-1];if(!a||a.vertexLength+c>l.MAX_VERTEX_ARRAY_LENGTH)a=new n(this.layoutVertexArray.length,this.elementArray.length),this.segments.push(a);return a};l.prototype.prepareSegment2=function(c){var a=this.segments2[this.segments2.length-1];if(!a||a.vertexLength+c>l.MAX_VERTEX_ARRAY_LENGTH)a=new n(this.layoutVertexArray.length,this.elementArray2.length),this.segments2.push(a);return a};l.prototype.populatePaintArrays=
function(c){for(var a in this.layerData){var d=this.layerData[a];0!==d.paintVertexArray.bytesPerElement&&d.programConfiguration.populatePaintArray(d.layer,d.paintVertexArray,d.paintPropertyStatistics,this.layoutVertexArray.length,this.globalProperties,c)}};l.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length};l.prototype.serialize=function(c){var a=this.layoutVertexArray.serialize(c),d=this.elementArray&&this.elementArray.serialize(c),e=this.elementArray2&&this.elementArray2.serialize(c),
b=this.layerData,f={},q;for(q in b){var r=b[q].paintVertexArray;if(0!==r.length){var l=r.serialize(c),r=r.constructor.serialize();f[q]={array:l,type:r}}}return{layoutVertexArray:a,elementArray:d,elementArray2:e,paintVertexArrays:f,segments:this.segments,segments2:this.segments2}};l.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1;k.exports=l},{"./program_configuration":58,"./vertex_array_type":60}],45:[function(a,k,m){var f=a("./array_group"),d=a("./buffer_group"),n=a("../util/util");a=function(a,c){this.zoom=
a.zoom;this.overscaling=a.overscaling;this.layers=a.layers;this.index=a.index;a.arrays?this.buffers=new d(c,a.layers,a.zoom,a.arrays):this.arrays=new f(c,a.layers,a.zoom)};a.prototype.populate=function(a,c){for(var g=0;g<a.length;g+=1){var d=a[g];this.layers[0].filter(d)&&(this.addFeature(d),c.featureIndex.insert(d,this.index))}};a.prototype.getPaintPropertyStatistics=function(){return n.mapObject(this.arrays.layerData,function(a){return a.paintPropertyStatistics})};a.prototype.isEmpty=function(){return this.arrays.isEmpty()};
a.prototype.serialize=function(a){return{zoom:this.zoom,layerIds:this.layers.map(function(c){return c.id}),arrays:this.arrays.serialize(a)}};a.prototype.destroy=function(){this.buffers&&(this.buffers.destroy(),this.buffers=null)};k.exports=a;a.deserialize=function(a,c){if(c){for(var d={},f=0;f<a.length;f+=1){var e=a[f],b=e.layerIds.map(function(b){return c.getLayer(b)}).filter(Boolean);if(0!==b.length)for(var e=b[0].createBucket(n.extend({layers:b},e)),p=0;p<b.length;p+=1)d[b[p].id]=e}return d}}},
{"../util/util":217,"./array_group":44,"./buffer_group":52}],46:[function(a,k,m){function f(c,a,e,b,d){c.emplaceBack(2*a+(b+1)/2,2*e+(d+1)/2)}m=a("../bucket");var d=a("../element_array_type"),n=a("../load_geometry"),l=a("../extent"),c={layoutAttributes:[{name:"a_pos",components:2,type:"Int16"}],elementArrayType:d(),paintAttributes:[{property:"circle-color",type:"Uint8"},{property:"circle-radius",type:"Uint16",multiplier:10},{property:"circle-blur",type:"Uint16",multiplier:10},{property:"circle-opacity",
type:"Uint8",multiplier:255},{property:"circle-stroke-color",type:"Uint8"},{property:"circle-stroke-width",type:"Uint16",multiplier:10},{property:"circle-stroke-opacity",type:"Uint8",multiplier:255}]};a=function(a){function d(e){a.call(this,e,c)}a&&(d.__proto__=a);d.prototype=Object.create(a&&a.prototype);d.prototype.constructor=d;d.prototype.addFeature=function(c){for(var b=this.arrays,e=0,a=n(c);e<a.length;e+=1)for(var d=0,g=a[e];d<g.length;d+=1){var h=g[d],y=h.x,h=h.y;if(!(0>y||y>=l||0>h||h>=l)){var t=
b.prepareSegment(4),v=t.vertexLength;f(b.layoutVertexArray,y,h,-1,-1);f(b.layoutVertexArray,y,h,1,-1);f(b.layoutVertexArray,y,h,1,1);f(b.layoutVertexArray,y,h,-1,1);b.elementArray.emplaceBack(v,v+1,v+2);b.elementArray.emplaceBack(v,v+3,v+2);t.vertexLength+=4;t.primitiveLength+=2}}b.populatePaintArrays(c.properties)};return d}(m);a.programInterface=c;k.exports=a},{"../bucket":45,"../element_array_type":53,"../extent":54,"../load_geometry":56}],47:[function(a,k,m){m=a("../bucket");var f=a("../element_array_type"),
d=a("../load_geometry"),n=a("earcut"),l=a("../../util/classify_rings"),c=a("assert"),g={layoutAttributes:[{name:"a_pos",components:2,type:"Int16"}],elementArrayType:f(3),elementArrayType2:f(2),paintAttributes:[{property:"fill-color",type:"Uint8"},{property:"fill-outline-color",type:"Uint8"},{property:"fill-opacity",type:"Uint8",multiplier:255}]};a=function(a){function e(b){a.call(this,b,g)}a&&(e.__proto__=a);e.prototype=Object.create(a&&a.prototype);e.prototype.constructor=e;e.prototype.addFeature=
function(b){for(var e=this.arrays,a=0,g=l(d(b),500);a<g.length;a+=1){for(var f=g[a],h=0,y=0,t=f;y<t.length;y+=1)h+=t[y].length;for(var y=e.prepareSegment(h),t=y.vertexLength,v=[],k=[],w=0,x=f;w<x.length;w+=1){var m=x[w];if(0!==m.length){m!==f[0]&&k.push(v.length/2);var z=e.prepareSegment2(m.length),E=z.vertexLength;e.layoutVertexArray.emplaceBack(m[0].x,m[0].y);e.elementArray2.emplaceBack(E+m.length-1,E);v.push(m[0].x);v.push(m[0].y);for(var D=1;D<m.length;D++)e.layoutVertexArray.emplaceBack(m[D].x,
m[D].y),e.elementArray2.emplaceBack(E+D-1,E+D),v.push(m[D].x),v.push(m[D].y);z.vertexLength+=m.length;z.primitiveLength+=m.length}}f=n(v,k);c(0===f.length%3);for(v=0;v<f.length;v+=3)e.elementArray.emplaceBack(t+f[v],t+f[v+1],t+f[v+2]);y.vertexLength+=h;y.primitiveLength+=f.length/3}e.populatePaintArrays(b.properties)};return e}(m);a.programInterface=g;k.exports=a},{"../../util/classify_rings":199,"../bucket":45,"../element_array_type":53,"../load_geometry":56,assert:5,earcut:6}],48:[function(a,k,
m){function f(c,e,a,d,g,f,h,l){c.emplaceBack(e,a,2*Math.floor(d*b)+h,g*b*2,f*b*2,Math.round(l))}m=a("../bucket");var d=a("../element_array_type"),n=a("../load_geometry"),l=a("../extent"),c=a("earcut"),g=a("../../util/classify_rings"),h=a("assert"),e={layoutAttributes:[{name:"a_pos",components:2,type:"Int16"},{name:"a_normal",components:3,type:"Int16"},{name:"a_edgedistance",components:1,type:"Int16"}],elementArrayType:d(3),paintAttributes:[{property:"fill-extrusion-base",type:"Uint16"},{property:"fill-extrusion-height",
type:"Uint16"},{property:"fill-extrusion-color",type:"Uint8"}]},b=Math.pow(2,13);a=function(b){function a(c){b.call(this,c,e)}b&&(a.__proto__=b);a.prototype=Object.create(b&&b.prototype);a.prototype.constructor=a;a.prototype.addFeature=function(b){for(var e=this.arrays,a=0,d=g(n(b),500);a<d.length;a+=1){for(var q=d[a],p=0,r=0,k=q;r<k.length;r+=1)p+=k[r].length;for(var p=e.prepareSegment(5*p),k=[],x=[],r=[],m=0,z=q;m<z.length;m+=1){var E=z[m];if(0!==E.length){E!==q[0]&&x.push(k.length/2);for(var D=
0,H=0;H<E.length;H++){var I=E[H];f(e.layoutVertexArray,I.x,I.y,0,0,1,1,0);r.push(p.vertexLength++);if(1<=H){var G=E[H-1];if(!(I.x===G.x&&(0>I.x||I.x>l)||I.y===G.y&&(0>I.y||I.y>l))){var F=I.sub(G)._perp()._unit();f(e.layoutVertexArray,I.x,I.y,F.x,F.y,0,0,D);f(e.layoutVertexArray,I.x,I.y,F.x,F.y,0,1,D);D+=G.dist(I);f(e.layoutVertexArray,G.x,G.y,F.x,F.y,0,0,D);f(e.layoutVertexArray,G.x,G.y,F.x,F.y,0,1,D);G=p.vertexLength;e.elementArray.emplaceBack(G,G+1,G+2);e.elementArray.emplaceBack(G+1,G+2,G+3);p.vertexLength+=
4;p.primitiveLength+=2}}k.push(I.x);k.push(I.y)}}}q=c(k,x);h(0===q.length%3);for(k=0;k<q.length;k+=3)e.elementArray.emplaceBack(r[q[k]],r[q[k+1]],r[q[k+2]]);p.primitiveLength+=q.length/3}e.populatePaintArrays(b.properties)};return a}(m);a.programInterface=e;k.exports=a},{"../../util/classify_rings":199,"../bucket":45,"../element_array_type":53,"../extent":54,"../load_geometry":56,assert:5,earcut:6}],49:[function(a,k,m){function f(b,c,e,a,d,g,f){b.emplaceBack(c.x<<1|a,c.y<<1|d,Math.round(63*e.x)+128,
Math.round(63*e.y)+128,(0===g?0:0>g?-1:1)+1|(.5*f&63)<<2,.5*f>>6)}m=a("../bucket");var d=a("../element_array_type"),n=a("../load_geometry"),l=a("../extent"),c=a("vector-tile").VectorTileFeature,g=Math.cos(Math.PI/180*37.5),h=Math.pow(2,14)/.5,e={layoutAttributes:[{name:"a_pos",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],paintAttributes:[{property:"line-color",type:"Uint8"},{property:"line-blur",multiplier:10,type:"Uint8"},{property:"line-opacity",multiplier:10,type:"Uint8"},
{property:"line-gap-width",multiplier:10,type:"Uint8",name:"a_gapwidth"},{property:"line-offset",multiplier:1,type:"Int8"}],elementArrayType:d()};a=function(b){function a(c){b.call(this,c,e)}b&&(a.__proto__=b);a.prototype=Object.create(b&&b.prototype);a.prototype.constructor=a;a.prototype.addFeature=function(b){for(var c=this.layers[0].layout,e=c["line-join"],a=c["line-cap"],d=c["line-miter-limit"],c=c["line-round-limit"],g=0,f=n(b,15);g<f.length;g+=1)this.addLine(f[g],b,e,a,d,c)};a.prototype.addLine=
function(b,e,a,d,f,h){var q=e.properties;e="Polygon"===c.types[e.type];for(var p=b.length;2<=p&&b[p-1].equals(b[p-2]);)p--;for(var r=0;r<p-1&&b[r].equals(b[r+1]);)r++;if(!(p<(e?3:2))){"bevel"===a&&(f=1.05);var n=l/(512*this.overscaling)*15,u=b[r],t=this.arrays,A=t.prepareSegment(10*p);this.distance=0;var y=e?"butt":d,k=!0,m,G,F,K,J,L,N;this.e1=this.e2=this.e3=-1;e&&(m=b[p-2],J=u.sub(m)._unit()._perp());for(u=r;u<p;u++)if(F=e&&u===p-1?b[r+1]:b[u+1],!F||!b[u].equals(F)){J&&(K=J);m&&(G=m);m=b[u];J=F?
F.sub(m)._unit()._perp():K;K=K||J;var S=K.add(J);0===S.x&&0===S.y||S._unit();var O=S.x*J.x+S.y*J.y;L=0!==O?1/O:Infinity;var P=O<g&&G&&F;if(P&&u>r){var Q=m.dist(G);Q>2*n&&(Q=m.sub(m.sub(G)._mult(n/Q)._round()),this.distance+=Q.dist(G),this.addCurrentVertex(Q,this.distance,K.mult(1),0,0,!1,A),G=Q)}var R=(Q=G&&F)?a:F?d:y;Q&&"round"===R&&(L<h?R="miter":2>=L&&(R="fakeround"));"miter"===R&&L>f&&(R="bevel");"bevel"===R&&(2<L&&(R="flipbevel"),L<f&&(R="miter"));G&&(this.distance+=m.dist(G));if("miter"===R)S._mult(L),
this.addCurrentVertex(m,this.distance,S,0,0,!1,A);else if("flipbevel"===R)100<L?S=J.clone().mult(-1):(k=0<K.x*J.y-K.y*J.x?-1:1,Q=L*K.add(J).mag()/K.sub(J).mag(),S._perp()._mult(Q*k)),this.addCurrentVertex(m,this.distance,S,0,0,!1,A),this.addCurrentVertex(m,this.distance,S.mult(-1),0,0,!1,A);else if("bevel"===R||"fakeround"===R){var Q=0<K.x*J.y-K.y*J.x,X=-Math.sqrt(L*L-1);Q?(N=0,L=X):(L=0,N=X);k||this.addCurrentVertex(m,this.distance,K,L,N,!1,A);if("fakeround"===R){k=Math.floor(8*(.5-(O-.5)));for(R=
0;R<k;R++)O=J.mult((R+1)/(k+1))._add(K)._unit(),this.addPieSliceVertex(m,this.distance,O,Q,A);this.addPieSliceVertex(m,this.distance,S,Q,A);for(S=k-1;0<=S;S--)O=K.mult((S+1)/(k+1))._add(J)._unit(),this.addPieSliceVertex(m,this.distance,O,Q,A)}F&&this.addCurrentVertex(m,this.distance,J,-L,-N,!1,A)}else"butt"===R?(k||this.addCurrentVertex(m,this.distance,K,0,0,!1,A),F&&this.addCurrentVertex(m,this.distance,J,0,0,!1,A)):"square"===R?(k||(this.addCurrentVertex(m,this.distance,K,1,1,!1,A),this.e1=this.e2=
-1),F&&this.addCurrentVertex(m,this.distance,J,-1,-1,!1,A)):"round"===R&&(k||(this.addCurrentVertex(m,this.distance,K,0,0,!1,A),this.addCurrentVertex(m,this.distance,K,1,1,!0,A),this.e1=this.e2=-1),F&&(this.addCurrentVertex(m,this.distance,J,-1,-1,!0,A),this.addCurrentVertex(m,this.distance,J,0,0,!1,A)));P&&u<p-1&&(P=m.dist(F),P>2*n&&(F=m.add(F.sub(m)._mult(n/P)._round()),this.distance+=F.dist(m),this.addCurrentVertex(F,this.distance,J.mult(1),0,0,!1,A),m=F));k=!1}t.populatePaintArrays(q)}};a.prototype.addCurrentVertex=
function(b,c,e,a,d,g,p){var q=g?1:0,r;r=this.arrays;var l=r.layoutVertexArray,n=r.elementArray;r=e.clone();a&&r._sub(e.perp()._mult(a));f(l,b,r,q,0,a,c);this.e3=p.vertexLength++;0<=this.e1&&0<=this.e2&&(n.emplaceBack(this.e1,this.e2,this.e3),p.primitiveLength++);this.e1=this.e2;this.e2=this.e3;r=e.mult(-1);d&&r._sub(e.perp()._mult(d));f(l,b,r,q,1,-d,c);this.e3=p.vertexLength++;0<=this.e1&&0<=this.e2&&(n.emplaceBack(this.e1,this.e2,this.e3),p.primitiveLength++);this.e1=this.e2;this.e2=this.e3;c>h/
2&&(this.distance=0,this.addCurrentVertex(b,this.distance,e,a,d,g,p))};a.prototype.addPieSliceVertex=function(b,c,e,a,d){var g=a?1:0;e=e.mult(a?-1:1);var h=this.arrays,p=h.elementArray;f(h.layoutVertexArray,b,e,0,g,0,c);this.e3=d.vertexLength++;0<=this.e1&&0<=this.e2&&(p.emplaceBack(this.e1,this.e2,this.e3),d.primitiveLength++);a?this.e2=this.e3:this.e1=this.e3};return a}(m);a.programInterface=e;k.exports=a},{"../bucket":45,"../element_array_type":53,"../extent":54,"../load_geometry":56,"vector-tile":34}],
50:[function(a,k,m){function f(b,c,e,a,d,g,f,h,q,r,l,n,u,t){b.emplaceBack(c,e,Math.round(64*a),Math.round(64*d),g,f,h,q,p(10*(u||0),t%256),p(10*(l||0),10*Math.min(n||25,25)),r?r[0]:void 0,r?r[1]:void 0,r?r[2]:void 0)}function d(b,c,e,a,d,g){return b.emplaceBack(c.x,c.y,e.x,e.y,Math.round(a.x),Math.round(a.y),10*d,10*g)}function n(b,c,e){var a={isFeatureConstant:c.isLayoutValueFeatureConstant(e),isZoomConstant:c.isLayoutValueZoomConstant(e)};a.isFeatureConstant&&(a.layoutSize=c.getLayoutValue(e,{zoom:b+
1}));if(!a.isZoomConstant){for(var d=c.getLayoutValueStopZoomLevels(e),g=0;g<d.length&&d[g]<=b;)g++;for(var f=g=Math.max(0,g-1);f<d.length&&d[f]<b+1;)f++;f=Math.min(d.length-1,f);a.coveringZoomRange=[d[g],d[f]];c.isLayoutValueFeatureConstant(e)&&(a.coveringStopValues=[c.getLayoutValue(e,{zoom:d[g]}),c.getLayoutValue(e,{zoom:d[f]})]);a.functionBase=c.getLayoutProperty(e).base;"undefined"===typeof a.functionBase&&(a.functionBase=1);a.functionType=c.getLayoutProperty(e).type||"exponential"}return a}
function l(b,c){return b.isLayoutValueZoomConstant(c)&&!b.isLayoutValueFeatureConstant(c)?[{name:"a_size",components:1,type:"Uint16"}]:b.isLayoutValueZoomConstant(c)||b.isLayoutValueFeatureConstant(c)?[]:[{name:"a_size",components:3,type:"Uint16"}]}function c(b,c,e,a,d){return b.isLayoutValueZoomConstant(a)&&!b.isLayoutValueFeatureConstant(a)?[10*b.getLayoutValue(a,{},d)]:b.isLayoutValueZoomConstant(a)||b.isLayoutValueFeatureConstant(a)?null:[10*b.getLayoutValue(a,{zoom:e[0]},d),10*b.getLayoutValue(a,
{zoom:e[1]},d),10*b.getLayoutValue(a,{zoom:1+c},d)]}var g=a("point-geometry"),h=a("../array_group"),e=a("../buffer_group");m=a("../element_array_type");var b=a("../extent"),p=a("../../shaders/encode_attribute").packUint8ToFloat,q=a("../../symbol/anchor"),r=a("../../symbol/get_anchors"),u=a("../../util/token"),A=a("../../symbol/quads"),y=a("../../symbol/shaping"),t=a("../../symbol/transform_text"),v=a("../../symbol/mergelines"),B=a("../../symbol/clip_line"),w=a("../../util/util"),x=a("../../util/script_detection"),
C=a("../load_geometry"),z=a("../../symbol/collision_feature"),E=a("../../util/find_pole_of_inaccessibility"),D=a("../../util/classify_rings"),H=a("vector-tile").VectorTileFeature,I=y.shapeText,G=y.shapeIcon,F=y.WritingMode,K=A.getGlyphQuads,J=A.getIconQuads;a=m();var A=[{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_label_pos",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint16"}],L={glyph:{layoutAttributes:A,elementArrayType:a,paintAttributes:[{name:"a_fill_color",property:"text-color",
type:"Uint8"},{name:"a_halo_color",property:"text-halo-color",type:"Uint8"},{name:"a_halo_width",property:"text-halo-width",type:"Uint16",multiplier:10},{name:"a_halo_blur",property:"text-halo-blur",type:"Uint16",multiplier:10},{name:"a_opacity",property:"text-opacity",type:"Uint8",multiplier:255}]},icon:{layoutAttributes:A,elementArrayType:a,paintAttributes:[{name:"a_fill_color",property:"icon-color",type:"Uint8"},{name:"a_halo_color",property:"icon-halo-color",type:"Uint8"},{name:"a_halo_width",
property:"icon-halo-width",type:"Uint16",multiplier:10},{name:"a_halo_blur",property:"icon-halo-blur",type:"Uint16",multiplier:10},{name:"a_opacity",property:"icon-opacity",type:"Uint8",multiplier:255}]},collisionBox:{layoutAttributes:[{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"},{name:"a_data",components:2,type:"Uint8"}],elementArrayType:m(2)}},N=function(b){this.collisionBoxArray=b.collisionBoxArray;this.zoom=
b.zoom;this.overscaling=b.overscaling;this.layers=b.layers;this.index=b.index;this.sdfIcons=b.sdfIcons;this.iconsNeedLinear=b.iconsNeedLinear;this.fontstack=b.fontstack;var c=this.layers[0];this.symbolInterfaces={glyph:w.extend({},L.glyph,{layoutAttributes:[].concat(L.glyph.layoutAttributes,l(c,"text-size"))}),icon:w.extend({},L.icon,{layoutAttributes:[].concat(L.icon.layoutAttributes,l(c,"icon-size"))}),collisionBox:w.extend({},L.collisionBox,{layoutAttributes:[].concat(L.collisionBox.layoutAttributes)})};
if(b.arrays){this.buffers={};for(var a in b.arrays)b.arrays[a]&&(this.buffers[a]=new e(this.symbolInterfaces[a],b.layers,b.zoom,b.arrays[a]));this.textSizeData=b.textSizeData;this.iconSizeData=b.iconSizeData}else this.textSizeData=n(this.zoom,c,"text-size"),this.iconSizeData=n(this.zoom,c,"icon-size")};N.prototype.populate=function(b,c){var e=this.layers[0],a=e.layout,d=a["text-font"],g=(!e.isLayoutValueFeatureConstant("text-field")||a["text-field"])&&d,f=!e.isLayoutValueFeatureConstant("icon-image")||
a["icon-image"];this.features=[];if(g||f){for(var h=c.iconDependencies,p=c.glyphDependencies,d=p[d]=p[d]||{},p={zoom:this.zoom},q=0;q<b.length;q++){var r=b[q];if(e.filter(r)){var l=void 0;g&&(l=e.getLayoutValue("text-field",p,r.properties),e.isLayoutValueFeatureConstant("text-field")&&(l=u(r.properties,l)),l=t(l,e,p,r.properties));var n=void 0;f&&(n=e.getLayoutValue("icon-image",p,r.properties),e.isLayoutValueFeatureConstant("icon-image")&&(n=u(r.properties,n)));if(l||n)if(this.features.push({text:l,
icon:n,index:q,sourceLayerIndex:r.sourceLayerIndex,geometry:C(r),properties:r.properties,type:H.types[r.type]}),n&&(h[n]=!0),l)for(r=0;r<l.length;r++)d[l.charCodeAt(r)]=!0}}"line"===a["symbol-placement"]&&(this.features=v(this.features))}};N.prototype.isEmpty=function(){return this.arrays.icon.isEmpty()&&this.arrays.glyph.isEmpty()&&this.arrays.collisionBox.isEmpty()};N.prototype.getPaintPropertyStatistics=function(){for(var b={},c=0,e=this.layers;c<e.length;c+=1){var a=e[c];b[a.id]=w.extend({},this.arrays.icon.layerData[a.id].paintPropertyStatistics,
this.arrays.glyph.layerData[a.id].paintPropertyStatistics)}return b};N.prototype.serialize=function(b){return{zoom:this.zoom,layerIds:this.layers.map(function(b){return b.id}),sdfIcons:this.sdfIcons,iconsNeedLinear:this.iconsNeedLinear,textSizeData:this.textSizeData,iconSizeData:this.iconSizeData,fontstack:this.fontstack,arrays:w.mapObject(this.arrays,function(c){return c.isEmpty()?null:c.serialize(b)})}};N.prototype.destroy=function(){this.buffers&&(this.buffers.icon&&this.buffers.icon.destroy(),
this.buffers.glyph&&this.buffers.glyph.destroy(),this.buffers.collisionBox&&this.buffers.collisionBox.destroy(),this.buffers=null)};N.prototype.createArrays=function(){var b=this;this.arrays=w.mapObject(this.symbolInterfaces,function(c){return new h(c,b.layers,b.zoom)})};N.prototype.prepare=function(c,e){this.symbolInstances=[];this.tilePixelRatio=b/(512*this.overscaling);this.compareText={};this.iconsNeedLinear=!1;var a=this.layers[0].layout,d=.5,g=.5;switch(a["text-anchor"]){case "right":case "top-right":case "bottom-right":d=
1;break;case "left":case "top-left":case "bottom-left":d=0}switch(a["text-anchor"]){case "bottom":case "bottom-right":case "bottom-left":g=1;break;case "top":case "top-right":case "top-left":g=0}for(var f="right"===a["text-justify"]?1:"left"===a["text-justify"]?0:.5,h=24*a["text-line-height"],p="line"!==a["symbol-placement"]?24*a["text-max-width"]:0,q=24*a["text-letter-spacing"],r=this.fontstack=a["text-font"].join(","),l="map"===a["text-rotation-alignment"]&&"line"===a["symbol-placement"],n=0,u=
this.features;n<u.length;n+=1){var t=u[n],A=void 0;if(t.text){var y=x.allowsVerticalWritingMode(t.text),k=this.layers[0].getLayoutValue("text-offset",{zoom:this.zoom},t.properties).map(function(b){return 24*b}),v=x.allowsLetterSpacing(t.text)?q:0,A={};A[F.horizontal]=I(t.text,c[r],p,h,d,g,f,v,k,24,F.horizontal);A[F.vertical]=y&&l&&I(t.text,c[r],p,h,d,g,f,v,k,24,F.vertical)}else A={};y=void 0;t.icon&&(k=e[t.icon])&&((y=G(k,this.layers[0].getLayoutValue("icon-offset",{zoom:this.zoom},t.properties)),
void 0===this.sdfIcons?this.sdfIcons=k.sdf:this.sdfIcons!==k.sdf&&w.warnOnce("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),k.isNativePixelRatio)?0===a["icon-rotate"]&&this.layers[0].isLayoutValueFeatureConstant("icon-rotate")||(this.iconsNeedLinear=!0):this.iconsNeedLinear=!0);(A[F.horizontal]||y)&&this.addFeature(t,A,y)}};N.prototype.addFeature=function(c,e,a){var d=this,g=this.layers[0].getLayoutValue("text-size",{zoom:this.zoom+1},c.properties),f=this.layers[0].getLayoutValue("icon-size",
{zoom:this.zoom+1},c.properties),h=this.layers[0].getLayoutValue("text-size",{zoom:18},c.properties);void 0===h&&(h=g);var p=this.layers[0].layout,l=g/24*this.tilePixelRatio,g=this.tilePixelRatio*h/24,n=this.tilePixelRatio*f,h=this.tilePixelRatio*p["symbol-spacing"],u=p["symbol-avoid-edges"],t=p["text-padding"]*this.tilePixelRatio,A=p["icon-padding"]*this.tilePixelRatio,y=p["text-max-angle"]/180*Math.PI,k="map"===p["text-rotation-alignment"]&&"line"===p["symbol-placement"],v="map"===p["icon-rotation-alignment"]&&
"line"===p["symbol-placement"],z=p["text-allow-overlap"]||p["icon-allow-overlap"]||p["text-ignore-placement"]||p["icon-ignore-placement"],m=h/2,f=function(g,f){var h=!(0>f.x||f.x>b||0>f.y||f.y>b);u&&!h||d.addSymbolInstance(f,g,e,a,d.layers[0],h||z,d.collisionBoxArray,c.index,c.sourceLayerIndex,d.index,l,t,k,n,A,v,{zoom:d.zoom},c.properties)};if("line"===p["symbol-placement"])for(var p=0,x=B(c.geometry,0,0,b,b);p<x.length;p+=1)for(var w=x[p],C=0,K=r(w,h,y,e[F.vertical]||e[F.horizontal],a,24,g,d.overscaling,
b);C<K.length;C+=1){var G=K[C],J=e[F.horizontal];J&&d.anchorIsTooClose(J.text,m,G)||f(w,G)}else if("Polygon"===c.type)for(g=0,h=D(c.geometry,0);g<h.length;g+=1)y=h[g],m=E(y,16),f(y[0],new q(m.x,m.y,0));else if("LineString"===c.type)for(g=0,h=c.geometry;g<h.length;g+=1)y=h[g],f(y,new q(y[0].x,y[0].y,0));else if("Point"===c.type)for(g=0,h=c.geometry;g<h.length;g+=1)for(y=0,m=h[g];y<m.length;y+=1)p=m[y],f([p],new q(p.x,p.y,0))};N.prototype.anchorIsTooClose=function(b,c,e){var a=this.compareText;if(b in
a)for(var d=a[b],g=d.length-1;0<=g;g--){if(e.dist(d[g])<c)return!0}else a[b]=[];a[b].push(e);return!1};N.prototype.place=function(b,e){this.createArrays();var a=this.layers[0],d=a.layout,g=b.maxScale,f="map"===d["text-rotation-alignment"]&&"line"===d["symbol-placement"],h="map"===d["icon-rotation-alignment"]&&"line"===d["symbol-placement"];if(d["text-allow-overlap"]||d["icon-allow-overlap"]||d["text-ignore-placement"]||d["icon-ignore-placement"]){var p=b.angle,q=Math.sin(p),r=Math.cos(p);this.symbolInstances.sort(function(b,
c){return(q*b.anchor.x+r*b.anchor.y|0)-(q*c.anchor.x+r*c.anchor.y|0)||c.featureIndex-b.featureIndex})}for(var p=0,l=this.symbolInstances;p<l.length;p+=1){var n=l[p],u={boxStartIndex:n.textBoxStartIndex,boxEndIndex:n.textBoxEndIndex},t={boxStartIndex:n.iconBoxStartIndex,boxEndIndex:n.iconBoxEndIndex},A=n.textBoxStartIndex!==n.textBoxEndIndex,y=n.iconBoxStartIndex!==n.iconBoxEndIndex,k=d["text-optional"]||!A,v=d["icon-optional"]||!y,z=A?b.placeCollisionFeature(u,d["text-allow-overlap"],d["symbol-avoid-edges"]):
b.minScale,m=y?b.placeCollisionFeature(t,d["icon-allow-overlap"],d["symbol-avoid-edges"]):b.minScale;k||v?!v&&z?z=Math.max(m,z):!k&&m&&(m=Math.max(m,z)):m=z=Math.max(m,z);A&&(b.insertCollisionFeature(u,z,d["text-ignore-placement"]),z<=g&&(u=c(a,this.zoom,this.textSizeData.coveringZoomRange,"text-size",n.featureProperties),this.addSymbols(this.arrays.glyph,n.glyphQuads,z,u,d["text-keep-upright"],f,b.angle,n.featureProperties,n.writingModes,n.anchor)));y&&(b.insertCollisionFeature(t,m,d["icon-ignore-placement"]),
m<=g&&(t=c(a,this.zoom,this.iconSizeData.coveringZoomRange,"icon-size",n.featureProperties),this.addSymbols(this.arrays.icon,n.iconQuads,m,t,d["icon-keep-upright"],h,b.angle,n.featureProperties,null,n.anchor)))}e&&this.addToDebugBuffers(b)};N.prototype.addSymbols=function(b,c,e,a,d,g,h,p,q,r){var l=b.elementArray,n=b.layoutVertexArray,u=this.zoom;e=Math.max(Math.log(e)/Math.LN2+u,0);for(var t=0;t<c.length;t+=1){var A=c[t],y=(A.anchorAngle+h+Math.PI)%(2*Math.PI);if(q&F.vertical)if(g&&A.writingMode===
F.vertical){if(d&&g&&y<=5*Math.PI/4||y>7*Math.PI/4)continue}else{if(d&&g&&y<=3*Math.PI/4||y>5*Math.PI/4)continue}else if(d&&g&&(y<=Math.PI/2||y>3*Math.PI/2))continue;var y=A.tl,k=A.tr,v=A.bl,z=A.br,m=A.tex,x=A.anchorPoint,w=Math.max(u+Math.log(A.minScale)/Math.LN2,e),B=Math.min(u+Math.log(A.maxScale)/Math.LN2,25);if(!(B<=w)){w===e&&(w=0);var A=Math.round(A.glyphAngle/(2*Math.PI)*256),C=b.prepareSegment(4),E=C.vertexLength;f(n,x.x,x.y,y.x,y.y,r.x,r.y,m.x,m.y,a,w,B,e,A);f(n,x.x,x.y,k.x,k.y,r.x,r.y,
m.x+m.w,m.y,a,w,B,e,A);f(n,x.x,x.y,v.x,v.y,r.x,r.y,m.x,m.y+m.h,a,w,B,e,A);f(n,x.x,x.y,z.x,z.y,r.x,r.y,m.x+m.w,m.y+m.h,a,w,B,e,A);l.emplaceBack(E,E+1,E+2);l.emplaceBack(E+1,E+2,E+3);C.vertexLength+=4;C.primitiveLength+=2}}b.populatePaintArrays(p)};N.prototype.addToDebugBuffers=function(b){for(var c=this.arrays.collisionBox,e=c.layoutVertexArray,a=c.elementArray,f=-b.angle,h=b.yStretch,p=0,q=this.symbolInstances;p<q.length;p+=1){var r=q[p];r.textCollisionFeature={boxStartIndex:r.textBoxStartIndex,boxEndIndex:r.textBoxEndIndex};
r.iconCollisionFeature={boxStartIndex:r.iconBoxStartIndex,boxEndIndex:r.iconBoxEndIndex};for(var l=0;2>l;l++){var n=r[0===l?"textCollisionFeature":"iconCollisionFeature"];if(n)for(var u=n.boxStartIndex;u<n.boxEndIndex;u++){var t=this.collisionBoxArray.get(u);if(!(1===b.perspectiveRatio&&1>t.maxScale)){var A=t.anchorPoint,y=(new g(t.x1,t.y1*h))._rotate(f),k=(new g(t.x2,t.y1*h))._rotate(f),v=(new g(t.x1,t.y2*h))._rotate(f),m=(new g(t.x2,t.y2*h))._rotate(f),z=Math.max(0,Math.min(25,this.zoom+Math.log(t.maxScale)/
Math.LN2)),t=Math.max(0,Math.min(25,this.zoom+Math.log(t.placementScale)/Math.LN2)),x=c.prepareSegment(4),w=x.vertexLength;d(e,A,r.anchor,y,z,t);d(e,A,r.anchor,k,z,t);d(e,A,r.anchor,m,z,t);d(e,A,r.anchor,v,z,t);a.emplaceBack(w,w+1);a.emplaceBack(w+1,w+2);a.emplaceBack(w+2,w+3);a.emplaceBack(w+3,w);x.vertexLength+=4;x.primitiveLength+=4}}}}};N.prototype.addSymbolInstance=function(b,c,e,a,d,g,f,h,p,q,r,l,n,u,t,A,y,k){var v,m,x=[],B=[],C;for(C in e){var E=parseInt(C,10);e[E]&&(B=B.concat(g?K(b,e[E],
r,c,d,n,y,k):[]),v=new z(f,c,b,h,p,q,e[E],r,l,n,!1))}r=v?v.boxStartIndex:this.collisionBoxArray.length;v=v?v.boxEndIndex:this.collisionBoxArray.length;a&&(x=g?J(b,a,u,c,d,A,e[F.horizontal],y,k):[],m=new z(f,c,b,h,p,q,a,u,t,A,!0));c=m?m.boxStartIndex:this.collisionBoxArray.length;m=m?m.boxEndIndex:this.collisionBoxArray.length;v>N.MAX_INSTANCES&&w.warnOnce("Too many symbols being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907");m>N.MAX_INSTANCES&&w.warnOnce("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907");
this.symbolInstances.push({textBoxStartIndex:r,textBoxEndIndex:v,iconBoxStartIndex:c,iconBoxEndIndex:m,glyphQuads:B,iconQuads:x,anchor:b,featureIndex:h,featureProperties:k,writingModes:(e[F.vertical]?F.vertical:0)|(e[F.horizontal]?F.horizontal:0)})};N.programInterfaces=L;N.MAX_INSTANCES=65535;k.exports=N},{"../../shaders/encode_attribute":82,"../../symbol/anchor":161,"../../symbol/clip_line":163,"../../symbol/collision_feature":165,"../../symbol/get_anchors":167,"../../symbol/mergelines":170,"../../symbol/quads":171,
"../../symbol/shaping":172,"../../symbol/transform_text":174,"../../util/classify_rings":199,"../../util/find_pole_of_inaccessibility":205,"../../util/script_detection":212,"../../util/token":216,"../../util/util":217,"../array_group":44,"../buffer_group":52,"../element_array_type":53,"../extent":54,"../load_geometry":56,"point-geometry":26,"vector-tile":34}],51:[function(a,k,m){var f={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT"},d=function(a,d,c){this.arrayBuffer=a.arrayBuffer;
this.length=a.length;this.attributes=d.members;this.itemSize=d.bytesPerElement;this.type=c;this.arrayType=d};d.fromStructArray=function(a,f){return new d(a.serialize(),a.constructor.serialize(),f)};d.prototype.bind=function(a){var d=a[this.type];this.buffer?a.bindBuffer(d,this.buffer):(this.gl=a,this.buffer=a.createBuffer(),a.bindBuffer(d,this.buffer),a.bufferData(d,this.arrayBuffer,a.STATIC_DRAW),this.arrayBuffer=null)};d.prototype.enableAttributes=function(a,d){for(var c=0;c<this.attributes.length;c++){var g=
d[this.attributes[c].name];void 0!==g&&a.enableVertexAttribArray(g)}};d.prototype.setVertexAttribPointers=function(a,d,c){for(var g=0;g<this.attributes.length;g++){var h=this.attributes[g],e=d[h.name];void 0!==e&&a.vertexAttribPointer(e,h.components,a[f[h.type]],!1,this.arrayType.bytesPerElement,h.offset+(this.arrayType.bytesPerElement*c||0))}};d.prototype.destroy=function(){this.buffer&&this.gl.deleteBuffer(this.buffer)};d.BufferType={VERTEX:"ARRAY_BUFFER",ELEMENT:"ELEMENT_ARRAY_BUFFER"};k.exports=
d},{}],52:[function(a,k,m){var f=a("../util/util"),d=a("./buffer"),n=a("./program_configuration"),l=a("./vertex_array_type"),c=a("../render/vertex_array_object");a=function(a,h,e,b){var g=l(a.layoutAttributes);this.layoutVertexBuffer=new d(b.layoutVertexArray,g.serialize(),d.BufferType.VERTEX);b.elementArray&&(this.elementBuffer=new d(b.elementArray,a.elementArrayType.serialize(),d.BufferType.ELEMENT));b.elementArray2&&(this.elementBuffer2=new d(b.elementArray2,a.elementArrayType2.serialize(),d.BufferType.ELEMENT));
this.layerData={};for(g=0;g<h.length;g+=1){var q=h[g],r=b.paintVertexArrays&&b.paintVertexArrays[q.id],u=n.createDynamic(a.paintAttributes||[],q,e),r=r?new d(r.array,r.type,d.BufferType.VERTEX):null;this.layerData[q.id]={programConfiguration:u,paintVertexBuffer:r}}this.segments=b.segments;this.segments2=b.segments2;a=0;for(h=[this.segments,this.segments2];a<h.length;a+=1)for(e=0,b=h[a]||[];e<b.length;e+=1)b[e].vaos=f.mapObject(this.layerData,function(){return new c})};a.prototype.destroy=function(){this.layoutVertexBuffer.destroy();
this.elementBuffer&&this.elementBuffer.destroy();this.elementBuffer2&&this.elementBuffer2.destroy();for(var c in this.layerData){var a=this.layerData[c].paintVertexBuffer;a&&a.destroy()}c=0;for(a=[this.segments,this.segments2];c<a.length;c+=1)for(var e=0,b=a[c]||[];e<b.length;e+=1){var d=b[e],f;for(f in d.vaos)d.vaos[f].destroy()}};k.exports=a},{"../render/vertex_array_object":81,"../util/util":217,"./buffer":51,"./program_configuration":58,"./vertex_array_type":60}],53:[function(a,k,m){var f=a("../util/struct_array");
k.exports=function(a){return f({members:[{type:"Uint16",name:"vertices",components:a||3}]})}},{"../util/struct_array":214}],54:[function(a,k,m){k.exports=8192},{}],55:[function(a,k,m){function f(b){return Math.sqrt(b[0]*b[0]+b[1]*b[1])}function d(b,c){return c-b}function n(b,c){return 0<c?c+2*b:b}function l(b,c,e,a,d){if(!c[0]&&!c[1])return b;c=g.convert(c);"viewport"===e&&c._rotate(-a);e=[];for(a=0;a<b.length;a++){for(var f=b[a],h=[],p=0;p<f.length;p++)h.push(f[p].sub(c._mult(d)));e.push(h)}return e}
var c=a("assert"),g=a("point-geometry"),h=a("./load_geometry"),e=a("./extent"),b=a("../style-spec/feature_filter");m=a("../util/struct_array");var p=a("grid-index"),q=a("../util/dictionary_coder"),r=a("vector-tile"),u=a("pbf"),A=a("../util/vectortile_to_geojson"),y=a("../util/util").arraysIntersect;a=a("../util/intersection_tests");var t=a.multiPolygonIntersectsBufferedMultiPoint,v=a.multiPolygonIntersectsMultiPolygon,B=a.multiPolygonIntersectsBufferedMultiLine,w=m({members:[{type:"Uint32",name:"featureIndex"},
{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]});a=function(b,c,a){if(b.grid){var d=b,g=c;b=d.coord;c=d.overscaling;this.grid=new p(d.grid);this.featureIndexArray=new w(d.featureIndexArray);this.rawTileData=g;this.bucketLayerIDs=d.bucketLayerIDs;this.paintPropertyStatistics=d.paintPropertyStatistics}else this.grid=new p(e,16,0),this.featureIndexArray=new w;this.coord=b;this.overscaling=c;this.x=b.x;this.y=b.y;this.z=b.z-Math.log(c)/Math.LN2;this.setCollisionTile(a)};a.prototype.insert=
function(b,c){var a=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(b.index,b.sourceLayerIndex,c);for(var e=h(b),d=0;d<e.length;d++){for(var g=e[d],f=[Infinity,Infinity,-Infinity,-Infinity],p=0;p<g.length;p++){var q=g[p];f[0]=Math.min(f[0],q.x);f[1]=Math.min(f[1],q.y);f[2]=Math.max(f[2],q.x);f[3]=Math.max(f[3],q.y)}this.grid.insert(a,f[0],f[1],f[2],f[3])}};a.prototype.setCollisionTile=function(b){this.collisionTile=b};a.prototype.serialize=function(b){var c=this.grid.toArrayBuffer();
b&&b.push(c);return{coord:this.coord,overscaling:this.overscaling,grid:c,featureIndexArray:this.featureIndexArray.serialize(b),bucketLayerIDs:this.bucketLayerIDs,paintPropertyStatistics:this.paintPropertyStatistics}};a.prototype.query=function(c,a){this.vtLayers||(this.vtLayers=(new r.VectorTile(new u(this.rawTileData))).layers,this.sourceLayerCoder=new q(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]));var h={},p=c.params||{},l=e/c.tileSize/c.scale,t=b(p.filter),A=0,y;for(y in a)if(this.hasLayer(y)){var k=
a[y],v=0;if("line"===k.type)var v=n(this.getPaintValue("line-width",k),this.getPaintValue("line-gap-width",k)),m=this.getPaintValue("line-offset",k),k=this.getPaintValue("line-translate",k),v=v/2+Math.abs(m)+f(k);else"fill"===k.type?v=f(this.getPaintValue("fill-translate",k)):"fill-extrusion"===k.type?v=f(this.getPaintValue("fill-extrusion-translate",k)):"circle"===k.type&&(v=this.getPaintValue("circle-radius",k)+f(this.getPaintValue("circle-translate",k)));A=Math.max(A,v*l)}y=c.queryGeometry.map(function(b){return b.map(function(b){return new g(b.x,
b.y)})});for(var v=k=Infinity,w=m=-Infinity,x=0;x<y.length;x++)for(var B=y[x],C=0;C<B.length;C++)var P=B[C],k=Math.min(k,P.x),v=Math.min(v,P.y),m=Math.max(m,P.x),w=Math.max(w,P.y);A=this.grid.query(k-A,v-A,m+A,w+A);A.sort(d);this.filterMatching(h,A,this.featureIndexArray,y,t,p.layers,a,c.bearing,l);A=this.collisionTile.queryRenderedSymbols(y,c.scale);A.sort();this.filterMatching(h,A,this.collisionTile.collisionBoxArray,y,t,p.layers,a,c.bearing,l);return h};a.prototype.filterMatching=function(b,c,
a,e,d,f,p,q,r){for(var u,k=0;k<c.length;k++){var m=c[k];if(m!==u){u=m;var z=a.get(m),w=this.bucketLayerIDs[z.bucketIndex];if(!f||y(f,w)){var x=this.sourceLayerCoder.decode(z.sourceLayerIndex),z=this.vtLayers[x].feature(z.featureIndex);if(d(z))for(var C=null,x=0;x<w.length;x++){var E=w[x];if(!(f&&0>f.indexOf(E))){var F=p[E];if(F){var D;if("symbol"!==F.type)if(C||(C=h(z)),"line"===F.type){D=l(e,this.getPaintValue("line-translate",F,z),this.getPaintValue("line-translate-anchor",F,z),q,r);var G=r/2*n(this.getPaintValue("line-width",
F,z),this.getPaintValue("line-gap-width",F,z)),H=this.getPaintValue("line-offset",F,z);if(H){for(var H=H*r,I=[],aa=new g(0,0),Y=0;Y<C.length;Y++){for(var V=C[Y],ba=[],U=0;U<V.length;U++){var T=V[U-1],Z=V[U],W=V[U+1],T=0===U?aa:Z.sub(T)._unit()._perp(),W=U===V.length-1?aa:W.sub(Z)._unit()._perp(),T=T._add(W)._unit();T._mult(1/(T.x*W.x+T.y*W.y));ba.push(T._mult(H)._add(Z))}I.push(ba)}C=I}if(!B(D,C,G))continue}else if("fill"===F.type||"fill-extrusion"===F.type){if(D=F.type,D=l(e,this.getPaintValue(D+
"-translate",F,z),this.getPaintValue(D+"-translate-anchor",F,z),q,r),!v(D,C))continue}else if("circle"===F.type&&(D=l(e,this.getPaintValue("circle-translate",F,z),this.getPaintValue("circle-translate-anchor",F,z),q,r),G=this.getPaintValue("circle-radius",F,z)*r,!t(D,C,G)))continue;D=new A(z,this.z,this.x,this.y);D.layer=F.serialize();F=b[E];void 0===F&&(F=b[E]=[]);F.push({featureIndex:m,feature:D})}}}}}}};a.prototype.hasLayer=function(b){for(var c in this.bucketLayerIDs)for(var a=0,e=this.bucketLayerIDs[c];a<
e.length;a+=1)if(b===e[a])return!0;return!1};a.prototype.getPaintValue=function(b,a,e){if(a.isPaintValueFeatureConstant(b)||e)return a.getPaintValue(b,{zoom:this.z},e?e.properties:{});c(b in this.paintPropertyStatistics[a.id]);return this.paintPropertyStatistics[a.id][b].max};k.exports=a},{"../style-spec/feature_filter":106,"../util/dictionary_coder":201,"../util/intersection_tests":208,"../util/struct_array":214,"../util/util":217,"../util/vectortile_to_geojson":218,"./extent":54,"./load_geometry":56,
assert:5,"grid-index":17,pbf:25,"point-geometry":26,"vector-tile":34}],56:[function(a,k,m){function f(c){return{min:-1*Math.pow(2,c-1),max:Math.pow(2,c-1)-1}}var d=a("../util/util"),n=a("./extent"),l=a("assert"),c={15:f(15),16:f(16)};k.exports=function(a,f){var e=c[f||16];l(e);for(var b=n/a.extent,g=a.loadGeometry(),h=0;h<g.length;h++)for(var r=g[h],u=0;u<r.length;u++){var A=r[u];A.x=Math.round(A.x*b);A.y=Math.round(A.y*b);(A.x<e.min||A.x>e.max||A.y<e.min||A.y>e.max)&&d.warnOnce("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return g}},
{"../util/util":217,"./extent":54,assert:5}],57:[function(a,k,m){a=a("../util/struct_array")({members:[{name:"a_pos",type:"Int16",components:2}]});k.exports=a},{"../util/struct_array":214}],58:[function(a,k,m){function f(c,a,e,b){if(!c.zoomStops)return a.getPaintValue(c.property,e,b);var d=c.zoomStops.map(function(d){return a.getPaintValue(c.property,l.extend({},e,{zoom:d}),b)});return 1===d.length?d[0]:d}var d=a("assert"),n=a("./vertex_array_type"),l=a("../util/util"),c=function(){this.attributes=
[];this.uniforms=[];this.interpolationUniforms=[];this.pragmas={vertex:{},fragment:{}};this.cacheKey=""};c.createDynamic=function(a,f,e){for(var b=new c,g=0;g<a.length;g+=1){var h;h=a[g];var r=f,u=h.name;u||(u=h.property.replace(r.type+"-","").replace(/-/g,"_"));r="color"===r._paintSpecifications[h.property].type;h=l.extend({name:"a_"+u,components:r?4:1,multiplier:r?255:1,dimensions:r?4:1},h);d(/^a_/.test(h.name));u=h.name.slice(2);f.isPaintValueFeatureConstant(h.property)?b.addZoomAttribute(u,h):
f.isPaintValueZoomConstant(h.property)?b.addPropertyAttribute(u,h):b.addZoomAndPropertyAttribute(u,h,f,e)}b.PaintVertexArray=n(b.attributes);return b};c.createStatic=function(a){for(var d=new c,e=0;e<a.length;e+=1){var b=a[e];d.addUniform(b,"u_"+b)}return d};c.prototype.addUniform=function(c,a){var e=this.getPragmas(c);e.define.push("uniform {precision} {type} "+a+";");e.initialize.push("{precision} {type} "+c+" = "+a+";");this.cacheKey+="/u_"+c};c.prototype.addZoomAttribute=function(c,a){this.uniforms.push(a);
this.addUniform(c,a.name)};c.prototype.addPropertyAttribute=function(c,a){var e=this.getPragmas(c);this.attributes.push(a);e.define.push("varying {precision} {type} "+c+";");e.vertex.define.push("attribute {precision} {type} "+a.name+";");e.vertex.initialize.push(c+" = "+a.name+" / "+a.multiplier+".0;");this.cacheKey+="/a_"+c};c.prototype.addZoomAndPropertyAttribute=function(c,a,e,b){var d=this.getPragmas(c);d.define.push("varying {precision} {type} "+c+";");var f=e.getPaintValueStopZoomLevels(a.property),
g=0;if(4<f.length)for(;g<f.length-2&&f[g]<b;)g++;b="u_"+c+"_t";d.vertex.define.push("uniform lowp float "+b+";");this.interpolationUniforms.push({name:b,property:a.property,stopOffset:g});e=[];for(var h=0;4>h;h++)e.push(f[Math.min(g+h,f.length-1)]);f=[];if(1===a.components)this.attributes.push(l.extend({},a,{components:4,zoomStops:e})),d.vertex.define.push("attribute {precision} vec4 "+a.name+";"),f.push(a.name);else for(g=0;4>g;g++)h=a.name+g,f.push(h),this.attributes.push(l.extend({},a,{name:h,
zoomStops:[e[g]]})),d.vertex.define.push("attribute {precision} {type} "+h+";");d.vertex.initialize.push(c+" = evaluate_zoom_function_"+a.components+"(            "+f.join(", ")+", "+b+") / "+a.multiplier+".0;");this.cacheKey+="/z_"+c};c.prototype.getPragmas=function(c){this.pragmas[c]||(this.pragmas[c]={define:[],initialize:[]},this.pragmas[c].fragment={define:[],initialize:[]},this.pragmas[c].vertex={define:[],initialize:[]});return this.pragmas[c]};c.prototype.applyPragmas=function(c,a){var e=
this;return c.replace(/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,function(b,c,d,f,g){return e.pragmas[g][c].concat(e.pragmas[g][a][c]).join("\n").replace(/{type}/g,f).replace(/{precision}/g,d)})};c.prototype.createPaintPropertyStatistics=function(){for(var c={},a=0,e=this.attributes;a<e.length;a+=1){var b=e[a];1===b.dimensions&&(c[b.property]={max:-Infinity})}return c};c.prototype.populatePaintArray=function(c,a,e,b,d,q){var g=a.length;a.resize(b);for(var h=0,p=this.attributes;h<p.length;h+=
1)for(var l=p[h],n=f(l,c,d,q),k=g;k<b;k++){var m=a.get(k);if(4===l.components)for(var w=0;4>w;w++)m[l.name+w]=n[w]*l.multiplier;else m[l.name]=n*l.multiplier;1===l.dimensions&&(m=e[l.property],m.max=Math.max(m.max,1===l.components?n:Math.max.apply(Math,n)))}};c.prototype.setUniforms=function(c,a,e,b){for(var d=0,f=this.uniforms;d<f.length;d+=1){var g=f[d],h=e.getPaintValue(g.property,b);4===g.components?c.uniform4fv(a[g.name],h):c.uniform1f(a[g.name],h)}d=0;for(f=this.interpolationUniforms;d<f.length;d+=
1)g=f[d],h=e.getPaintInterpolationT(g.property,b),c.uniform1f(a[g.name],Math.max(0,Math.min(3,h-g.stopOffset)))};k.exports=c},{"../util/util":217,"./vertex_array_type":60,assert:5}],59:[function(a,k,m){a=a("../util/struct_array")({members:[{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]});k.exports=a},{"../util/struct_array":214}],60:[function(a,k,m){var f=a("../util/struct_array");k.exports=function(a){return f({members:a,alignment:4})}},{"../util/struct_array":214}],
61:[function(a,k,m){var f=function(a,f,l){this.column=a;this.row=f;this.zoom=l};f.prototype.clone=function(){return new f(this.column,this.row,this.zoom)};f.prototype.zoomTo=function(a){return this.clone()._zoomTo(a)};f.prototype.sub=function(a){return this.clone()._sub(a)};f.prototype._zoomTo=function(a){var d=Math.pow(2,a-this.zoom);this.column*=d;this.row*=d;this.zoom=a;return this};f.prototype._sub=function(a){a=a.zoomTo(this.zoom);this.column-=a.column;this.row-=a.row;return this};k.exports=
f},{}],62:[function(a,k,m){var f=a("../util/util").wrap,d=function(a,d){if(isNaN(a)||isNaN(d))throw Error("Invalid LngLat object: ("+a+", "+d+")");this.lng=+a;this.lat=+d;if(90<this.lat||-90>this.lat)throw Error("Invalid LngLat latitude value: must be between -90 and 90");};d.prototype.wrap=function(){return new d(f(this.lng,-180,180),this.lat)};d.prototype.toArray=function(){return[this.lng,this.lat]};d.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"};d.convert=function(a){if(a instanceof
d)return a;if(Array.isArray(a)&&2===a.length)return new d(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&"object"===typeof a&&null!==a)return new d(Number(a.lng),Number(a.lat));throw Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]");};k.exports=d},{"../util/util":217}],63:[function(a,k,m){var f=a("./lng_lat"),d=function(a,d){a&&(d?this.setSouthWest(a).setNorthEast(d):4===a.length?this.setSouthWest([a[0],a[1]]).setNorthEast([a[2],
a[3]]):this.setSouthWest(a[0]).setNorthEast(a[1]))};d.prototype.setNorthEast=function(a){this._ne=f.convert(a);return this};d.prototype.setSouthWest=function(a){this._sw=f.convert(a);return this};d.prototype.extend=function(a){var l=this._sw,c=this._ne,g;if(a instanceof f)g=a;else if(a instanceof d){if(g=a._sw,a=a._ne,!g||!a)return this}else return Array.isArray(a)?a.every(Array.isArray)?this.extend(d.convert(a)):this.extend(f.convert(a)):this;l||c?(l.lng=Math.min(g.lng,l.lng),l.lat=Math.min(g.lat,
l.lat),c.lng=Math.max(a.lng,c.lng),c.lat=Math.max(a.lat,c.lat)):(this._sw=new f(g.lng,g.lat),this._ne=new f(a.lng,a.lat));return this};d.prototype.getCenter=function(){return new f((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)};d.prototype.getSouthWest=function(){return this._sw};d.prototype.getNorthEast=function(){return this._ne};d.prototype.getNorthWest=function(){return new f(this.getWest(),this.getNorth())};d.prototype.getSouthEast=function(){return new f(this.getEast(),this.getSouth())};
d.prototype.getWest=function(){return this._sw.lng};d.prototype.getSouth=function(){return this._sw.lat};d.prototype.getEast=function(){return this._ne.lng};d.prototype.getNorth=function(){return this._ne.lat};d.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]};d.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"};d.convert=function(a){return!a||a instanceof d?a:new d(a)};k.exports=d},{"./lng_lat":62}],64:[function(a,k,m){var f=
a("./lng_lat"),d=a("point-geometry"),n=a("./coordinate"),l=a("../util/util"),c=a("../style-spec/util/interpolate"),g=a("../source/tile_coord"),h=a("../data/extent");a=a("@mapbox/gl-matrix");var e=a.vec4,b=a.mat4,p=a.mat2;a=function(b,c,a){this.tileSize=512;this._renderWorldCopies=void 0===a?!0:a;this._minZoom=b||0;this._maxZoom=c||22;this.latRange=[-85.05113,85.05113];this.height=this.width=0;this._center=new f(0,0);this.angle=this.zoom=0;this._fov=.6435011087932844;this._pitch=0;this._unmodified=
!0};m={minZoom:{},maxZoom:{},renderWorldCopies:{},worldSize:{},centerPoint:{},size:{},bearing:{},pitch:{},fov:{},zoom:{},center:{},unmodified:{},x:{},y:{},point:{}};m.minZoom.get=function(){return this._minZoom};m.minZoom.set=function(b){this._minZoom!==b&&(this._minZoom=b,this.zoom=Math.max(this.zoom,b))};m.maxZoom.get=function(){return this._maxZoom};m.maxZoom.set=function(b){this._maxZoom!==b&&(this._maxZoom=b,this.zoom=Math.min(this.zoom,b))};m.renderWorldCopies.get=function(){return this._renderWorldCopies};
m.worldSize.get=function(){return this.tileSize*this.scale};m.centerPoint.get=function(){return this.size._div(2)};m.size.get=function(){return new d(this.width,this.height)};m.bearing.get=function(){return-this.angle/Math.PI*180};m.bearing.set=function(b){b=-l.wrap(b,-180,180)*Math.PI/180;this.angle!==b&&(this._unmodified=!1,this.angle=b,this._calcMatrices(),this.rotationMatrix=p.create(),p.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))};m.pitch.get=function(){return this._pitch/Math.PI*
180};m.pitch.set=function(b){b=l.clamp(b,0,60)/180*Math.PI;this._pitch!==b&&(this._unmodified=!1,this._pitch=b,this._calcMatrices())};m.fov.get=function(){return this._fov/Math.PI*180};m.fov.set=function(b){b=Math.max(.01,Math.min(60,b));this._fov!==b&&(this._unmodified=!1,this._fov=b/180*Math.PI,this._calcMatrices())};m.zoom.get=function(){return this._zoom};m.zoom.set=function(b){b=Math.min(Math.max(b,this.minZoom),this.maxZoom);this._zoom!==b&&(this._unmodified=!1,this._zoom=b,this.scale=this.zoomScale(b),
this.tileZoom=Math.floor(b),this.zoomFraction=b-this.tileZoom,this._constrain(),this._calcMatrices())};m.center.get=function(){return this._center};m.center.set=function(b){if(b.lat!==this._center.lat||b.lng!==this._center.lng)this._unmodified=!1,this._center=b,this._constrain(),this._calcMatrices()};a.prototype.coveringZoomLevel=function(b){return(b.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/b.tileSize))};a.prototype.getVisibleWrappedCoordinates=function(b){for(var c=
this.pointCoordinate(new d(0,0),0),a=this.pointCoordinate(new d(this.width,0),0),a=Math.floor(a.column),e=[b],c=Math.floor(c.column);c<=a;c++)0!==c&&e.push(new g(b.z,b.x,b.y,c));return e};a.prototype.coveringTiles=function(b){var c=this.coveringZoomLevel(b),a=c;if(c<b.minzoom)return[];c>b.maxzoom&&(c=b.maxzoom);var e=this.pointCoordinate(this.centerPoint,c),f=new d(e.column-.5,e.row-.5),e=[this.pointCoordinate(new d(0,0),c),this.pointCoordinate(new d(this.width,0),c),this.pointCoordinate(new d(this.width,
this.height),c),this.pointCoordinate(new d(0,this.height),c)];return g.cover(c,e,b.reparseOverscaled?a:c,this._renderWorldCopies).sort(function(b,c){return f.dist(b)-f.dist(c)})};a.prototype.resize=function(b,c){this.width=b;this.height=c;this.pixelsToGLUnits=[2/b,-2/c];this._constrain();this._calcMatrices()};m.unmodified.get=function(){return this._unmodified};a.prototype.zoomScale=function(b){return Math.pow(2,b)};a.prototype.scaleZoom=function(b){return Math.log(b)/Math.LN2};a.prototype.project=
function(b){return new d(this.lngX(b.lng),this.latY(b.lat))};a.prototype.unproject=function(b){return new f(this.xLng(b.x),this.yLat(b.y))};m.x.get=function(){return this.lngX(this.center.lng)};m.y.get=function(){return this.latY(this.center.lat)};m.point.get=function(){return new d(this.x,this.y)};a.prototype.lngX=function(b){return(180+b)*this.worldSize/360};a.prototype.latY=function(b){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+b*Math.PI/360)))*this.worldSize/360};a.prototype.xLng=function(b){return 360*
b/this.worldSize-180};a.prototype.yLat=function(b){return 360/Math.PI*Math.atan(Math.exp((180-360*b/this.worldSize)*Math.PI/180))-90};a.prototype.setLocationAtPoint=function(b,c){var a=this.pointCoordinate(c)._sub(this.pointCoordinate(this.centerPoint));this.center=this.coordinateLocation(this.locationCoordinate(b)._sub(a));this._renderWorldCopies&&(this.center=this.center.wrap())};a.prototype.locationPoint=function(b){return this.coordinatePoint(this.locationCoordinate(b))};a.prototype.pointLocation=
function(b){return this.coordinateLocation(this.pointCoordinate(b))};a.prototype.locationCoordinate=function(b){return(new n(this.lngX(b.lng)/this.tileSize,this.latY(b.lat)/this.tileSize,this.zoom)).zoomTo(this.tileZoom)};a.prototype.coordinateLocation=function(b){b=b.zoomTo(this.zoom);return new f(this.xLng(b.column*this.tileSize),this.yLat(b.row*this.tileSize))};a.prototype.pointCoordinate=function(b,a){void 0===a&&(a=this.tileZoom);var d=[b.x,b.y,0,1],f=[b.x,b.y,1,1];e.transformMat4(d,d,this.pixelMatrixInverse);
e.transformMat4(f,f,this.pixelMatrixInverse);var g=d[3],h=f[3],p=d[1]/g,q=f[1]/h,l=d[2]/g,r=f[2]/h,l=l===r?0:(0-l)/(r-l);return(new n(c(d[0]/g,f[0]/h,l)/this.tileSize,c(p,q,l)/this.tileSize,this.zoom))._zoomTo(a)};a.prototype.coordinatePoint=function(b){b=b.zoomTo(this.zoom);b=[b.column*this.tileSize,b.row*this.tileSize,0,1];e.transformMat4(b,b,this.pixelMatrix);return new d(b[0]/b[3],b[1]/b[3])};a.prototype.calculatePosMatrix=function(c,a){var e=c.toCoordinate(a),d=this.worldSize/this.zoomScale(e.zoom),
f=b.identity(new Float64Array(16));b.translate(f,f,[e.column*d,e.row*d,0]);b.scale(f,f,[d/h,d/h,1]);b.multiply(f,this.projMatrix,f);return new Float32Array(f)};a.prototype.cameraToTileDistance=function(b){var c=this.calculatePosMatrix(b.coord,b.sourceMaxZoom);b=[b.tileSize/2,b.tileSize/2,0,1];e.transformMat4(b,b,c);return b[3]};a.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var b=-90,c=90,a=-180,e=180,f,g,h,p,l=this.size,n=this._unmodified;
this.latRange&&(c=this.latRange,b=this.latY(c[1]),c=this.latY(c[0]),f=c-b<l.y?l.y/(c-b):0);this.lngRange&&(e=this.lngRange,a=this.lngX(e[0]),e=this.lngX(e[1]),g=e-a<l.x?l.x/(e-a):0);var k=Math.max(g||0,f||0);if(k)this.center=this.unproject(new d(g?(e+a)/2:this.x,f?(c+b)/2:this.y)),this.zoom+=this.scaleZoom(k);else if(this.latRange&&(f=this.y,g=l.y/2,f-g<b&&(p=b+g),f+g>c&&(p=c-g)),this.lngRange&&(b=this.x,l=l.x/2,b-l<a&&(h=a+l),b+l>e&&(h=e-l)),void 0!==h||void 0!==p)this.center=this.unproject(new d(void 0!==
h?h:this.x,void 0!==p?p:this.y));this._unmodified=n;this._constraining=!1}};a.prototype._calcMatrices=function(){if(this.height){this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var c=this._fov/2,c=1.01*(Math.sin(c)*this.cameraToCenterDistance/Math.sin(Math.PI-(Math.PI/2+this._pitch)-c)*Math.cos(Math.PI/2-this._pitch)+this.cameraToCenterDistance),a=new Float64Array(16);b.perspective(a,this._fov,this.width/this.height,1,c);b.scale(a,a,[1,-1,1]);b.translate(a,a,[0,0,-this.cameraToCenterDistance]);
b.rotateX(a,a,this._pitch);b.rotateZ(a,a,this.angle);b.translate(a,a,[-this.x,-this.y,0]);b.scale(a,a,[1,1,this.worldSize/(12756274*Math.PI*Math.abs(Math.cos(Math.PI/180*this.center.lat))),1]);this.projMatrix=a;a=b.create();b.scale(a,a,[this.width/2,-this.height/2,1]);b.translate(a,a,[1,-1,0]);this.pixelMatrix=b.multiply(new Float64Array(16),a,this.projMatrix);a=b.invert(new Float64Array(16),this.pixelMatrix);if(!a)throw Error("failed to invert matrix");this.pixelMatrixInverse=a}};Object.defineProperties(a.prototype,
m);k.exports=a},{"../data/extent":54,"../source/tile_coord":97,"../style-spec/util/interpolate":124,"../util/util":217,"./coordinate":61,"./lng_lat":62,"@mapbox/gl-matrix":1,"point-geometry":26}],65:[function(a,k,m){m=a("./util/browser");k=k.exports={};k.version=a("../package.json").version;k.workerCount=Math.max(Math.floor(m.hardwareConcurrency/2),1);k.Map=a("./ui/map");k.NavigationControl=a("./ui/control/navigation_control");k.GeolocateControl=a("./ui/control/geolocate_control");k.AttributionControl=
a("./ui/control/attribution_control");k.ScaleControl=a("./ui/control/scale_control");k.FullscreenControl=a("./ui/control/fullscreen_control");k.Popup=a("./ui/popup");k.Marker=a("./ui/marker");k.Style=a("./style/style");k.LngLat=a("./geo/lng_lat");k.LngLatBounds=a("./geo/lng_lat_bounds");k.Point=a("point-geometry");k.Evented=a("./util/evented");k.supported=a("./util/browser").supported;var f=a("./util/config");k.config=f;a=a("./source/rtl_text_plugin");k.setRTLTextPlugin=a.setRTLTextPlugin;Object.defineProperty(k,
"accessToken",{get:function(){return f.ACCESS_TOKEN},set:function(a){f.ACCESS_TOKEN=a}})},{"../package.json":43,"./geo/lng_lat":62,"./geo/lng_lat_bounds":63,"./source/rtl_text_plugin":92,"./style/style":150,"./ui/control/attribution_control":177,"./ui/control/fullscreen_control":178,"./ui/control/geolocate_control":179,"./ui/control/navigation_control":181,"./ui/control/scale_control":182,"./ui/map":191,"./ui/marker":192,"./ui/popup":193,"./util/browser":196,"./util/config":200,"./util/evented":204,
"point-geometry":26}],66:[function(a,k,m){var f=a("./pattern");k.exports=function(a,n,l){n=a.gl;var c=a.transform,d=c.tileSize,h=l.paint["background-color"],e=l.paint["background-pattern"],b=l.paint["background-opacity"];if(a.isOpaquePass===(!e&&1===h[3]&&1===b)){n.disable(n.STENCIL_TEST);a.setDepthSublayer(0);if(e){if(f.isPatternMissing(e,a))return;l=a.useProgram("fillPattern",a.basicFillProgramConfiguration);f.prepare(e,a,l);a.tileExtentPatternVAO.bind(n,l,a.tileExtentBuffer)}else l=a.useProgram("fill",
a.basicFillProgramConfiguration),n.uniform4fv(l.u_color,h),a.tileExtentVAO.bind(n,l,a.tileExtentBuffer);n.uniform1f(l.u_opacity,b);h=0;for(c=c.coveringTiles({tileSize:d});h<c.length;h+=1)b=c[h],e&&f.setTile({coord:b,tileSize:d},a,l),n.uniformMatrix4fv(l.u_matrix,!1,a.transform.calculatePosMatrix(b)),n.drawArrays(n.TRIANGLE_STRIP,0,a.tileExtentBuffer.length)}}},{"./pattern":79}],67:[function(a,k,m){var f=a("../util/browser");k.exports=function(a,n,l,c){if(!a.isOpaquePass){var d=a.gl;a.setDepthSublayer(0);
a.depthMask(!1);d.disable(d.STENCIL_TEST);for(var h=0;h<c.length;h++){var e=c[h],b=n.getTile(e),p=b.getBucket(l);if(p){var p=p.buffers,q=p.layerData[l.id],r=q.programConfiguration,u=a.useProgram("circle",r);r.setUniforms(d,u,l,{zoom:a.transform.zoom});"map"===l.paint["circle-pitch-scale"]?(d.uniform1i(u.u_scale_with_map,!0),d.uniform2f(u.u_extrude_scale,a.transform.pixelsToGLUnits[0]*a.transform.cameraToCenterDistance,a.transform.pixelsToGLUnits[1]*a.transform.cameraToCenterDistance)):(d.uniform1i(u.u_scale_with_map,
!1),d.uniform2fv(u.u_extrude_scale,a.transform.pixelsToGLUnits));d.uniform1f(u.u_devicepixelratio,f.devicePixelRatio);d.uniformMatrix4fv(u.u_matrix,!1,a.translatePosMatrix(e.posMatrix,b,l.paint["circle-translate"],l.paint["circle-translate-anchor"]));e=0;for(b=p.segments;e<b.length;e+=1)r=b[e],r.vaos[l.id].bind(d,u,p.layoutVertexBuffer,p.elementBuffer,q.paintVertexBuffer,r.vertexOffset),d.drawElements(d.TRIANGLES,3*r.primitiveLength,d.UNSIGNED_SHORT,6*r.primitiveOffset)}}}}},{"../util/browser":196}],
68:[function(a,k,m){k.exports=function(a,d,n,l){var c=a.gl;c.enable(c.STENCIL_TEST);var f=a.useProgram("collisionBox");c.activeTexture(c.TEXTURE1);a.frameHistory.bind(c);c.uniform1i(f.u_fadetexture,1);for(var h=0;h<l.length;h++){var e=l[h],b=d.getTile(e),p=b.getBucket(n);if(p&&(p=p.buffers.collisionBox))for(c.uniformMatrix4fv(f.u_matrix,!1,e.posMatrix),a.enableTileClippingMask(e),a.lineWidth(1),c.uniform1f(f.u_scale,Math.pow(2,a.transform.zoom-b.coord.z)),c.uniform1f(f.u_zoom,10*a.transform.zoom),
c.uniform1f(f.u_maxzoom,10*Math.max(0,Math.min(25,b.coord.z+Math.log(b.collisionTile.maxScale)/Math.LN2))),c.uniform1f(f.u_collision_y_stretch,b.collisionTile.yStretch),c.uniform1f(f.u_pitch,a.transform.pitch/360*2*Math.PI),c.uniform1f(f.u_camera_to_center_distance,a.transform.cameraToCenterDistance),e=0,b=p.segments;e<b.length;e+=1){var q=b[e];q.vaos[n.id].bind(c,f,p.layoutVertexBuffer,p.elementBuffer,null,q.vertexOffset);c.drawElements(c.LINES,2*q.primitiveLength,c.UNSIGNED_SHORT,4*q.primitiveOffset)}}}},
{}],69:[function(a,k,m){var f=a("../util/browser"),d=a("@mapbox/gl-matrix").mat4,n=a("../data/extent"),l=a("../data/buffer"),c=a("./vertex_array_object"),g=a("../data/pos_array");k.exports=function(a,b,p){for(var e=0;e<p.length;e++){var r=a,u=b,A=p[e],k=r.gl;k.disable(k.STENCIL_TEST);r.lineWidth(1*f.devicePixelRatio);var t=A.posMatrix,v=r.useProgram("debug");k.uniformMatrix4fv(v.u_matrix,!1,t);k.uniform4f(v.u_color,1,0,0,1);r.debugVAO.bind(k,v,r.debugBuffer);k.drawArrays(k.LINE_STRIP,0,r.debugBuffer.length);
var m,w,x,C,z,E,D,H,I=A.toString(),G=50,F=5,F=F||1,K=[];H=0;for(D=I.length;H<D;H++)if(C=h[I[H]]){m=null;E=0;for(z=C[1].length;E<z;E+=2)-1===C[1][E]&&-1===C[1][E+1]?m=null:(x=G+C[1][E]*F,w=200-C[1][E+1]*F,m&&K.push(m.x,m.y,x,w),m={x:x,y:w});G+=C[0]*F}m=K;w=new g;for(x=0;x<m.length;x+=2)w.emplaceBack(m[x],m[x+1]);m=l.fromStructArray(w,l.BufferType.VERTEX);(new c).bind(k,v,m);k.uniform4f(v.u_color,1,1,1,1);u=u.getTile(A).tileSize;r=n/(Math.pow(2,r.transform.zoom-A.z)*u);A=[[-1,-1],[-1,1],[1,-1],[1,1]];
for(u=0;u<A.length;u++)w=A[u],k.uniformMatrix4fv(v.u_matrix,!1,d.translate([],t,[r*w[0],r*w[1],0])),k.drawArrays(k.LINES,0,m.length);k.uniform4f(v.u_color,0,0,0,1);k.uniformMatrix4fv(v.u_matrix,!1,t);k.drawArrays(k.LINES,0,m.length)}};var h={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,
12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,
2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,
[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,
16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,
[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,
21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,
4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,
16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,
0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,
14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,
4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,
14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,
14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,
5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]}},{"../data/buffer":51,"../data/extent":54,"../data/pos_array":57,"../util/browser":196,"./vertex_array_object":81,"@mapbox/gl-matrix":1}],70:[function(a,k,m){function f(a,d,e,b,f){if(!c.isPatternMissing(e.paint["fill-pattern"],a))for(var g=!0,h=0;h<b.length;h+=1){var p=b[h],l=d.getTile(p),n=
l.getBucket(e);n&&(a.enableTileClippingMask(p),f(a,d,e,l,p,n.buffers,g),g=!1)}}function d(c,a,e,b,d,f,r){a=c.gl;var g=f.layerData[e.id];c=l("fill",e.paint["fill-pattern"],c,g,e,b,d,r);b=0;for(d=f.segments;b<d.length;b+=1)r=d[b],r.vaos[e.id].bind(a,c,f.layoutVertexBuffer,f.elementBuffer,g.paintVertexBuffer,r.vertexOffset),a.drawElements(a.TRIANGLES,3*r.primitiveLength,a.UNSIGNED_SHORT,6*r.primitiveOffset)}function n(c,a,e,b,d,f,r){a=c.gl;var g=f.layerData[e.id],h=e.paint["fill-pattern"]&&!e.getPaintProperty("fill-outline-color");
c=l("fillOutline",h,c,g,e,b,d,r);a.uniform2f(c.u_world,a.drawingBufferWidth,a.drawingBufferHeight);b=0;for(d=f.segments2;b<d.length;b+=1)r=d[b],r.vaos[e.id].bind(a,c,f.layoutVertexBuffer,f.elementBuffer2,g.paintVertexBuffer,r.vertexOffset),a.drawElements(a.LINES,2*r.primitiveLength,a.UNSIGNED_SHORT,4*r.primitiveOffset)}function l(a,d,e,b,f,l,r,n){var g=e.currentProgram;if(d){a=e.useProgram(a+"Pattern",b.programConfiguration);if(n||a!==g)b.programConfiguration.setUniforms(e.gl,a,f,{zoom:e.transform.zoom}),
c.prepare(f.paint["fill-pattern"],e,a);c.setTile(l,e,a)}else a=e.useProgram(a,b.programConfiguration),(n||a!==g)&&b.programConfiguration.setUniforms(e.gl,a,f,{zoom:e.transform.zoom});e.gl.uniformMatrix4fv(a.u_matrix,!1,e.translatePosMatrix(r.posMatrix,l,f.paint["fill-translate"],f.paint["fill-translate-anchor"]));return a}var c=a("./pattern");k.exports=function(c,a,e,b){var g=c.gl;g.enable(g.STENCIL_TEST);g=!e.paint["fill-pattern"]&&e.isPaintValueFeatureConstant("fill-color")&&e.isPaintValueFeatureConstant("fill-opacity")&&
1===e.paint["fill-color"][3]&&1===e.paint["fill-opacity"];c.isOpaquePass===g&&(c.setDepthSublayer(1),f(c,a,e,b,d));!c.isOpaquePass&&e.paint["fill-antialias"]&&(c.lineWidth(2),c.depthMask(!1),c.setDepthSublayer(e.getPaintProperty("fill-outline-color")?2:0),f(c,a,e,b,n))}},{"./pattern":79}],71:[function(a,k,m){function f(b,c,a){this.gl=b;this.width=c.width;this.height=c.height;this.painter=c;this.layer=a;this.fbo=this.texture=null;this.fbos=this.painter.preFbos[this.width]&&this.painter.preFbos[this.width][this.height]}
m=a("@mapbox/gl-matrix");var d=a("../data/buffer"),n=a("./vertex_array_object"),l=a("../data/pos_array"),c=a("./pattern"),g=m.mat3,h=m.mat4,e=m.vec3;k.exports=function(b,a,d,h){if(0!==d.paint["fill-extrusion-opacity"]){var p=b.gl;p.disable(p.STENCIL_TEST);p.enable(p.DEPTH_TEST);b.depthMask(!0);var l=new f(p,b,d);l.bindFramebuffer();p.clearColor(0,0,0,0);p.clear(p.COLOR_BUFFER_BIT|p.DEPTH_BUFFER_BIT);for(p=0;p<h.length;p++)a:{var q=b,r=d,n=h[p];if(!q.isOpaquePass){var k=a.getTile(n),m=k.getBucket(r);
if(m){var m=m.buffers,x=q.gl,C=r.paint["fill-extrusion-pattern"],z=m.layerData[r.id],E=z.programConfiguration,D=q.useProgram(C?"fillExtrusionPattern":"fillExtrusion",E);E.setUniforms(x,D,r,{zoom:q.transform.zoom});if(C){if(c.isPatternMissing(C,q))break a;c.prepare(C,q,D);c.setTile(k,q,D);x.uniform1f(D.u_height_factor,-Math.pow(2,n.z)/k.tileSize/8)}q.gl.uniformMatrix4fv(D.u_matrix,!1,q.translatePosMatrix(n.posMatrix,k,r.paint["fill-extrusion-translate"],r.paint["fill-extrusion-translate-anchor"]));
var n=D,k=q.gl,C=q.style.light,E=C.calculated.position,E=[E.x,E.y,E.z],H=g.create();"viewport"===C.calculated.anchor&&g.fromRotation(H,-q.transform.angle);e.transformMat3(E,E,H);k.uniform3fv(n.u_lightpos,E);k.uniform1f(n.u_lightintensity,C.calculated.intensity);k.uniform3fv(n.u_lightcolor,C.calculated.color.slice(0,3));n=0;for(q=m.segments;n<q.length;n+=1)k=q[n],k.vaos[r.id].bind(x,D,m.layoutVertexBuffer,m.elementBuffer,z.paintVertexBuffer,k.vertexOffset),x.drawElements(x.TRIANGLES,3*k.primitiveLength,
x.UNSIGNED_SHORT,6*k.primitiveOffset)}}}l.unbindFramebuffer();l.renderToMap()}};f.prototype.bindFramebuffer=function(){var b=this.gl;this.texture=this.painter.getViewportTexture(this.width,this.height);b.activeTexture(b.TEXTURE1);this.texture?b.bindTexture(b.TEXTURE_2D,this.texture):(this.texture=b.createTexture(),b.bindTexture(b.TEXTURE_2D,this.texture),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,
b.TEXTURE_MIN_FILTER,b.LINEAR),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,this.width,this.height,0,b.RGBA,b.UNSIGNED_BYTE,null),this.texture.width=this.width,this.texture.height=this.height);if(this.fbos)this.fbo=this.fbos.pop(),b.bindFramebuffer(b.FRAMEBUFFER,this.fbo);else{this.fbo=b.createFramebuffer();b.bindFramebuffer(b.FRAMEBUFFER,this.fbo);var c=b.createRenderbuffer();b.bindRenderbuffer(b.RENDERBUFFER,c);b.renderbufferStorage(b.RENDERBUFFER,
b.DEPTH_COMPONENT16,this.width,this.height);b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,c)}b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,this.texture,0)};f.prototype.unbindFramebuffer=function(){this.painter.bindDefaultFramebuffer();this.fbos?this.fbos.push(this.fbo):(this.painter.preFbos[this.width]||(this.painter.preFbos[this.width]={}),this.painter.preFbos[this.width][this.height]=[this.fbo]);this.painter.saveViewportTexture(this.texture)};
f.prototype.renderToMap=function(){var b=this.gl,c=this.painter,a=c.useProgram("extrusionTexture");b.activeTexture(b.TEXTURE0);b.bindTexture(b.TEXTURE_2D,this.texture);b.uniform1f(a.u_opacity,this.layer.paint["fill-extrusion-opacity"]);b.uniform1i(a.u_image,1);b.uniformMatrix4fv(a.u_matrix,!1,h.ortho(h.create(),0,c.width,c.height,0,0,1));b.disable(b.DEPTH_TEST);b.uniform2f(a.u_world,b.drawingBufferWidth,b.drawingBufferHeight);c=new l;c.emplaceBack(0,0);c.emplaceBack(1,0);c.emplaceBack(0,1);c.emplaceBack(1,
1);c=d.fromStructArray(c,d.BufferType.VERTEX);(new n).bind(b,a,c);b.drawArrays(b.TRIANGLE_STRIP,0,4);b.enable(b.DEPTH_TEST)}},{"../data/buffer":51,"../data/pos_array":57,"./pattern":79,"./vertex_array_object":81,"@mapbox/gl-matrix":1}],72:[function(a,k,m){var f=a("../util/browser"),d=a("../source/pixels_to_tile_units");k.exports=function(a,l,c,g){if(!a.isOpaquePass){a.setDepthSublayer(0);a.depthMask(!1);var h=a.gl;h.enable(h.STENCIL_TEST);if(!(0>=c.paint["line-width"]))for(var h=c.paint["line-dasharray"]?
"lineSDF":c.paint["line-pattern"]?"linePattern":"line",e,b=!0,p=0;p<g.length;p+=1){var q=g[p],r=l.getTile(q),n=r.getBucket(c);if(n){var k=n.buffers.layerData[c.id],m=a.currentProgram,t=a.useProgram(h,k.programConfiguration),v=b||t!==m,B=e!==r.coord.z;v&&k.programConfiguration.setUniforms(a.gl,t,c,{zoom:a.transform.zoom});a:{var w=m=b=void 0,x=void 0,C=a,z=r,n=n.buffers;e=c;var E=q,q=C.gl,D=e.paint["line-dasharray"],H=e.paint["line-pattern"];if(v||B){B=1/d(z,1,C.transform.tileZoom);if(D){var x=C.lineAtlas.getDash(D.from,
"round"===e.layout["line-cap"]),w=C.lineAtlas.getDash(D.to,"round"===e.layout["line-cap"]),I=x.width*D.fromScale,G=w.width*D.toScale;q.uniform2f(t.u_patternscale_a,B/I,-x.height/2);q.uniform2f(t.u_patternscale_b,B/G,-w.height/2);q.uniform1f(t.u_sdfgamma,C.lineAtlas.width/(256*Math.min(I,G)*f.devicePixelRatio)/2)}else if(H){m=C.spriteAtlas.getPattern(H.from);b=C.spriteAtlas.getPattern(H.to);if(!m||!b)break a;q.uniform2f(t.u_pattern_size_a,m.displaySize[0]*H.fromScale/B,b.displaySize[1]);q.uniform2f(t.u_pattern_size_b,
b.displaySize[0]*H.toScale/B,b.displaySize[1]);q.uniform2fv(t.u_texsize,C.spriteAtlas.getPixelSize())}q.uniform2f(t.u_gl_units_to_pixels,1/C.transform.pixelsToGLUnits[0],1/C.transform.pixelsToGLUnits[1])}v&&(D?(q.uniform1i(t.u_image,0),q.activeTexture(q.TEXTURE0),C.lineAtlas.bind(q),q.uniform1f(t.u_tex_y_a,x.y),q.uniform1f(t.u_tex_y_b,w.y),q.uniform1f(t.u_mix,D.t)):H&&(q.uniform1i(t.u_image,0),q.activeTexture(q.TEXTURE0),C.spriteAtlas.bind(q,!0),q.uniform2fv(t.u_pattern_tl_a,m.tl),q.uniform2fv(t.u_pattern_br_a,
m.br),q.uniform2fv(t.u_pattern_tl_b,b.tl),q.uniform2fv(t.u_pattern_br_b,b.br),q.uniform1f(t.u_fade,H.t)),q.uniform1f(t.u_width,e.paint["line-width"]));C.enableTileClippingMask(E);b=C.translatePosMatrix(E.posMatrix,z,e.paint["line-translate"],e.paint["line-translate-anchor"]);q.uniformMatrix4fv(t.u_matrix,!1,b);q.uniform1f(t.u_ratio,1/d(z,1,C.transform.zoom));b=0;for(m=n.segments;b<m.length;b+=1)w=m[b],w.vaos[e.id].bind(q,t,n.layoutVertexBuffer,n.elementBuffer,k.paintVertexBuffer,w.vertexOffset),q.drawElements(q.TRIANGLES,
3*w.primitiveLength,q.UNSIGNED_SHORT,6*w.primitiveOffset)}e=r.coord.z;b=!1}}}}},{"../source/pixels_to_tile_units":89,"../util/browser":196}],73:[function(a,k,m){function f(c){c*=Math.PI/180;var a=Math.sin(c);c=Math.cos(c);return[(2*c+1)/3,(-Math.sqrt(3)*a-c+1)/3,(Math.sqrt(3)*a-c+1)/3]}function d(c){return 0<c?1/(1-c):1+c}function n(c){return 0<c?1-1/(1.001-c):-c}var l=a("../util/util"),c=a("@mapbox/gl-matrix");k.exports=function(a,h,e,b){if(!a.isOpaquePass){var g=a.gl;g.enable(g.DEPTH_TEST);a.depthMask(!0);
g.depthFunc(g.LESS);for(var q=b.length&&b[0].z,r=0;r<b.length;r++){var u=b[r];a.setDepthSublayer(u.z-q);var k=void 0,m=void 0,t=a,v=h,B=e,w=u,u=t.gl;u.disable(u.STENCIL_TEST);var x=v.getTile(w),C=t.transform.calculatePosMatrix(w,v.getSource().maxzoom);x.registerFadeDuration(t.style.animationLoop,B.paint["normal-fade-duration"]);var z=v=t.useProgram("normal"),E=t,D=E.gl,H=E.style.light,I=c.mat3,G=c.vec3,F=H.calculated.position,F=[F.x,F.y,F.z],K=I.create();"viewport"===H.calculated.anchor&&I.fromRotation(K,
-E.transform.angle);G.transformMat3(F,F,K);D.uniform3fv(z.u_lightpos,F);D.uniform1f(z.u_lightintensity,H.calculated.intensity);D.uniform3fv(z.u_lightcolor,H.calculated.color.slice(0,3));u.uniformMatrix4fv(v.u_matrix,!1,C);u.uniform1f(v.u_brightness_low,B.paint["normal-brightness-min"]);u.uniform1f(v.u_brightness_high,B.paint["normal-brightness-max"]);u.uniform1f(v.u_saturation_factor,n(B.paint["normal-saturation"]));u.uniform1f(v.u_contrast_factor,d(B.paint["normal-contrast"]));u.uniform3fv(v.u_spin_weights,
f(B.paint["normal-hue-rotate"]));w=x.sourceCache&&x.sourceCache.findLoadedParent(w,0,{});C=x;z=w;D=t.transform;H=B.paint["normal-fade-duration"];C.sourceCache&&0<H?(I=Date.now(),E=(I-C.timeAdded)/H,H=z?(I-z.timeAdded)/H:-1,I=C.sourceCache.getSource(),D=D.coveringZoomLevel({tileSize:I.tileSize,roundZoom:I.roundZoom}),D=(D=!z||Math.abs(z.coord.z-D)>Math.abs(C.coord.z-D))&&C.refreshedUponExpiration?1:l.clamp(D?E:1-H,0,1),C.refreshedUponExpiration&&1<=E&&(C.refreshedUponExpiration=!1),C=z?{opacity:1,
mix:1-D}:{opacity:D,mix:0}):C={opacity:1,mix:0};u.activeTexture(u.TEXTURE0);u.bindTexture(u.TEXTURE_2D,x.texture);u.activeTexture(u.TEXTURE1);w?(u.bindTexture(u.TEXTURE_2D,w.texture),m=Math.pow(2,w.coord.z-x.coord.z),k=[x.coord.x*m%1,x.coord.y*m%1]):u.bindTexture(u.TEXTURE_2D,x.texture);u.uniform2fv(v.u_tl_parent,k||[0,0]);u.uniform1f(v.u_scale_parent,m||1);u.uniform1f(v.u_buffer_scale,1);u.uniform1f(v.u_fade_t,C.mix);u.uniform1f(v.u_opacity,C.opacity*B.paint["normal-opacity"]);u.uniform1i(v.u_image0,
0);u.uniform1i(v.u_image1,1);k=x.boundsBuffer||t.rasterBoundsBuffer;(x.boundsVAO||t.rasterBoundsVAO).bind(u,v,k);u.drawArrays(u.TRIANGLE_STRIP,0,k.length)}g.depthFunc(g.LEQUAL)}}},{"../util/util":217,"@mapbox/gl-matrix":1}],74:[function(a,k,m){function f(c){c*=Math.PI/180;var a=Math.sin(c);c=Math.cos(c);return[(2*c+1)/3,(-Math.sqrt(3)*a-c+1)/3,(Math.sqrt(3)*a-c+1)/3]}function d(c){return 0<c?1/(1-c):1+c}function n(c){return 0<c?1-1/(1.001-c):-c}var l=a("../util/util");k.exports=function(c,a,h,e){if(!c.isOpaquePass){var b=
c.gl;b.enable(b.DEPTH_TEST);c.depthMask(!0);b.depthFunc(b.LESS);for(var g=e.length&&e[0].z,q=0;q<e.length;q++){var r=e[q];c.setDepthSublayer(r.z-g);var u=void 0,k=void 0,m=c,t=a,v=h,B=r,r=m.gl;r.disable(r.STENCIL_TEST);var w=t.getTile(B),x=m.transform.calculatePosMatrix(B,t.getSource().maxzoom);w.registerFadeDuration(m.style.animationLoop,v.paint["raster-fade-duration"]);t=m.useProgram("raster");r.uniformMatrix4fv(t.u_matrix,!1,x);r.uniform1f(t.u_brightness_low,v.paint["raster-brightness-min"]);r.uniform1f(t.u_brightness_high,
v.paint["raster-brightness-max"]);r.uniform1f(t.u_saturation_factor,n(v.paint["raster-saturation"]));r.uniform1f(t.u_contrast_factor,d(v.paint["raster-contrast"]));r.uniform3fv(t.u_spin_weights,f(v.paint["raster-hue-rotate"]));B=w.sourceCache&&w.sourceCache.findLoadedParent(B,0,{});var x=w,C=B,z=m.transform,E=v.paint["raster-fade-duration"];if(x.sourceCache&&0<E){var D=Date.now(),H=(D-x.timeAdded)/E,E=C?(D-C.timeAdded)/E:-1,D=x.sourceCache.getSource(),z=z.coveringZoomLevel({tileSize:D.tileSize,roundZoom:D.roundZoom}),
z=(z=!C||Math.abs(C.coord.z-z)>Math.abs(x.coord.z-z))&&x.refreshedUponExpiration?1:l.clamp(z?H:1-E,0,1);x.refreshedUponExpiration&&1<=H&&(x.refreshedUponExpiration=!1);x=C?{opacity:1,mix:1-z}:{opacity:z,mix:0}}else x={opacity:1,mix:0};r.activeTexture(r.TEXTURE0);r.bindTexture(r.TEXTURE_2D,w.texture);r.activeTexture(r.TEXTURE1);B?(r.bindTexture(r.TEXTURE_2D,B.texture),k=Math.pow(2,B.coord.z-w.coord.z),u=[w.coord.x*k%1,w.coord.y*k%1]):r.bindTexture(r.TEXTURE_2D,w.texture);r.uniform2fv(t.u_tl_parent,
u||[0,0]);r.uniform1f(t.u_scale_parent,k||1);r.uniform1f(t.u_buffer_scale,1);r.uniform1f(t.u_fade_t,x.mix);r.uniform1f(t.u_opacity,x.opacity*v.paint["raster-opacity"]);r.uniform1i(t.u_image0,0);r.uniform1i(t.u_image1,1);u=w.boundsBuffer||m.rasterBoundsBuffer;(w.boundsVAO||m.rasterBoundsVAO).bind(r,t,u);r.drawArrays(r.TRIANGLE_STRIP,0,u.length)}b.depthFunc(b.LEQUAL)}}},{"../util/util":217}],75:[function(a,k,m){function f(c,b,a,f,r,u,k,m,t){if(r||!c.style.sprite||c.style.sprite.loaded()){var e=c.gl;
m="map"===m;(t="map"===t)?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST);for(var p,q,A=0;A<f.length;A+=1){var y=f[A],z=b.getTile(y),E=z.getBucket(a);if(E){var D=r?E.buffers.glyph:E.buffers.icon;if(D&&D.segments.length){var H=D.layerData[a.id].programConfiguration,I=r||E.sdfIcons,G=r?E.textSizeData:E.iconSizeData;if(!p||E.fontstack!==q){p=c.useProgram(I?"symbolSDF":"symbolIcon",H);H.setUniforms(e,p,a,{zoom:c.transform.zoom});a:{var F;q=p;F=c;var H=a,K=r,J=I,L=t,N=E.fontstack,S=E.iconsNeedLinear,O=
G,G=F.gl,P=F.transform;G.uniform1i(q.u_rotate_with_map,m);G.uniform1i(q.u_pitch_with_map,L);G.activeTexture(G.TEXTURE0);G.uniform1i(q.u_texture,0);G.uniform1f(q.u_is_text,K?1:0);if(K){J=N&&F.glyphSource.getGlyphAtlas(N);if(!J)break a;J.updateTexture(G);G.uniform2f(q.u_texsize,J.width,J.height)}else{var N=F.options.rotating||F.options.zooming,Q=!H.isLayoutValueFeatureConstant("icon-size")||!H.isLayoutValueZoomConstant("icon-size")||1!==H.getLayoutValue("icon-size",{zoom:P.zoom}),L=L||P.pitch;F.spriteAtlas.bind(G,
J||N||Q||S||L);G.uniform2fv(q.u_texsize,F.spriteAtlas.getPixelSize())}G.activeTexture(G.TEXTURE1);F.frameHistory.bind(G);G.uniform1i(q.u_fadetexture,1);G.uniform1f(q.u_zoom,P.zoom);G.uniform1f(q.u_pitch,P.pitch/360*2*Math.PI);G.uniform1f(q.u_bearing,P.bearing/360*2*Math.PI);G.uniform1f(q.u_aspect_ratio,P.width/P.height);G.uniform1i(q.u_is_size_zoom_constant,O.isZoomConstant?1:0);G.uniform1i(q.u_is_size_feature_constant,O.isFeatureConstant?1:0);O.isZoomConstant||O.isFeatureConstant?O.isFeatureConstant&&
!O.isZoomConstant?("interval"===O.functionType?F=H.getLayoutValue(K?"text-size":"icon-size",{zoom:P.zoom}):(n("exponential"===O.functionType),F="interval"===O.functionType?0:h(P.zoom,O.functionBase,O.coveringZoomRange[0],O.coveringZoomRange[1]),K=O.coveringStopValues[0],F=K+(O.coveringStopValues[1]-K)*l.clamp(F,0,1)),G.uniform1f(q.u_size,F),G.uniform1f(q.u_layout_size,O.layoutSize)):O.isFeatureConstant&&O.isZoomConstant&&G.uniform1f(q.u_size,O.layoutSize):(O=h(P.zoom,O.functionBase,O.coveringZoomRange[0],
O.coveringZoomRange[1]),G.uniform1f(q.u_size_t,l.clamp(O,0,1)));G.uniform1f(q.u_camera_to_center_distance,P.cameraToCenterDistance);"line"===H.layout["symbol-placement"]&&"map"===H.layout["text-rotation-alignment"]&&"viewport"===H.layout["text-pitch-alignment"]&&H.layout["text-field"]?G.uniform1f(q.u_max_camera_distance,1.5):G.uniform1f(q.u_max_camera_distance,10)}}c.enableTileClippingMask(y);e.uniformMatrix4fv(p.u_matrix,!1,c.translatePosMatrix(y.posMatrix,z,u,k));e.uniform1f(p.u_collision_y_stretch,
z.collisionTile.yStretch);y=p;q=a;P=r;O=I;I=t;H=c.gl;G=c.transform;I?(z=g(z,1,G.zoom),H.uniform2f(y.u_extrude_scale,z,z)):(z=G.cameraToCenterDistance,H.uniform2f(y.u_extrude_scale,G.pixelsToGLUnits[0]*z,G.pixelsToGLUnits[1]*z));O&&(z=(P?"text":"icon")+"-halo-width",z=!q.isPaintValueFeatureConstant(z)||q.paint[z],H.uniform1f(y.u_gamma_scale,(I?Math.cos(G._pitch):1)*G.cameraToCenterDistance),z&&(H.uniform1f(y.u_is_halo,1),d(D,q,H,y)),H.uniform1f(y.u_is_halo,0));d(D,q,H,y);q=E.fontstack}}}t||e.enable(e.DEPTH_TEST)}}
function d(c,b,a,d){for(var e=c.layerData[b.id],e=e&&e.paintVertexBuffer,f=0,g=c.segments;f<g.length;f+=1){var h=g[f];h.vaos[b.id].bind(a,d,c.layoutVertexBuffer,c.elementBuffer,e,h.vertexOffset);a.drawElements(a.TRIANGLES,3*h.primitiveLength,a.UNSIGNED_SHORT,6*h.primitiveOffset)}}var n=a("assert"),l=a("../util/util"),c=a("./draw_collision_debug"),g=a("../source/pixels_to_tile_units"),h=a("../style-spec/function").interpolationFactor;k.exports=function(a,b,d,g){if(!a.isOpaquePass){var e=a.gl;d.layout["text-allow-overlap"]||
d.layout["icon-allow-overlap"]||d.layout["text-ignore-placement"]||d.layout["icon-ignore-placement"]?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST);a.setDepthSublayer(0);a.depthMask(!1);f(a,b,d,g,!1,d.paint["icon-translate"],d.paint["icon-translate-anchor"],d.layout["icon-rotation-alignment"],d.layout["icon-rotation-alignment"]);f(a,b,d,g,!0,d.paint["text-translate"],d.paint["text-translate-anchor"],d.layout["text-rotation-alignment"],d.layout["text-pitch-alignment"]);b.map.showCollisionBoxes&&
c(a,b,d,g)}}},{"../source/pixels_to_tile_units":89,"../style-spec/function":108,"../util/util":217,"./draw_collision_debug":68,assert:5}],76:[function(a,k,m){a=function(){this.changeTimes=new Float64Array(256);this.changeOpacities=new Uint8Array(256);this.opacities=new Uint8ClampedArray(256);this.array=new Uint8Array(this.opacities.buffer);this.previousZoom=0;this.firstFrame=!0};a.prototype.record=function(a,d,n){this.firstFrame&&(a=0,this.firstFrame=!1);d=Math.floor(10*d);var f;if(d<this.previousZoom)for(f=
d+1;f<=this.previousZoom;f++)this.changeTimes[f]=a,this.changeOpacities[f]=this.opacities[f];else for(f=d;f>this.previousZoom;f--)this.changeTimes[f]=a,this.changeOpacities[f]=this.opacities[f];for(f=0;256>f;f++){var c=a-this.changeTimes[f],c=255*(n?c/n:1);this.opacities[f]=f<=d?this.changeOpacities[f]+c:this.changeOpacities[f]-c}this.changed=!0;this.previousZoom=d};a.prototype.bind=function(a){this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.changed&&(a.texSubImage2D(a.TEXTURE_2D,0,0,
0,256,1,a.ALPHA,a.UNSIGNED_BYTE,this.array),this.changed=!1)):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,256,1,0,a.ALPHA,a.UNSIGNED_BYTE,this.array))};k.exports=a},{}],77:[function(a,k,m){var f=
a("../util/util");a=function(a,f){this.width=a;this.height=f;this.nextRow=0;this.bytes=4;this.data=new Uint8Array(this.width*this.height*this.bytes);this.positions={}};a.prototype.setSprite=function(a){this.sprite=a};a.prototype.getDash=function(a,f){var d=a.join(",")+f;this.positions[d]||(this.positions[d]=this.addDash(a,f));return this.positions[d]};a.prototype.addDash=function(a,n){var d=n?7:0,c=2*d+1;if(this.nextRow+c>this.height)return f.warnOnce("LineAtlas out of space"),null;for(var g=0,h=
0;h<a.length;h++)g+=a[h];for(var h=this.width/g,e=h/2,b=1===a.length%2,p=-d;p<=d;p++)for(var q=this.width*(this.nextRow+d+p),r=b?-a[a.length-1]:0,u=a[0],k=1,m=0;m<this.width;m++){for(;u<m/h;)r=u,u+=a[k],b&&k===a.length-1&&(u+=a[0]),k++;var t=Math.min(Math.abs(m-r*h),Math.abs(m-u*h)),v=1===k%2;if(n){var B=d?p/d*(e+1):0;v?(v=e-Math.abs(B),t=Math.sqrt(t*t+v*v)):t=e-Math.sqrt(t*t+B*B)}else t*=v?1:-1;this.data[3+4*(q+m)]=Math.max(0,Math.min(255,t+128))}d={y:(this.nextRow+d+.5)/this.height,height:2*d/this.height,
width:g};this.nextRow+=c;this.dirty=!0;return d};a.prototype.bind=function(a){this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.RGBA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,
a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,this.width,this.height,0,a.RGBA,a.UNSIGNED_BYTE,this.data))};k.exports=a},{"../util/util":217}],78:[function(a,k,m){var f=a("../util/browser"),d=a("@mapbox/gl-matrix").mat4,n=a("./frame_history"),l=a("../source/source_cache"),c=a("../data/extent"),g=a("../source/pixels_to_tile_units"),h=a("../util/util"),e=a("../data/buffer"),b=a("./vertex_array_object"),p=a("../data/raster_bounds_array"),q=a("../data/pos_array"),r=a("../data/program_configuration"),
u=a("./shaders"),A=a("assert"),y={symbol:a("./draw_symbol"),circle:a("./draw_circle"),line:a("./draw_line"),fill:a("./draw_fill"),"fill-extrusion":a("./draw_fill_extrusion"),raster:a("./draw_raster"),background:a("./draw_background"),normal:a("./draw_normal"),debug:a("./draw_debug")};a=function(b,c){this.gl=b;this.transform=c;this.reusableTextures={tiles:{},viewport:null};this.preFbos={};this.frameHistory=new n;this.setup();this.numSublayers=l.maxUnderzooming+l.maxOverzooming+1;this.depthEpsilon=
1/Math.pow(2,16);this.lineWidthRange=b.getParameter(b.ALIASED_LINE_WIDTH_RANGE);this.basicFillProgramConfiguration=r.createStatic(["color","opacity"]);this.emptyProgramConfiguration=new r};a.prototype.resize=function(b,c){var a=this.gl;this.width=b*f.devicePixelRatio;this.height=c*f.devicePixelRatio;a.viewport(0,0,this.width,this.height)};a.prototype.setup=function(){var a=this.gl;a.verbose=!0;a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);a.enable(a.STENCIL_TEST);a.enable(a.DEPTH_TEST);
a.depthFunc(a.LEQUAL);this._depthMask=!1;a.depthMask(!1);var d=new q;d.emplaceBack(0,0);d.emplaceBack(c,0);d.emplaceBack(0,c);d.emplaceBack(c,c);this.tileExtentBuffer=e.fromStructArray(d,e.BufferType.VERTEX);this.tileExtentVAO=new b;this.tileExtentPatternVAO=new b;d=new q;d.emplaceBack(0,0);d.emplaceBack(c,0);d.emplaceBack(c,c);d.emplaceBack(0,c);d.emplaceBack(0,0);this.debugBuffer=e.fromStructArray(d,e.BufferType.VERTEX);this.debugVAO=new b;d=new p;d.emplaceBack(0,0,0,0);d.emplaceBack(c,0,32767,
0);d.emplaceBack(0,c,0,32767);d.emplaceBack(c,c,32767,32767);this.rasterBoundsBuffer=e.fromStructArray(d,e.BufferType.VERTEX);this.rasterBoundsVAO=new b;if(this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"))this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)};a.prototype.clearColor=function(){var b=
this.gl;b.clearColor(0,0,0,0);b.clear(b.COLOR_BUFFER_BIT)};a.prototype.clearStencil=function(){var b=this.gl;b.clearStencil(0);b.stencilMask(255);b.clear(b.STENCIL_BUFFER_BIT)};a.prototype.clearDepth=function(){var b=this.gl;b.clearDepth(1);this.depthMask(!0);b.clear(b.DEPTH_BUFFER_BIT)};a.prototype._renderTileClippingMasks=function(b){var c=this.gl;c.colorMask(!1,!1,!1,!1);this.depthMask(!1);c.disable(c.DEPTH_TEST);c.enable(c.STENCIL_TEST);c.stencilMask(255);c.stencilOp(c.KEEP,c.KEEP,c.REPLACE);
var a=1;this._tileClippingMaskIDs={};for(var e=0;e<b.length;e+=1){var d=b[e],f=this._tileClippingMaskIDs[d.id]=a++;c.stencilFunc(c.ALWAYS,f,255);f=this.useProgram("fill",this.basicFillProgramConfiguration);c.uniformMatrix4fv(f.u_matrix,!1,d.posMatrix);this.tileExtentVAO.bind(c,f,this.tileExtentBuffer);c.drawArrays(c.TRIANGLE_STRIP,0,this.tileExtentBuffer.length)}c.stencilMask(0);c.colorMask(!0,!0,!0,!0);this.depthMask(!0);c.enable(c.DEPTH_TEST)};a.prototype.enableTileClippingMask=function(b){var c=
this.gl;c.stencilFunc(c.EQUAL,this._tileClippingMaskIDs[b.id],255)};a.prototype.prepareBuffers=function(){};a.prototype.bindDefaultFramebuffer=function(){var b=this.gl;b.bindFramebuffer(b.FRAMEBUFFER,null)};a.prototype.render=function(b,c){this.style=b;this.options=c;this.lineAtlas=b.lineAtlas;this.spriteAtlas=b.spriteAtlas;this.spriteAtlas.setSprite(b.sprite);this.glyphSource=b.glyphSource;this.frameHistory.record(Date.now(),this.transform.zoom,b.getTransition().duration);this.prepareBuffers();this.clearColor();
this.clearDepth();this.showOverdrawInspector(c.showOverdrawInspector);this.depthRange=(b._order.length+2)*this.numSublayers*this.depthEpsilon;this.isOpaquePass=!0;this.renderPass();this.isOpaquePass=!1;this.renderPass();if(this.options.showTileBoundaries){var a=this.style.sourceCaches[Object.keys(this.style.sourceCaches)[0]];a&&y.debug(this,a,a.getVisibleCoordinates())}};a.prototype.renderPass=function(){var b=this.style._order,c,a;this.currentLayer=this.isOpaquePass?b.length-1:0;this.isOpaquePass?
this._showOverdrawInspector||this.gl.disable(this.gl.BLEND):this.gl.enable(this.gl.BLEND);for(var e=0;e<b.length;e++){var d=this.style._layers[b[this.currentLayer]];d.source!==(c&&c.id)&&(c=this.style.sourceCaches[d.source],a=[],c&&(c.prepare&&c.prepare(),this.clearStencil(),a=c.getVisibleCoordinates(),c.getSource().isTileClipped&&this._renderTileClippingMasks(a)),this.isOpaquePass||a.reverse());this.renderLayer(this,c,d,a);this.currentLayer+=this.isOpaquePass?-1:1}};a.prototype.depthMask=function(b){b!==
this._depthMask&&(this._depthMask=b,this.gl.depthMask(b))};a.prototype.renderLayer=function(b,c,a,e){a.isHidden(this.transform.zoom)||"background"!==a.type&&!e.length||(this.id=a.id,y[a.type](b,c,a,e))};a.prototype.setDepthSublayer=function(b){b=1-((1+this.currentLayer)*this.numSublayers+b)*this.depthEpsilon;this.gl.depthRange(b-1+this.depthRange,b)};a.prototype.translatePosMatrix=function(b,c,a,e){if(!a[0]&&!a[1])return b;if("viewport"===e){e=Math.sin(-this.transform.angle);var f=Math.cos(-this.transform.angle);
a=[a[0]*f-a[1]*e,a[0]*e+a[1]*f]}c=[g(c,a[0],this.transform.zoom),g(c,a[1],this.transform.zoom),0];a=new Float32Array(16);d.translate(a,b,c);return a};a.prototype.saveTileTexture=function(b){var c=this.reusableTextures.tiles[b.size];c?c.push(b):this.reusableTextures.tiles[b.size]=[b]};a.prototype.saveViewportTexture=function(b){this.reusableTextures.viewport=b};a.prototype.getTileTexture=function(b){return(b=this.reusableTextures.tiles[b])&&0<b.length?b.pop():null};a.prototype.getViewportTexture=function(b,
c){var a=this.reusableTextures.viewport;if(a){if(a.width===b&&a.height===c)return a;this.gl.deleteTexture(a);this.reusableTextures.viewport=null}};a.prototype.lineWidth=function(b){this.gl.lineWidth(h.clamp(b,this.lineWidthRange[0],this.lineWidthRange[1]))};a.prototype.showOverdrawInspector=function(b){if(b||this._showOverdrawInspector){this._showOverdrawInspector=b;var c=this.gl;b?(c.blendFunc(c.CONSTANT_COLOR,c.ONE),c.blendColor(.125,.125,.125,0),c.clearColor(0,0,0,1),c.clear(c.COLOR_BUFFER_BIT)):
c.blendFunc(c.ONE,c.ONE_MINUS_SRC_ALPHA)}};a.prototype.createProgram=function(b,c){var a=this.gl,e=a.createProgram(),d=u[b],g="#define MAPBOX_GL_JS\n#define DEVICE_PIXEL_RATIO "+f.devicePixelRatio.toFixed(1)+"\n";this._showOverdrawInspector&&(g+="#define OVERDRAW_INSPECTOR;\n");var h=c.applyPragmas(g+u.prelude.fragmentSource+d.fragmentSource,"fragment"),d=c.applyPragmas(g+u.prelude.vertexSource+d.vertexSource,"vertex"),g=a.createShader(a.FRAGMENT_SHADER);a.shaderSource(g,h);a.compileShader(g);A(a.getShaderParameter(g,
a.COMPILE_STATUS),a.getShaderInfoLog(g));a.attachShader(e,g);h=a.createShader(a.VERTEX_SHADER);a.shaderSource(h,d);a.compileShader(h);A(a.getShaderParameter(h,a.COMPILE_STATUS),a.getShaderInfoLog(h));a.attachShader(e,h);"symbolSDF"===b&&a.bindAttribLocation(e,0,"a_data");a.linkProgram(e);A(a.getProgramParameter(e,a.LINK_STATUS),a.getProgramInfoLog(e));d=a.getProgramParameter(e,a.ACTIVE_ATTRIBUTES);h={program:e,numAttributes:d};for(g=0;g<d;g++){var p=a.getActiveAttrib(e,g);h[p.name]=a.getAttribLocation(e,
p.name)}d=a.getProgramParameter(e,a.ACTIVE_UNIFORMS);for(g=0;g<d;g++)p=a.getActiveUniform(e,g),h[p.name]=a.getUniformLocation(e,p.name);return h};a.prototype._createProgramCached=function(b,c){this.cache=this.cache||{};var a=""+b+(c.cacheKey||"")+(this._showOverdrawInspector?"/overdraw":"");this.cache[a]||(this.cache[a]=this.createProgram(b,c));return this.cache[a]};a.prototype.useProgram=function(b,c){var a=this.gl,e=this._createProgramCached(b,c||this.emptyProgramConfiguration);this.currentProgram!==
e&&(a.useProgram(e.program),this.currentProgram=e);return e};k.exports=a},{"../data/buffer":51,"../data/extent":54,"../data/pos_array":57,"../data/program_configuration":58,"../data/raster_bounds_array":59,"../source/pixels_to_tile_units":89,"../source/source_cache":94,"../util/browser":196,"../util/util":217,"./draw_background":66,"./draw_circle":67,"./draw_debug":69,"./draw_fill":70,"./draw_fill_extrusion":71,"./draw_line":72,"./draw_normal":73,"./draw_raster":74,"./draw_symbol":75,"./frame_history":76,
"./shaders":80,"./vertex_array_object":81,"@mapbox/gl-matrix":1,assert:5}],79:[function(a,k,m){var f=a("assert"),d=a("../source/pixels_to_tile_units");m.isPatternMissing=function(a,d){if(!a)return!1;var c=d.spriteAtlas.getPattern(a.from),f=d.spriteAtlas.getPattern(a.to);return!c||!f};m.prepare=function(a,d,c){var g=d.gl,h=d.spriteAtlas.getPattern(a.from),e=d.spriteAtlas.getPattern(a.to);f(h&&e);g.uniform1i(c.u_image,0);g.uniform2fv(c.u_pattern_tl_a,h.tl);g.uniform2fv(c.u_pattern_br_a,h.br);g.uniform2fv(c.u_pattern_tl_b,
e.tl);g.uniform2fv(c.u_pattern_br_b,e.br);g.uniform2fv(c.u_texsize,d.spriteAtlas.getPixelSize());g.uniform1f(c.u_mix,a.t);g.uniform2fv(c.u_pattern_size_a,h.displaySize);g.uniform2fv(c.u_pattern_size_b,e.displaySize);g.uniform1f(c.u_scale_a,a.fromScale);g.uniform1f(c.u_scale_b,a.toScale);g.activeTexture(g.TEXTURE0);d.spriteAtlas.bind(g,!0)};m.setTile=function(a,f,c){var g=f.gl;g.uniform1f(c.u_tile_units_to_pixels,1/d(a,1,f.transform.tileZoom));var h=Math.pow(2,a.coord.z);f=a.tileSize*Math.pow(2,f.transform.tileZoom)/
h;h=f*(a.coord.x+a.coord.w*h);a=f*a.coord.y;g.uniform2f(c.u_pixel_coord_upper,h>>16,a>>16);g.uniform2f(c.u_pixel_coord_lower,h&65535,a&65535)}},{"../source/pixels_to_tile_units":89,assert:5}],80:[function(a,k,m){k.exports={prelude:{fragmentSource:"#ifdef GL_ES\r\nprecision mediump float;\r\n#else\r\n\r\n#if !defined(lowp)\r\n#define lowp\r\n#endif\r\n\r\n#if !defined(mediump)\r\n#define mediump\r\n#endif\r\n\r\n#if !defined(highp)\r\n#define highp\r\n#endif\r\n\r\n#endif\r\n",vertexSource:"#ifdef GL_ES\r\nprecision highp float;\r\n#else\r\n\r\n#if !defined(lowp)\r\n#define lowp\r\n#endif\r\n\r\n#if !defined(mediump)\r\n#define mediump\r\n#endif\r\n\r\n#if !defined(highp)\r\n#define highp\r\n#endif\r\n\r\n#endif\r\n\r\nfloat evaluate_zoom_function_1(const vec4 values, const float t) {\r\n    if (t < 1.0) {\r\n        return mix(values[0], values[1], t);\r\n    } else if (t < 2.0) {\r\n        return mix(values[1], values[2], t - 1.0);\r\n    } else {\r\n        return mix(values[2], values[3], t - 2.0);\r\n    }\r\n}\r\nvec4 evaluate_zoom_function_4(const vec4 value0, const vec4 value1, const vec4 value2, const vec4 value3, const float t) {\r\n    if (t < 1.0) {\r\n        return mix(value0, value1, t);\r\n    } else if (t < 2.0) {\r\n        return mix(value1, value2, t - 1.0);\r\n    } else {\r\n        return mix(value2, value3, t - 2.0);\r\n    }\r\n}\r\n\r\n// Unpack a pair of values that have been packed into a single float.\r\n// The packed values are assumed to be 8-bit unsigned integers, and are\r\n// packed like so:\r\n// packedValue = floor(input[0]) * 256 + input[1],\r\nvec2 unpack_float(const float packedValue) {\r\n    int packedIntValue = int(packedValue);\r\n    int v0 = packedIntValue / 256;\r\n    return vec2(v0, packedIntValue - v0 * 256);\r\n}\r\n\r\n\r\n// To minimize the number of attributes needed in the mapbox-gl-native shaders,\r\n// we encode a 4-component color into a pair of floats (i.e. a vec2) as follows:\r\n// [ floor(color.r * 255) * 256 + color.g * 255,\r\n//   floor(color.b * 255) * 256 + color.g * 255 ]\r\nvec4 decode_color(const vec2 encodedColor) {\r\n    return vec4(\r\n        unpack_float(encodedColor[0]) / 255.0,\r\n        unpack_float(encodedColor[1]) / 255.0\r\n    );\r\n}\r\n\r\n// Unpack a pair of paint values and interpolate between them.\r\nfloat unpack_mix_vec2(const vec2 packedValue, const float t) {\r\n    return mix(packedValue[0], packedValue[1], t);\r\n}\r\n\r\n// Unpack a pair of paint values and interpolate between them.\r\nvec4 unpack_mix_vec4(const vec4 packedColors, const float t) {\r\n    vec4 minColor = decode_color(vec2(packedColors[0], packedColors[1]));\r\n    vec4 maxColor = decode_color(vec2(packedColors[2], packedColors[3]));\r\n    return mix(minColor, maxColor, t);\r\n}\r\n\r\n// The offset depends on how many pixels are between the world origin and the edge of the tile:\r\n// vec2 offset = mod(pixel_coord, size)\r\n//\r\n// At high zoom levels there are a ton of pixels between the world origin and the edge of the tile.\r\n// The glsl spec only guarantees 16 bits of precision for highp floats. We need more than that.\r\n//\r\n// The pixel_coord is passed in as two 16 bit values:\r\n// pixel_coord_upper = floor(pixel_coord / 2^16)\r\n// pixel_coord_lower = mod(pixel_coord, 2^16)\r\n//\r\n// The offset is calculated in a series of steps that should preserve this precision:\r\nvec2 get_pattern_pos(const vec2 pixel_coord_upper, const vec2 pixel_coord_lower,\r\n    const vec2 pattern_size, const float tile_units_to_pixels, const vec2 pos) {\r\n\r\n    vec2 offset = mod(mod(mod(pixel_coord_upper, pattern_size) * 256.0, pattern_size) * 256.0 + pixel_coord_lower, pattern_size);\r\n    return (tile_units_to_pixels * pos + offset) / pattern_size;\r\n}\r\n"},
circle:{fragmentSource:"#pragma mapbox: define highp vec4 color\r\n#pragma mapbox: define mediump float radius\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define highp vec4 stroke_color\r\n#pragma mapbox: define mediump float stroke_width\r\n#pragma mapbox: define lowp float stroke_opacity\r\n\r\nvarying vec2 v_extrude;\r\nvarying lowp float v_antialiasblur;\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize highp vec4 color\r\n    #pragma mapbox: initialize mediump float radius\r\n    #pragma mapbox: initialize lowp float blur\r\n    #pragma mapbox: initialize lowp float opacity\r\n    #pragma mapbox: initialize highp vec4 stroke_color\r\n    #pragma mapbox: initialize mediump float stroke_width\r\n    #pragma mapbox: initialize lowp float stroke_opacity\r\n\r\n    float extrude_length = length(v_extrude);\r\n    float antialiased_blur = -max(blur, v_antialiasblur);\r\n\r\n    float opacity_t = smoothstep(0.0, antialiased_blur, extrude_length - 1.0);\r\n\r\n    float color_t = stroke_width < 0.01 ? 0.0 : smoothstep(\r\n        antialiased_blur,\r\n        0.0,\r\n        extrude_length - radius / (radius + stroke_width)\r\n    );\r\n\r\n    gl_FragColor = opacity_t * mix(color * opacity, stroke_color * stroke_opacity, color_t);\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",
vertexSource:"uniform mat4 u_matrix;\r\nuniform bool u_scale_with_map;\r\nuniform vec2 u_extrude_scale;\r\n\r\nattribute vec2 a_pos;\r\n\r\n#pragma mapbox: define highp vec4 color\r\n#pragma mapbox: define mediump float radius\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define highp vec4 stroke_color\r\n#pragma mapbox: define mediump float stroke_width\r\n#pragma mapbox: define lowp float stroke_opacity\r\n\r\nvarying vec2 v_extrude;\r\nvarying lowp float v_antialiasblur;\r\n\r\nvoid main(void) {\r\n    #pragma mapbox: initialize highp vec4 color\r\n    #pragma mapbox: initialize mediump float radius\r\n    #pragma mapbox: initialize lowp float blur\r\n    #pragma mapbox: initialize lowp float opacity\r\n    #pragma mapbox: initialize highp vec4 stroke_color\r\n    #pragma mapbox: initialize mediump float stroke_width\r\n    #pragma mapbox: initialize lowp float stroke_opacity\r\n\r\n    // unencode the extrusion vector that we snuck into the a_pos vector\r\n    v_extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\r\n\r\n    vec2 extrude = v_extrude * (radius + stroke_width) * u_extrude_scale;\r\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\r\n    // in extrusion data\r\n    gl_Position = u_matrix * vec4(floor(a_pos * 0.5), 0, 1);\r\n\r\n    if (u_scale_with_map) {\r\n        gl_Position.xy += extrude;\r\n    } else {\r\n        gl_Position.xy += extrude * gl_Position.w;\r\n    }\r\n\r\n    // This is a minimum blur distance that serves as a faux-antialiasing for\r\n    // the circle. since blur is a ratio of the circle's size and the intent is\r\n    // to keep the blur at roughly 1px, the two are inversely related.\r\n    v_antialiasblur = 1.0 / DEVICE_PIXEL_RATIO / (radius + stroke_width);\r\n}\r\n"},
collisionBox:{fragmentSource:"uniform float u_zoom;\r\n// u_maxzoom is derived from the maximum scale considered by the CollisionTile\r\n// Labels with placement zoom greater than this value will not be placed,\r\n// regardless of perspective effects.\r\nuniform float u_maxzoom;\r\nuniform sampler2D u_fadetexture;\r\n\r\n// v_max_zoom is a collision-box-specific value that controls when line-following\r\n// collision boxes are used.\r\nvarying float v_max_zoom;\r\nvarying float v_placement_zoom;\r\nvarying float v_perspective_zoom_adjust;\r\nvarying vec2 v_fade_tex;\r\n\r\nvoid main() {\r\n\r\n    float alpha = 0.5;\r\n\r\n    // Green = no collisions, label is showing\r\n    gl_FragColor = vec4(0.0, 1.0, 0.0, 1.0) * alpha;\r\n\r\n    // Red = collision, label hidden\r\n    if (texture2D(u_fadetexture, v_fade_tex).a < 1.0) {\r\n        gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\r\n    }\r\n\r\n    // Faded black = this collision box is not used at this zoom (for curved labels)\r\n    if (u_zoom >= v_max_zoom + v_perspective_zoom_adjust) {\r\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0) * alpha * 0.25;\r\n    }\r\n\r\n    // Faded blue = the placement scale for this label is beyond the CollisionTile\r\n    // max scale, so it's impossible for this label to show without collision detection\r\n    // being run again (the label's glyphs haven't even been added to the symbol bucket)\r\n    if (v_placement_zoom >= u_maxzoom) {\r\n        gl_FragColor = vec4(0.0, 0.0, 1.0, 1.0) * alpha * 0.2;\r\n    }\r\n}\r\n",
vertexSource:"attribute vec2 a_pos;\r\nattribute vec2 a_anchor_pos;\r\nattribute vec2 a_extrude;\r\nattribute vec2 a_data;\r\n\r\nuniform mat4 u_matrix;\r\nuniform float u_scale;\r\nuniform float u_pitch;\r\nuniform float u_collision_y_stretch;\r\nuniform float u_camera_to_center_distance;\r\n\r\nvarying float v_max_zoom;\r\nvarying float v_placement_zoom;\r\nvarying float v_perspective_zoom_adjust;\r\nvarying vec2 v_fade_tex;\r\n\r\nvoid main() {\r\n    vec4 projectedPoint = u_matrix * vec4(a_anchor_pos, 0, 1);\r\n    highp float camera_to_anchor_distance = projectedPoint.w;\r\n    highp float collision_perspective_ratio = 1.0 + 0.5 * ((camera_to_anchor_distance / u_camera_to_center_distance) - 1.0);\r\n\r\n    highp float incidence_stretch  = camera_to_anchor_distance / (u_camera_to_center_distance * cos(u_pitch));\r\n    highp float collision_adjustment = max(1.0, incidence_stretch / u_collision_y_stretch);\r\n\r\n    gl_Position = u_matrix * vec4(a_pos + a_extrude * collision_perspective_ratio * collision_adjustment / u_scale, 0.0, 1.0);\r\n\r\n    v_max_zoom = a_data.x;\r\n    v_placement_zoom = a_data.y;\r\n\r\n    v_perspective_zoom_adjust = floor(log2(collision_perspective_ratio * collision_adjustment) * 10.0);\r\n    v_fade_tex = vec2((v_placement_zoom + v_perspective_zoom_adjust) / 255.0, 0.0);\r\n}\r\n"},
debug:{fragmentSource:"uniform highp vec4 u_color;\r\n\r\nvoid main() {\r\n    gl_FragColor = u_color;\r\n}\r\n",vertexSource:"attribute vec2 a_pos;\r\n\r\nuniform mat4 u_matrix;\r\n\r\nvoid main() {\r\n    gl_Position = u_matrix * vec4(a_pos, step(32767.0, a_pos.x), 1);\r\n}\r\n"},fill:{fragmentSource:"#pragma mapbox: define highp vec4 color\r\n#pragma mapbox: define lowp float opacity\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize highp vec4 color\r\n    #pragma mapbox: initialize lowp float opacity\r\n\r\n    gl_FragColor = color * opacity;\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",
vertexSource:"attribute vec2 a_pos;\r\n\r\nuniform mat4 u_matrix;\r\n\r\n#pragma mapbox: define highp vec4 color\r\n#pragma mapbox: define lowp float opacity\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize highp vec4 color\r\n    #pragma mapbox: initialize lowp float opacity\r\n\r\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\r\n}\r\n"},fillOutline:{fragmentSource:"#pragma mapbox: define highp vec4 outline_color\r\n#pragma mapbox: define lowp float opacity\r\n\r\nvarying vec2 v_pos;\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize highp vec4 outline_color\r\n    #pragma mapbox: initialize lowp float opacity\r\n\r\n    float dist = length(v_pos - gl_FragCoord.xy);\r\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\r\n    gl_FragColor = outline_color * (alpha * opacity);\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",
vertexSource:"attribute vec2 a_pos;\r\n\r\nuniform mat4 u_matrix;\r\nuniform vec2 u_world;\r\n\r\nvarying vec2 v_pos;\r\n\r\n#pragma mapbox: define highp vec4 outline_color\r\n#pragma mapbox: define lowp float opacity\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize highp vec4 outline_color\r\n    #pragma mapbox: initialize lowp float opacity\r\n\r\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\r\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\r\n}\r\n"},fillOutlinePattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\r\nuniform vec2 u_pattern_br_a;\r\nuniform vec2 u_pattern_tl_b;\r\nuniform vec2 u_pattern_br_b;\r\nuniform vec2 u_texsize;\r\nuniform float u_mix;\r\n\r\nuniform sampler2D u_image;\r\n\r\nvarying vec2 v_pos_a;\r\nvarying vec2 v_pos_b;\r\nvarying vec2 v_pos;\r\n\r\n#pragma mapbox: define lowp float opacity\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize lowp float opacity\r\n\r\n    vec2 imagecoord = mod(v_pos_a, 1.0);\r\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\r\n    vec4 color1 = texture2D(u_image, pos);\r\n\r\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\r\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\r\n    vec4 color2 = texture2D(u_image, pos2);\r\n\r\n    // find distance to outline for alpha interpolation\r\n\r\n    float dist = length(v_pos - gl_FragCoord.xy);\r\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\r\n\r\n\r\n    gl_FragColor = mix(color1, color2, u_mix) * alpha * opacity;\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",
vertexSource:"uniform mat4 u_matrix;\r\nuniform vec2 u_world;\r\nuniform vec2 u_pattern_size_a;\r\nuniform vec2 u_pattern_size_b;\r\nuniform vec2 u_pixel_coord_upper;\r\nuniform vec2 u_pixel_coord_lower;\r\nuniform float u_scale_a;\r\nuniform float u_scale_b;\r\nuniform float u_tile_units_to_pixels;\r\n\r\nattribute vec2 a_pos;\r\n\r\nvarying vec2 v_pos_a;\r\nvarying vec2 v_pos_b;\r\nvarying vec2 v_pos;\r\n\r\n#pragma mapbox: define lowp float opacity\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize lowp float opacity\r\n\r\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\r\n\r\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\r\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\r\n\r\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\r\n}\r\n"},
fillPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\r\nuniform vec2 u_pattern_br_a;\r\nuniform vec2 u_pattern_tl_b;\r\nuniform vec2 u_pattern_br_b;\r\nuniform vec2 u_texsize;\r\nuniform float u_mix;\r\n\r\nuniform sampler2D u_image;\r\n\r\nvarying vec2 v_pos_a;\r\nvarying vec2 v_pos_b;\r\n\r\n#pragma mapbox: define lowp float opacity\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize lowp float opacity\r\n\r\n    vec2 imagecoord = mod(v_pos_a, 1.0);\r\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\r\n    vec4 color1 = texture2D(u_image, pos);\r\n\r\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\r\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\r\n    vec4 color2 = texture2D(u_image, pos2);\r\n\r\n    gl_FragColor = mix(color1, color2, u_mix) * opacity;\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",
vertexSource:"uniform mat4 u_matrix;\r\nuniform vec2 u_pattern_size_a;\r\nuniform vec2 u_pattern_size_b;\r\nuniform vec2 u_pixel_coord_upper;\r\nuniform vec2 u_pixel_coord_lower;\r\nuniform float u_scale_a;\r\nuniform float u_scale_b;\r\nuniform float u_tile_units_to_pixels;\r\n\r\nattribute vec2 a_pos;\r\n\r\nvarying vec2 v_pos_a;\r\nvarying vec2 v_pos_b;\r\n\r\n#pragma mapbox: define lowp float opacity\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize lowp float opacity\r\n\r\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\r\n\r\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\r\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\r\n}\r\n"},
fillExtrusion:{fragmentSource:"varying vec4 v_color;\r\n#pragma mapbox: define lowp float base\r\n#pragma mapbox: define lowp float height\r\n#pragma mapbox: define highp vec4 color\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize lowp float base\r\n    #pragma mapbox: initialize lowp float height\r\n    #pragma mapbox: initialize highp vec4 color\r\n\r\n    gl_FragColor = v_color;\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",vertexSource:"uniform mat4 u_matrix;\r\nuniform vec3 u_lightcolor;\r\nuniform lowp vec3 u_lightpos;\r\nuniform lowp float u_lightintensity;\r\n\r\nattribute vec2 a_pos;\r\nattribute vec3 a_normal;\r\nattribute float a_edgedistance;\r\n\r\nvarying vec4 v_color;\r\n\r\n#pragma mapbox: define lowp float base\r\n#pragma mapbox: define lowp float height\r\n\r\n#pragma mapbox: define highp vec4 color\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize lowp float base\r\n    #pragma mapbox: initialize lowp float height\r\n    #pragma mapbox: initialize highp vec4 color\r\n\r\n    base = max(0.0, base);\r\n    height = max(0.0, height);\r\n\r\n    float ed = a_edgedistance; // use each attrib in order to not trip a VAO assert\r\n    float t = mod(a_normal.x, 2.0);\r\n\r\n    gl_Position = u_matrix * vec4(a_pos, t > 0.0 ? height : base, 1);\r\n\r\n    // Relative luminance (how dark/bright is the surface color?)\r\n    float colorvalue = color.r * 0.2126 + color.g * 0.7152 + color.b * 0.0722;\r\n\r\n    v_color = vec4(0.0, 0.0, 0.0, 1.0);\r\n\r\n    // Add slight ambient lighting so no extrusions are totally black\r\n    vec4 ambientlight = vec4(0.03, 0.03, 0.03, 1.0);\r\n    color += ambientlight;\r\n\r\n    // Calculate cos(theta), where theta is the angle between surface normal and diffuse light ray\r\n    float directional = clamp(dot(a_normal / 16384.0, u_lightpos), 0.0, 1.0);\r\n\r\n    // Adjust directional so that\r\n    // the range of values for highlight/shading is narrower\r\n    // with lower light intensity\r\n    // and with lighter/brighter surface colors\r\n    directional = mix((1.0 - u_lightintensity), max((1.0 - colorvalue + u_lightintensity), 1.0), directional);\r\n\r\n    // Add gradient along z axis of side surfaces\r\n    if (a_normal.y != 0.0) {\r\n        directional *= clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0);\r\n    }\r\n\r\n    // Assign final color based on surface + ambient light color, diffuse light directional, and light color\r\n    // with lower bounds adjusted to hue of light\r\n    // so that shading is tinted with the complementary (opposite) color to the light color\r\n    v_color.r += clamp(color.r * directional * u_lightcolor.r, mix(0.0, 0.3, 1.0 - u_lightcolor.r), 1.0);\r\n    v_color.g += clamp(color.g * directional * u_lightcolor.g, mix(0.0, 0.3, 1.0 - u_lightcolor.g), 1.0);\r\n    v_color.b += clamp(color.b * directional * u_lightcolor.b, mix(0.0, 0.3, 1.0 - u_lightcolor.b), 1.0);\r\n}\r\n"},
fillExtrusionPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\r\nuniform vec2 u_pattern_br_a;\r\nuniform vec2 u_pattern_tl_b;\r\nuniform vec2 u_pattern_br_b;\r\nuniform vec2 u_texsize;\r\nuniform float u_mix;\r\n\r\nuniform sampler2D u_image;\r\n\r\nvarying vec2 v_pos_a;\r\nvarying vec2 v_pos_b;\r\nvarying vec4 v_lighting;\r\n\r\n#pragma mapbox: define lowp float base\r\n#pragma mapbox: define lowp float height\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize lowp float base\r\n    #pragma mapbox: initialize lowp float height\r\n\r\n    vec2 imagecoord = mod(v_pos_a, 1.0);\r\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\r\n    vec4 color1 = texture2D(u_image, pos);\r\n\r\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\r\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\r\n    vec4 color2 = texture2D(u_image, pos2);\r\n\r\n    vec4 mixedColor = mix(color1, color2, u_mix);\r\n\r\n    gl_FragColor = mixedColor * v_lighting;\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",
vertexSource:"uniform mat4 u_matrix;\r\nuniform vec2 u_pattern_size_a;\r\nuniform vec2 u_pattern_size_b;\r\nuniform vec2 u_pixel_coord_upper;\r\nuniform vec2 u_pixel_coord_lower;\r\nuniform float u_scale_a;\r\nuniform float u_scale_b;\r\nuniform float u_tile_units_to_pixels;\r\nuniform float u_height_factor;\r\n\r\nuniform vec3 u_lightcolor;\r\nuniform lowp vec3 u_lightpos;\r\nuniform lowp float u_lightintensity;\r\n\r\nattribute vec2 a_pos;\r\nattribute vec3 a_normal;\r\nattribute float a_edgedistance;\r\n\r\nvarying vec2 v_pos_a;\r\nvarying vec2 v_pos_b;\r\nvarying vec4 v_lighting;\r\nvarying float v_directional;\r\n\r\n#pragma mapbox: define lowp float base\r\n#pragma mapbox: define lowp float height\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize lowp float base\r\n    #pragma mapbox: initialize lowp float height\r\n\r\n    base = max(0.0, base);\r\n    height = max(0.0, height);\r\n\r\n    float t = mod(a_normal.x, 2.0);\r\n    float z = t > 0.0 ? height : base;\r\n\r\n    gl_Position = u_matrix * vec4(a_pos, z, 1);\r\n\r\n    vec2 pos = a_normal.x == 1.0 && a_normal.y == 0.0 && a_normal.z == 16384.0\r\n        ? a_pos // extrusion top\r\n        : vec2(a_edgedistance, z * u_height_factor); // extrusion side\r\n\r\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, pos);\r\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, pos);\r\n\r\n    v_lighting = vec4(0.0, 0.0, 0.0, 1.0);\r\n    float directional = clamp(dot(a_normal / 16383.0, u_lightpos), 0.0, 1.0);\r\n    directional = mix((1.0 - u_lightintensity), max((0.5 + u_lightintensity), 1.0), directional);\r\n\r\n    if (a_normal.y != 0.0) {\r\n        directional *= clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0);\r\n    }\r\n\r\n    v_lighting.rgb += clamp(directional * u_lightcolor, mix(vec3(0.0), vec3(0.3), 1.0 - u_lightcolor), vec3(1.0));\r\n}\r\n"},
extrusionTexture:{fragmentSource:"uniform sampler2D u_image;\r\nuniform float u_opacity;\r\nvarying vec2 v_pos;\r\n\r\nvoid main() {\r\n    gl_FragColor = texture2D(u_image, v_pos) * u_opacity;\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(0.0);\r\n#endif\r\n}\r\n",vertexSource:"uniform mat4 u_matrix;\r\nuniform vec2 u_world;\r\nattribute vec2 a_pos;\r\nvarying vec2 v_pos;\r\n\r\nvoid main() {\r\n    gl_Position = u_matrix * vec4(a_pos * u_world, 0, 1);\r\n\r\n    v_pos.x = a_pos.x;\r\n    v_pos.y = 1.0 - a_pos.y;\r\n}\r\n"},
line:{fragmentSource:"#pragma mapbox: define highp vec4 color\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\n\r\nvarying vec2 v_width2;\r\nvarying vec2 v_normal;\r\nvarying float v_gamma_scale;\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize highp vec4 color\r\n    #pragma mapbox: initialize lowp float blur\r\n    #pragma mapbox: initialize lowp float opacity\r\n\r\n    // Calculate the distance of the pixel from the line in pixels.\r\n    float dist = length(v_normal) * v_width2.s;\r\n\r\n    // Calculate the antialiasing fade factor. This is either when fading in\r\n    // the line in case of an offset line (v_width2.t) or when fading out\r\n    // (v_width2.s)\r\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\r\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\r\n\r\n    gl_FragColor = color * (alpha * opacity);\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",
vertexSource:"\r\n\r\n// the distance over which the line edge fades out.\r\n// Retina devices need a smaller distance to avoid aliasing.\r\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\r\n\r\n// floor(127 / 2) == 63.0\r\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\r\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\r\n// there are also \"special\" normals that have a bigger length (of up to 126 in\r\n// this case).\r\n// #define scale 63.0\r\n#define scale 0.015873016\r\n\r\nattribute vec2 a_pos;\r\nattribute vec4 a_data;\r\n\r\nuniform mat4 u_matrix;\r\nuniform mediump float u_ratio;\r\nuniform mediump float u_width;\r\nuniform vec2 u_gl_units_to_pixels;\r\n\r\nvarying vec2 v_normal;\r\nvarying vec2 v_width2;\r\nvarying float v_gamma_scale;\r\n\r\n#pragma mapbox: define highp vec4 color\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define mediump float gapwidth\r\n#pragma mapbox: define lowp float offset\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize highp vec4 color\r\n    #pragma mapbox: initialize lowp float blur\r\n    #pragma mapbox: initialize lowp float opacity\r\n    #pragma mapbox: initialize mediump float gapwidth\r\n    #pragma mapbox: initialize lowp float offset\r\n\r\n    vec2 a_extrude = a_data.xy - 128.0;\r\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\r\n\r\n    // We store the texture normals in the most insignificant bit\r\n    // transform y so that 0 => -1 and 1 => 1\r\n    // In the texture normal, x is 0 if the normal points straight up/down and 1 if it's a round cap\r\n    // y is 1 if the normal points up, and -1 if it points down\r\n    mediump vec2 normal = mod(a_pos, 2.0);\r\n    normal.y = sign(normal.y - 0.5);\r\n    v_normal = normal;\r\n\r\n\r\n    // these transformations used to be applied in the JS and native code bases. \r\n    // moved them into the shader for clarity and simplicity. \r\n    gapwidth = gapwidth / 2.0;\r\n    float width = u_width / 2.0;\r\n    offset = -1.0 * offset; \r\n\r\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\r\n    float outset = gapwidth + width * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\r\n\r\n    // Scale the extrusion vector down to a normal and then up by the line width\r\n    // of this vertex.\r\n    mediump vec2 dist = outset * a_extrude * scale;\r\n\r\n    // Calculate the offset when drawing a line that is to the side of the actual line.\r\n    // We do this by creating a vector that points towards the extrude, but rotate\r\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\r\n    // extrude vector points in another direction.\r\n    mediump float u = 0.5 * a_direction;\r\n    mediump float t = 1.0 - abs(u);\r\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\r\n\r\n    // Remove the texture normal bit to get the position\r\n    vec2 pos = floor(a_pos * 0.5);\r\n\r\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\r\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\r\n\r\n    // calculate how much the perspective view squishes or stretches the extrude\r\n    float extrude_length_without_perspective = length(dist);\r\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\r\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\r\n\r\n    v_width2 = vec2(outset, inset);\r\n}\r\n"},
linePattern:{fragmentSource:"uniform vec2 u_pattern_size_a;\r\nuniform vec2 u_pattern_size_b;\r\nuniform vec2 u_pattern_tl_a;\r\nuniform vec2 u_pattern_br_a;\r\nuniform vec2 u_pattern_tl_b;\r\nuniform vec2 u_pattern_br_b;\r\nuniform vec2 u_texsize;\r\nuniform float u_fade;\r\n\r\nuniform sampler2D u_image;\r\n\r\nvarying vec2 v_normal;\r\nvarying vec2 v_width2;\r\nvarying float v_linesofar;\r\nvarying float v_gamma_scale;\r\n\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize lowp float blur\r\n    #pragma mapbox: initialize lowp float opacity\r\n\r\n    // Calculate the distance of the pixel from the line in pixels.\r\n    float dist = length(v_normal) * v_width2.s;\r\n\r\n    // Calculate the antialiasing fade factor. This is either when fading in\r\n    // the line in case of an offset line (v_width2.t) or when fading out\r\n    // (v_width2.s)\r\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\r\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\r\n\r\n    float x_a = mod(v_linesofar / u_pattern_size_a.x, 1.0);\r\n    float x_b = mod(v_linesofar / u_pattern_size_b.x, 1.0);\r\n    float y_a = 0.5 + (v_normal.y * v_width2.s / u_pattern_size_a.y);\r\n    float y_b = 0.5 + (v_normal.y * v_width2.s / u_pattern_size_b.y);\r\n    vec2 pos_a = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, vec2(x_a, y_a));\r\n    vec2 pos_b = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, vec2(x_b, y_b));\r\n\r\n    vec4 color = mix(texture2D(u_image, pos_a), texture2D(u_image, pos_b), u_fade);\r\n\r\n    gl_FragColor = color * alpha * opacity;\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",
vertexSource:"// floor(127 / 2) == 63.0\r\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\r\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\r\n// there are also \"special\" normals that have a bigger length (of up to 126 in\r\n// this case).\r\n// #define scale 63.0\r\n#define scale 0.015873016\r\n\r\n// We scale the distance before adding it to the buffers so that we can store\r\n// long distances for long segments. Use this value to unscale the distance.\r\n#define LINE_DISTANCE_SCALE 2.0\r\n\r\n// the distance over which the line edge fades out.\r\n// Retina devices need a smaller distance to avoid aliasing.\r\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\r\n\r\nattribute vec2 a_pos;\r\nattribute vec4 a_data;\r\n\r\nuniform mat4 u_matrix;\r\nuniform mediump float u_ratio;\r\nuniform mediump float u_width;\r\nuniform vec2 u_gl_units_to_pixels;\r\n\r\nvarying vec2 v_normal;\r\nvarying vec2 v_width2;\r\nvarying float v_linesofar;\r\nvarying float v_gamma_scale;\r\n\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define lowp float offset\r\n#pragma mapbox: define mediump float gapwidth\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize lowp float blur\r\n    #pragma mapbox: initialize lowp float opacity\r\n    #pragma mapbox: initialize lowp float offset\r\n    #pragma mapbox: initialize mediump float gapwidth\r\n\r\n    vec2 a_extrude = a_data.xy - 128.0;\r\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\r\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\r\n\r\n    // We store the texture normals in the most insignificant bit\r\n    // transform y so that 0 => -1 and 1 => 1\r\n    // In the texture normal, x is 0 if the normal points straight up/down and 1 if it's a round cap\r\n    // y is 1 if the normal points up, and -1 if it points down\r\n    mediump vec2 normal = mod(a_pos, 2.0);\r\n    normal.y = sign(normal.y - 0.5);\r\n    v_normal = normal;\r\n\r\n    // these transformations used to be applied in the JS and native code bases. \r\n    // moved them into the shader for clarity and simplicity. \r\n    gapwidth = gapwidth / 2.0;\r\n    float width = u_width / 2.0;\r\n    offset = -1.0 * offset; \r\n\r\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\r\n    float outset = gapwidth + width * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\r\n\r\n    // Scale the extrusion vector down to a normal and then up by the line width\r\n    // of this vertex.\r\n    mediump vec2 dist = outset * a_extrude * scale;\r\n\r\n    // Calculate the offset when drawing a line that is to the side of the actual line.\r\n    // We do this by creating a vector that points towards the extrude, but rotate\r\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\r\n    // extrude vector points in another direction.\r\n    mediump float u = 0.5 * a_direction;\r\n    mediump float t = 1.0 - abs(u);\r\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\r\n\r\n    // Remove the texture normal bit to get the position\r\n    vec2 pos = floor(a_pos * 0.5);\r\n\r\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\r\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\r\n\r\n    // calculate how much the perspective view squishes or stretches the extrude\r\n    float extrude_length_without_perspective = length(dist);\r\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\r\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\r\n\r\n    v_linesofar = a_linesofar;\r\n    v_width2 = vec2(outset, inset);\r\n}\r\n"},
lineSDF:{fragmentSource:"\r\nuniform sampler2D u_image;\r\nuniform float u_sdfgamma;\r\nuniform float u_mix;\r\n\r\nvarying vec2 v_normal;\r\nvarying vec2 v_width2;\r\nvarying vec2 v_tex_a;\r\nvarying vec2 v_tex_b;\r\nvarying float v_gamma_scale;\r\n\r\n#pragma mapbox: define highp vec4 color\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize highp vec4 color\r\n    #pragma mapbox: initialize lowp float blur\r\n    #pragma mapbox: initialize lowp float opacity\r\n\r\n    // Calculate the distance of the pixel from the line in pixels.\r\n    float dist = length(v_normal) * v_width2.s;\r\n\r\n    // Calculate the antialiasing fade factor. This is either when fading in\r\n    // the line in case of an offset line (v_width2.t) or when fading out\r\n    // (v_width2.s)\r\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\r\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\r\n\r\n    float sdfdist_a = texture2D(u_image, v_tex_a).a;\r\n    float sdfdist_b = texture2D(u_image, v_tex_b).a;\r\n    float sdfdist = mix(sdfdist_a, sdfdist_b, u_mix);\r\n    alpha *= smoothstep(0.5 - u_sdfgamma, 0.5 + u_sdfgamma, sdfdist);\r\n\r\n    gl_FragColor = color * (alpha * opacity);\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",
vertexSource:"// floor(127 / 2) == 63.0\r\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\r\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\r\n// there are also \"special\" normals that have a bigger length (of up to 126 in\r\n// this case).\r\n// #define scale 63.0\r\n#define scale 0.015873016\r\n\r\n// We scale the distance before adding it to the buffers so that we can store\r\n// long distances for long segments. Use this value to unscale the distance.\r\n#define LINE_DISTANCE_SCALE 2.0\r\n\r\n// the distance over which the line edge fades out.\r\n// Retina devices need a smaller distance to avoid aliasing.\r\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\r\n\r\nattribute vec2 a_pos;\r\nattribute vec4 a_data;\r\n\r\nuniform mat4 u_matrix;\r\nuniform mediump float u_ratio;\r\nuniform vec2 u_patternscale_a;\r\nuniform float u_tex_y_a;\r\nuniform vec2 u_patternscale_b;\r\nuniform float u_tex_y_b;\r\nuniform vec2 u_gl_units_to_pixels;\r\nuniform mediump float u_width;\r\n\r\nvarying vec2 v_normal;\r\nvarying vec2 v_width2;\r\nvarying vec2 v_tex_a;\r\nvarying vec2 v_tex_b;\r\nvarying float v_gamma_scale;\r\n\r\n#pragma mapbox: define highp vec4 color\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define mediump float gapwidth\r\n#pragma mapbox: define lowp float offset\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize highp vec4 color\r\n    #pragma mapbox: initialize lowp float blur\r\n    #pragma mapbox: initialize lowp float opacity\r\n    #pragma mapbox: initialize mediump float gapwidth\r\n    #pragma mapbox: initialize lowp float offset\r\n\r\n    vec2 a_extrude = a_data.xy - 128.0;\r\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\r\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\r\n\r\n    // We store the texture normals in the most insignificant bit\r\n    // transform y so that 0 => -1 and 1 => 1\r\n    // In the texture normal, x is 0 if the normal points straight up/down and 1 if it's a round cap\r\n    // y is 1 if the normal points up, and -1 if it points down\r\n    mediump vec2 normal = mod(a_pos, 2.0);\r\n    normal.y = sign(normal.y - 0.5);\r\n    v_normal = normal;\r\n\r\n    // these transformations used to be applied in the JS and native code bases. \r\n    // moved them into the shader for clarity and simplicity. \r\n    gapwidth = gapwidth / 2.0;\r\n    float width = u_width / 2.0;\r\n    offset = -1.0 * offset;\r\n \r\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\r\n    float outset = gapwidth + width * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\r\n\r\n    // Scale the extrusion vector down to a normal and then up by the line width\r\n    // of this vertex.\r\n    mediump vec2 dist =outset * a_extrude * scale;\r\n\r\n    // Calculate the offset when drawing a line that is to the side of the actual line.\r\n    // We do this by creating a vector that points towards the extrude, but rotate\r\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\r\n    // extrude vector points in another direction.\r\n    mediump float u = 0.5 * a_direction;\r\n    mediump float t = 1.0 - abs(u);\r\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\r\n\r\n    // Remove the texture normal bit to get the position\r\n    vec2 pos = floor(a_pos * 0.5);\r\n\r\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\r\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\r\n\r\n    // calculate how much the perspective view squishes or stretches the extrude\r\n    float extrude_length_without_perspective = length(dist);\r\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\r\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\r\n\r\n    v_tex_a = vec2(a_linesofar * u_patternscale_a.x, normal.y * u_patternscale_a.y + u_tex_y_a);\r\n    v_tex_b = vec2(a_linesofar * u_patternscale_b.x, normal.y * u_patternscale_b.y + u_tex_y_b);\r\n\r\n    v_width2 = vec2(outset, inset);\r\n}\r\n"},
raster:{fragmentSource:"uniform float u_fade_t;\r\nuniform float u_opacity;\r\nuniform sampler2D u_image0;\r\nuniform sampler2D u_image1;\r\nvarying vec2 v_pos0;\r\nvarying vec2 v_pos1;\r\n\r\nuniform float u_brightness_low;\r\nuniform float u_brightness_high;\r\n\r\nuniform float u_saturation_factor;\r\nuniform float u_contrast_factor;\r\nuniform vec3 u_spin_weights;\r\n\r\nvoid main() {\r\n\r\n    // read and cross-fade colors from the main and parent tiles\r\n    vec4 color0 = texture2D(u_image0, v_pos0);\r\n    vec4 color1 = texture2D(u_image1, v_pos1);\r\n    vec4 color = mix(color0, color1, u_fade_t);\r\n    color.a *= u_opacity;\r\n    vec3 rgb = color.rgb;\r\n\r\n    // spin\r\n    rgb = vec3(\r\n        dot(rgb, u_spin_weights.xyz),\r\n        dot(rgb, u_spin_weights.zxy),\r\n        dot(rgb, u_spin_weights.yzx));\r\n\r\n    // saturation\r\n    float average = (color.r + color.g + color.b) / 3.0;\r\n    rgb += (average - rgb) * u_saturation_factor;\r\n\r\n    // contrast\r\n    rgb = (rgb - 0.5) * u_contrast_factor + 0.5;\r\n\r\n    // brightness\r\n    vec3 u_high_vec = vec3(u_brightness_low, u_brightness_low, u_brightness_low);\r\n    vec3 u_low_vec = vec3(u_brightness_high, u_brightness_high, u_brightness_high);\r\n\r\n    gl_FragColor = vec4(mix(u_high_vec, u_low_vec, rgb) * color.a, color.a);\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",
vertexSource:"uniform mat4 u_matrix;\r\nuniform vec2 u_tl_parent;\r\nuniform float u_scale_parent;\r\nuniform float u_buffer_scale;\r\n\r\nattribute vec2 a_pos;\r\nattribute vec2 a_texture_pos;\r\n\r\nvarying vec2 v_pos0;\r\nvarying vec2 v_pos1;\r\n\r\nvoid main() {\r\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\r\n    v_pos0 = (((a_texture_pos / 32767.0) - 0.5) / u_buffer_scale ) + 0.5;\r\n    v_pos1 = (v_pos0 * u_scale_parent) + u_tl_parent;\r\n}\r\n"},symbolIcon:{fragmentSource:"uniform sampler2D u_texture;\r\nuniform sampler2D u_fadetexture;\r\n\r\n#pragma mapbox: define lowp float opacity\r\n\r\nvarying vec2 v_tex;\r\nvarying vec2 v_fade_tex;\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize lowp float opacity\r\n\r\n    lowp float alpha = texture2D(u_fadetexture, v_fade_tex).a * opacity;\r\n    gl_FragColor = texture2D(u_texture, v_tex) * alpha;\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",
vertexSource:'attribute vec4 a_pos_offset;\r\nattribute vec2 a_label_pos;\r\nattribute vec4 a_data;\r\n\r\n// icon-size data (see symbol_sdf.vertex.glsl for more)\r\nattribute vec3 a_size;\r\nuniform bool u_is_size_zoom_constant;\r\nuniform bool u_is_size_feature_constant;\r\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\r\nuniform highp float u_size; // used when size is both zoom and feature constant\r\nuniform highp float u_layout_size; // used when size is feature constant\r\nuniform highp float u_camera_to_center_distance;\r\nuniform highp float u_pitch;\r\nuniform highp float u_collision_y_stretch;\r\n\r\n#pragma mapbox: define lowp float opacity\r\n\r\n// matrix is for the vertex position.\r\nuniform mat4 u_matrix;\r\n\r\nuniform bool u_is_text;\r\nuniform highp float u_zoom;\r\nuniform bool u_rotate_with_map;\r\nuniform vec2 u_extrude_scale;\r\n\r\nuniform vec2 u_texsize;\r\n\r\nvarying vec2 v_tex;\r\nvarying vec2 v_fade_tex;\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize lowp float opacity\r\n\r\n    vec2 a_pos = a_pos_offset.xy;\r\n    vec2 a_offset = a_pos_offset.zw;\r\n\r\n    vec2 a_tex = a_data.xy;\r\n    highp vec2 label_data = unpack_float(a_data[2]);\r\n    highp float a_labelminzoom = label_data[0];\r\n    highp vec2 a_zoom = unpack_float(a_data[3]);\r\n    highp float a_minzoom = a_zoom[0];\r\n    highp float a_maxzoom = a_zoom[1];\r\n\r\n    float size;\r\n    // In order to accommodate placing labels around corners in\r\n    // symbol-placement: line, each glyph in a label could have multiple\r\n    // "quad"s only one of which should be shown at a given zoom level.\r\n    // The min/max zoom assigned to each quad is based on the font size at\r\n    // the vector tile\'s zoom level, which might be different than at the\r\n    // currently rendered zoom level if text-size is zoom-dependent.\r\n    // Thus, we compensate for this difference by calculating an adjustment\r\n    // based on the scale of rendered text size relative to layout text size.\r\n    highp float layoutSize;\r\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\r\n        size = mix(a_size[0], a_size[1], u_size_t) / 10.0;\r\n        layoutSize = a_size[2] / 10.0;\r\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\r\n        size = a_size[0] / 10.0;\r\n        layoutSize = size;\r\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\r\n        size = u_size;\r\n        layoutSize = u_layout_size;\r\n    } else {\r\n        size = u_size;\r\n        layoutSize = u_size;\r\n    }\r\n\r\n    float fontScale = u_is_text ? size / 24.0 : size;\r\n\r\n    highp float zoomAdjust = log2(size / layoutSize);\r\n    highp float adjustedZoom = (u_zoom - zoomAdjust) * 10.0;\r\n    // result: z = 0 if a_minzoom <= adjustedZoom < a_maxzoom, and 1 otherwise\r\n    highp float z = 2.0 - step(a_minzoom, adjustedZoom) - (1.0 - step(a_maxzoom, adjustedZoom));\r\n\r\n    vec4 projectedPoint = u_matrix * vec4(a_label_pos, 0, 1);\r\n    highp float camera_to_anchor_distance = projectedPoint.w;\r\n    highp float perspective_ratio = 1.0 + 0.5*((camera_to_anchor_distance / u_camera_to_center_distance) - 1.0);\r\n\r\n    vec2 extrude = fontScale * u_extrude_scale * perspective_ratio * (a_offset / 64.0);\r\n    if (u_rotate_with_map) {\r\n        gl_Position = u_matrix * vec4(a_pos + extrude, 0, 1);\r\n        gl_Position.z += z * gl_Position.w;\r\n    } else {\r\n        gl_Position = u_matrix * vec4(a_pos, 0, 1) + vec4(extrude, 0, 0);\r\n    }\r\n\r\n    v_tex = a_tex / u_texsize;\r\n    // See comments in symbol_sdf.vertex\r\n    highp float incidence_stretch  = camera_to_anchor_distance / (u_camera_to_center_distance * cos(u_pitch));\r\n    highp float collision_adjustment = max(1.0, incidence_stretch / u_collision_y_stretch);\r\n\r\n    highp float perspective_zoom_adjust = floor(log2(perspective_ratio * collision_adjustment) * 10.0);\r\n    v_fade_tex = vec2((a_labelminzoom + perspective_zoom_adjust) / 255.0, 0.0);\r\n}\r\n'},
symbolSDF:{fragmentSource:"#define SDF_PX 8.0\r\n#define EDGE_GAMMA 0.105/DEVICE_PIXEL_RATIO\r\n\r\nuniform bool u_is_halo;\r\n#pragma mapbox: define highp vec4 fill_color\r\n#pragma mapbox: define highp vec4 halo_color\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define lowp float halo_width\r\n#pragma mapbox: define lowp float halo_blur\r\n\r\nuniform sampler2D u_texture;\r\nuniform sampler2D u_fadetexture;\r\nuniform highp float u_gamma_scale;\r\nuniform bool u_is_text;\r\n\r\nvarying vec2 v_tex;\r\nvarying vec2 v_fade_tex;\r\nvarying float v_gamma_scale;\r\nvarying float v_size;\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize highp vec4 fill_color\r\n    #pragma mapbox: initialize highp vec4 halo_color\r\n    #pragma mapbox: initialize lowp float opacity\r\n    #pragma mapbox: initialize lowp float halo_width\r\n    #pragma mapbox: initialize lowp float halo_blur\r\n\r\n    float fontScale = u_is_text ? v_size / 24.0 : v_size;\r\n\r\n    lowp vec4 color = fill_color;\r\n    highp float gamma = EDGE_GAMMA / (fontScale * u_gamma_scale);\r\n    lowp float buff = (256.0 - 64.0) / 256.0;\r\n    if (u_is_halo) {\r\n        color = halo_color;\r\n        gamma = (halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (fontScale * u_gamma_scale);\r\n        buff = (6.0 - halo_width / fontScale) / SDF_PX;\r\n    }\r\n\r\n    lowp float dist = texture2D(u_texture, v_tex).a;\r\n    lowp float fade_alpha = texture2D(u_fadetexture, v_fade_tex).a;\r\n    highp float gamma_scaled = gamma * v_gamma_scale;\r\n    highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist) * fade_alpha;\r\n\r\n    gl_FragColor = color * (alpha * opacity);\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",
vertexSource:"const float PI = 3.141592653589793;\r\n\r\n// NOTE: the a_data attribute in this shader is manually bound (see https://github.com/mapbox/mapbox-gl-js/issues/4607).\r\n// If removing or renaming a_data, revisit the manual binding in painter.js accordingly.\r\nattribute vec4 a_pos_offset;\r\nattribute vec2 a_label_pos;\r\nattribute vec4 a_data;\r\n\r\n// contents of a_size vary based on the type of property value\r\n// used for {text,icon}-size.\r\n// For constants, a_size is disabled.\r\n// For source functions, we bind only one value per vertex: the value of {text,icon}-size evaluated for the current feature.\r\n// For composite functions:\r\n// [ text-size(lowerZoomStop, feature),\r\n//   text-size(upperZoomStop, feature),\r\n//   layoutSize == text-size(layoutZoomLevel, feature) ]\r\nattribute vec3 a_size;\r\nuniform bool u_is_size_zoom_constant;\r\nuniform bool u_is_size_feature_constant;\r\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\r\nuniform highp float u_size; // used when size is both zoom and feature constant\r\nuniform highp float u_layout_size; // used when size is feature constant\r\n\r\n#pragma mapbox: define highp vec4 fill_color\r\n#pragma mapbox: define highp vec4 halo_color\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define lowp float halo_width\r\n#pragma mapbox: define lowp float halo_blur\r\n\r\n// matrix is for the vertex position.\r\nuniform mat4 u_matrix;\r\n\r\nuniform bool u_is_text;\r\nuniform highp float u_zoom;\r\nuniform bool u_rotate_with_map;\r\nuniform bool u_pitch_with_map;\r\nuniform highp float u_pitch;\r\nuniform highp float u_bearing;\r\nuniform highp float u_aspect_ratio;\r\nuniform highp float u_camera_to_center_distance;\r\nuniform highp float u_max_camera_distance;\r\nuniform highp float u_collision_y_stretch;\r\nuniform vec2 u_extrude_scale;\r\n\r\nuniform vec2 u_texsize;\r\n\r\nvarying vec2 v_tex;\r\nvarying vec2 v_fade_tex;\r\nvarying float v_gamma_scale;\r\nvarying float v_size;\r\n\r\n// Used below to move the vertex out of the clip space for when the current\r\n// zoom is out of the glyph's zoom range.\r\nhighp float clipUnusedGlyphAngles(const highp float render_size,\r\n                                  const highp float layout_size,\r\n                                  const highp float min_zoom,\r\n                                  const highp float max_zoom) {\r\n    highp float zoom_adjust = log2(render_size / layout_size);\r\n    highp float adjusted_zoom = (u_zoom - zoom_adjust) * 10.0;\r\n    // result: 0 if min_zoom <= adjusted_zoom < max_zoom, and 1 otherwise\r\n    return 2.0 - step(min_zoom, adjusted_zoom) - (1.0 - step(max_zoom, adjusted_zoom));\r\n}\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize highp vec4 fill_color\r\n    #pragma mapbox: initialize highp vec4 halo_color\r\n    #pragma mapbox: initialize lowp float opacity\r\n    #pragma mapbox: initialize lowp float halo_width\r\n    #pragma mapbox: initialize lowp float halo_blur\r\n\r\n    vec2 a_pos = a_pos_offset.xy;\r\n    vec2 a_offset = a_pos_offset.zw;\r\n\r\n    vec2 a_tex = a_data.xy;\r\n\r\n    highp vec2 label_data = unpack_float(a_data[2]);\r\n    highp float a_labelminzoom = label_data[0];\r\n    highp float a_lineangle = (label_data[1] / 256.0 * 2.0 * PI);\r\n    highp vec2 a_zoom = unpack_float(a_data[3]);\r\n    highp float a_minzoom = a_zoom[0];\r\n    highp float a_maxzoom = a_zoom[1];\r\n\r\n    // In order to accommodate placing labels around corners in\r\n    // symbol-placement: line, each glyph in a label could have multiple\r\n    // \"quad\"s only one of which should be shown at a given zoom level.\r\n    // The min/max zoom assigned to each quad is based on the font size at\r\n    // the vector tile's zoom level, which might be different than at the\r\n    // currently rendered zoom level if text-size is zoom-dependent.\r\n    // Thus, we compensate for this difference by calculating an adjustment\r\n    // based on the scale of rendered text size relative to layout text size.\r\n    highp float layoutSize;\r\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\r\n        v_size = mix(a_size[0], a_size[1], u_size_t) / 10.0;\r\n        layoutSize = a_size[2] / 10.0;\r\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\r\n        v_size = a_size[0] / 10.0;\r\n        layoutSize = v_size;\r\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\r\n        v_size = u_size;\r\n        layoutSize = u_layout_size;\r\n    } else {\r\n        v_size = u_size;\r\n        layoutSize = u_size;\r\n    }\r\n\r\n    float fontScale = u_is_text ? v_size / 24.0 : v_size;\r\n\r\n    vec4 projectedPoint = u_matrix * vec4(a_label_pos, 0, 1);\r\n    highp float camera_to_anchor_distance = projectedPoint.w;\r\n    highp float perspective_ratio = 1.0 + 0.5*((camera_to_anchor_distance / u_camera_to_center_distance) - 1.0);\r\n\r\n    // pitch-alignment: map\r\n    // rotation-alignment: map | viewport\r\n    if (u_pitch_with_map) {\r\n        highp float angle = u_rotate_with_map ? a_lineangle : u_bearing;\r\n        highp float asin = sin(angle);\r\n        highp float acos = cos(angle);\r\n        mat2 RotationMatrix = mat2(acos, asin, -1.0 * asin, acos);\r\n        vec2 offset = RotationMatrix * a_offset;\r\n        vec2 extrude = fontScale * u_extrude_scale * perspective_ratio * (offset / 64.0);\r\n\r\n        gl_Position = u_matrix * vec4(a_pos + extrude, 0, 1);\r\n        gl_Position.z += clipUnusedGlyphAngles(v_size*perspective_ratio, layoutSize, a_minzoom, a_maxzoom) * gl_Position.w;\r\n    // pitch-alignment: viewport\r\n    // rotation-alignment: map\r\n    } else if (u_rotate_with_map) {\r\n        // foreshortening factor to apply on pitched maps\r\n        // as a label goes from horizontal <=> vertical in angle\r\n        // it goes from 0% foreshortening to up to around 70% foreshortening\r\n        highp float pitchfactor = 1.0 - cos(u_pitch * sin(u_pitch * 0.75));\r\n\r\n        // use the lineangle to position points a,b along the line\r\n        // project the points and calculate the label angle in projected space\r\n        // this calculation allows labels to be rendered unskewed on pitched maps\r\n        vec4 a = u_matrix * vec4(a_pos, 0, 1);\r\n        vec4 b = u_matrix * vec4(a_pos + vec2(cos(a_lineangle), sin(a_lineangle)), 0, 1);\r\n        highp float angle = atan((b[1] / b[3] - a[1] / a[3]) / u_aspect_ratio, b[0] / b[3] - a[0] / a[3]);\r\n        highp float asin = sin(angle);\r\n        highp float acos = cos(angle);\r\n        mat2 RotationMatrix = mat2(acos, -1.0 * asin, asin, acos);\r\n        highp float foreshortening = (1.0 - pitchfactor) + (pitchfactor * cos(angle * 2.0));\r\n\r\n        vec2 offset = RotationMatrix * (vec2(foreshortening, 1.0) * a_offset);\r\n        vec2 extrude = fontScale * u_extrude_scale * perspective_ratio * (offset / 64.0);\r\n\r\n        gl_Position = u_matrix * vec4(a_pos, 0, 1) + vec4(extrude, 0, 0);\r\n        gl_Position.z += clipUnusedGlyphAngles(v_size * perspective_ratio, layoutSize, a_minzoom, a_maxzoom) * gl_Position.w;\r\n    // pitch-alignment: viewport\r\n    // rotation-alignment: viewport\r\n    } else {\r\n        vec2 extrude = fontScale * u_extrude_scale * perspective_ratio * (a_offset / 64.0);\r\n        gl_Position = u_matrix * vec4(a_pos, 0, 1) + vec4(extrude, 0, 0);\r\n    }\r\n\r\n    gl_Position.z +=\r\n        step(u_max_camera_distance * u_camera_to_center_distance, camera_to_anchor_distance) * gl_Position.w;\r\n\r\n    v_gamma_scale = gl_Position.w / perspective_ratio;\r\n\r\n    v_tex = a_tex / u_texsize;\r\n    // incidence_stretch is the ratio of how much y space a label takes up on a tile while drawn perpendicular to the viewport vs\r\n    //  how much space it would take up if it were drawn flat on the tile\r\n    // Using law of sines, camera_to_anchor/sin(ground_angle) = camera_to_center/sin(incidence_angle)\r\n    // sin(incidence_angle) = 1/incidence_stretch\r\n    // Incidence angle 90 -> head on, sin(incidence_angle) = 1, no incidence stretch\r\n    // Incidence angle 1 -> very oblique, sin(incidence_angle) =~ 0, lots of incidence stretch\r\n    // ground_angle = u_pitch + PI/2 -> sin(ground_angle) = cos(u_pitch)\r\n    // This 2D calculation is only exactly correct when gl_Position.x is in the center of the viewport,\r\n    //  but it's a close enough approximation for our purposes\r\n    highp float incidence_stretch  = camera_to_anchor_distance / (u_camera_to_center_distance * cos(u_pitch));\r\n    // incidence_stretch only applies to the y-axis, but without re-calculating the collision tile, we can't\r\n    // adjust the size of only one axis. So, we do a crude approximation at placement time to get the aspect ratio\r\n    // about right, and then do the rest of the adjustment here: there will be some extra padding on the x-axis,\r\n    // but hopefully not too much.\r\n    // Never make the adjustment less than 1.0: instead of allowing collisions on the x-axis, be conservative on\r\n    // the y-axis.\r\n    highp float collision_adjustment = max(1.0, incidence_stretch / u_collision_y_stretch);\r\n\r\n    // Floor to 1/10th zoom to dodge precision issues that can cause partially hidden labels\r\n    highp float perspective_zoom_adjust = floor(log2(perspective_ratio * collision_adjustment) * 10.0);\r\n    v_fade_tex = vec2((a_labelminzoom + perspective_zoom_adjust) / 255.0, 0.0);\r\n}\r\n"},
normal:{fragmentSource:"uniform float u_fade_t;\r\nuniform float u_opacity;\r\nuniform sampler2D u_image0;\r\nuniform sampler2D u_image1;\r\nvarying vec2 v_pos0;\r\nvarying vec2 v_pos1;\r\n\r\nuniform float u_brightness_low;\r\nuniform float u_brightness_high;\r\n\r\nuniform float u_saturation_factor;\r\nuniform float u_contrast_factor;\r\nuniform vec3 u_spin_weights;\r\n\r\nuniform vec3 u_lightcolor;\r\nuniform lowp vec3 u_lightpos;\r\nuniform lowp float u_lightintensity;\r\n\r\nvoid main() {\r\n\r\n    // read and cross-fade colors from the main and parent tiles\r\n    vec4 color0 = texture2D(u_image0, v_pos0);\r\n    vec4 color1 = texture2D(u_image1, v_pos1);\r\n    vec3 normalC = mix(color0, color1, u_fade_t).xyz;\r\n    vec3 normal = (normalC * 2.) - 1.;\r\n    \r\n    vec4 v_lighting = vec4(0.0, 0.0, 0.0, 1.0);\r\n    float directional = clamp(dot(normal, u_lightpos), 0.0, 1.0);\r\n    directional = mix((1.0 - u_lightintensity), max((0.5 + u_lightintensity), 1.0), directional);\r\n    v_lighting.rgb += clamp(directional * u_lightcolor, mix(vec3(0.0), vec3(0.3), 1.0 - u_lightcolor), vec3(1.0));\r\n\r\n    vec4 color = vec4(v_lighting.rgb, u_opacity);\r\n    vec3 rgb = v_lighting.rgb;\r\n\r\n    // spin\r\n    rgb = vec3(\r\n        dot(rgb, u_spin_weights.xyz),\r\n        dot(rgb, u_spin_weights.zxy),\r\n        dot(rgb, u_spin_weights.yzx));\r\n\r\n    // saturation\r\n    float average = (color.r + color.g + color.b) / 3.0;\r\n    rgb += (average - rgb) * u_saturation_factor;\r\n\r\n    // contrast\r\n    rgb = (rgb - 0.5) * u_contrast_factor + 0.5;\r\n\r\n    // brightness\r\n    vec3 u_high_vec = vec3(u_brightness_low, u_brightness_low, u_brightness_low);\r\n    vec3 u_low_vec = vec3(u_brightness_high, u_brightness_high, u_brightness_high);\r\n\r\n    gl_FragColor = vec4(mix(u_high_vec, u_low_vec, rgb) * color.a, color.a);\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",
vertexSource:"uniform mat4 u_matrix;\r\nuniform vec2 u_tl_parent;\r\nuniform float u_scale_parent;\r\nuniform float u_buffer_scale;\r\n\r\nattribute vec2 a_pos;\r\nattribute vec2 a_texture_pos;\r\n\r\nvarying vec2 v_pos0;\r\nvarying vec2 v_pos1;\r\n\r\nvoid main() {\r\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\r\n    v_pos0 = (((a_texture_pos / 32767.0) - 0.5) / u_buffer_scale ) + 0.5;\r\n    v_pos1 = (v_pos0 * u_scale_parent) + u_tl_parent;\r\n}\r\n"}}},{}],81:[function(a,k,m){var f=a("assert");
a=function(){this.vao=this.boundVertexOffset=this.boundElementBuffer=this.boundVertexBuffer2=this.boundVertexBuffer=this.boundProgram=null};a.prototype.bind=function(a,f,l,c,g,h){void 0===a.extVertexArrayObject&&(a.extVertexArrayObject=a.getExtension("OES_vertex_array_object"));var e=!this.vao||this.boundProgram!==f||this.boundVertexBuffer!==l||this.boundVertexBuffer2!==g||this.boundElementBuffer!==c||this.boundVertexOffset!==h;!a.extVertexArrayObject||e?(this.freshBind(a,f,l,c,g,h),this.gl=a):a.extVertexArrayObject.bindVertexArrayOES(this.vao)};
a.prototype.freshBind=function(a,n,l,c,g,h){var e,b=n.numAttributes;if(a.extVertexArrayObject)this.vao&&this.destroy(),this.vao=a.extVertexArrayObject.createVertexArrayOES(),a.extVertexArrayObject.bindVertexArrayOES(this.vao),this.boundProgram=n,this.boundVertexBuffer=l,this.boundVertexBuffer2=g,this.boundElementBuffer=c,this.boundVertexOffset=h;else{e=a.currentNumAttributes||0;for(var d=b;d<e;d++)f(0!==d),a.disableVertexAttribArray(d)}l.enableAttributes(a,n);g&&g.enableAttributes(a,n);l.bind(a);
l.setVertexAttribPointers(a,n,h);g&&(g.bind(a),g.setVertexAttribPointers(a,n,h));c&&c.bind(a);a.currentNumAttributes=b};a.prototype.destroy=function(){this.vao&&(this.gl.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};k.exports=a},{assert:5}],82:[function(a,k,m){var f=a("../util/util");m.packUint8ToFloat=function(a,n){a=f.clamp(Math.floor(a),0,255);n=f.clamp(Math.floor(n),0,255);return 256*a+n}},{"../util/util":217}],83:[function(a,k,m){m=a("./image_source");var f=a("../util/window");
a=function(a){function d(d,c,f,h){a.call(this,d,c,f,h);this.options=c;this.animate=c.hasOwnProperty("animate")?c.animate:!0}a&&(d.__proto__=a);d.prototype=Object.create(a&&a.prototype);d.prototype.constructor=d;d.prototype.load=function(){this.canvas=this.canvas||f.document.getElementById(this.options.canvas);this.width=this.canvas.width;this.height=this.canvas.height;if(this._hasInvalidDimensions())return this.fire("error",Error("Canvas dimensions cannot be less than or equal to zero."));var a;this.play=
function(){a=this.map.style.animationLoop.set(Infinity);this.map._rerender()};this.pause=function(){this.map.style.animationLoop.cancel(a)};this._finishLoading()};d.prototype.getCanvas=function(){return this.canvas};d.prototype.onAdd=function(a){this.map||(this.map=a,this.load(),this.canvas&&this.animate&&this.play())};d.prototype.prepare=function(){var a=!1;this.canvas.width!==this.width&&(this.width=this.canvas.width,a=!0);this.canvas.height!==this.height&&(this.height=this.canvas.height,a=!0);
this._hasInvalidDimensions()||0!==Object.keys(this.tiles).length&&this._prepareImage(this.map.painter.gl,this.canvas,a)};d.prototype.serialize=function(){return{type:"canvas",canvas:this.canvas,coordinates:this.coordinates}};d.prototype._hasInvalidDimensions=function(){for(var a=0,c=[this.canvas.width,this.canvas.height];a<c.length;a+=1){var d=c[a];if(isNaN(d)||0>=d)return!0}return!1};return d}(m);k.exports=a},{"../util/window":198,"./image_source":87}],84:[function(a,k,m){function f(a){var c=n.document.createElement("a");
c.href=a;return c.href}m=a("../util/evented");var d=a("../util/util"),n=a("../util/window"),l=a("../data/extent");a=function(a){function c(c,e,b,f){a.call(this);e=e||{};this.id=c;this.type="geojson";this.minzoom=0;this.maxzoom=18;this.tileSize=512;this.reparseOverscaled=this.isTileClipped=!0;this.dispatcher=b;this.setEventedParent(f);this._data=e.data;void 0!==e.maxzoom&&(this.maxzoom=e.maxzoom);e.type&&(this.type=e.type);c=l/this.tileSize;this.workerOptions=d.extend({source:this.id,cluster:e.cluster||
!1,geojsonVtOptions:{buffer:(void 0!==e.buffer?e.buffer:128)*c,tolerance:(void 0!==e.tolerance?e.tolerance:.375)*c,extent:l,maxZoom:this.maxzoom},superclusterOptions:{maxZoom:Math.min(e.clusterMaxZoom,this.maxzoom-1)||this.maxzoom-1,extent:l,radius:(e.clusterRadius||50)*c,log:!1}},e.workerOptions)}a&&(c.__proto__=a);c.prototype=Object.create(a&&a.prototype);c.prototype.constructor=c;c.prototype.load=function(){var a=this;this.fire("dataloading",{dataType:"source"});this._updateWorkerData(function(c){c?
a.fire("error",{error:c}):a.fire("data",{dataType:"source",sourceDataType:"metadata"})})};c.prototype.onAdd=function(a){this.load();this.map=a};c.prototype.setData=function(a){var c=this;this._data=a;this.fire("dataloading",{dataType:"source"});this._updateWorkerData(function(b){if(b)return c.fire("error",{error:b});c.fire("data",{dataType:"source",sourceDataType:"content"})});return this};c.prototype._updateWorkerData=function(a){var c=this,b=d.extend({},this.workerOptions),g=this._data;"string"===
typeof g?b.url=f(g):b.data=JSON.stringify(g);this.workerID=this.dispatcher.send(this.type+".loadData",b,function(b){c._loaded=!0;a(b)})};c.prototype.loadTile=function(a,c){var b=this,e={type:this.type,uid:a.uid,coord:a.coord,zoom:a.coord.z,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,overscaling:a.coord.z>this.maxzoom?Math.pow(2,a.coord.z-this.maxzoom):1,angle:this.map.transform.angle,pitch:this.map.transform.pitch,cameraToCenterDistance:this.map.transform.cameraToCenterDistance,cameraToTileDistance:this.map.transform.cameraToTileDistance(a),
showCollisionBoxes:this.map.showCollisionBoxes};a.workerID=this.dispatcher.send("loadTile",e,function(e,d){a.unloadVectorData();if(!a.aborted){if(e)return c(e);a.loadVectorData(d,b.map.painter);a.redoWhenDone&&(a.redoWhenDone=!1,a.redoPlacement(b));return c(null)}},this.workerID)};c.prototype.abortTile=function(a){a.aborted=!0};c.prototype.unloadTile=function(a){a.unloadVectorData();this.dispatcher.send("removeTile",{uid:a.uid,type:this.type,source:this.id},function(){},a.workerID)};c.prototype.onRemove=
function(){this.dispatcher.broadcast("removeSource",{type:this.type,source:this.id},function(){})};c.prototype.serialize=function(){return{type:this.type,data:this._data}};return c}(m);k.exports=a},{"../data/extent":54,"../util/evented":204,"../util/util":217,"../util/window":198}],85:[function(a,k,m){var f=a("../util/ajax"),d=a("geojson-rewind"),n=a("./geojson_wrapper"),l=a("vt-pbf"),c=a("supercluster"),g=a("geojson-vt");a=function(a){function e(b,c,e){a.call(this,b,c);e&&(this.loadGeoJSON=e);this._geoJSONIndexes=
{}}a&&(e.__proto__=a);e.prototype=Object.create(a&&a.prototype);e.prototype.constructor=e;e.prototype.loadVectorData=function(b,a){var c=b.source,e=b.coord;if(!this._geoJSONIndexes[c])return a(null,null);c=this._geoJSONIndexes[c].getTile(Math.min(e.z,b.maxZoom),e.x,e.y);if(!c)return a(null,null);c=new n(c.features);c.name="_geojsonTileLayer";e=l({layers:{_geojsonTileLayer:c}});if(0!==e.byteOffset||e.byteLength!==e.buffer.byteLength)e=new Uint8Array(e);c.rawData=e.buffer;a(null,c)};e.prototype.loadData=
function(b,a){var c=function(c,e){var f=this;if(c)return a(c);if("object"!=typeof e)return a(Error("Input data is not a valid GeoJSON object."));d(e,!0);this._indexData(e,b,function(c,e){if(c)return a(c);f._geoJSONIndexes[b.source]=e;a(null)})}.bind(this);this.loadGeoJSON(b,c)};e.prototype.loadGeoJSON=function(b,a){if(b.url)f.getJSON(b.url,a);else if("string"===typeof b.data)try{return a(null,JSON.parse(b.data))}catch(q){return a(Error("Input data is not a valid GeoJSON object."))}else return a(Error("Input data is not a valid GeoJSON object."))};
e.prototype.removeSource=function(b){this._geoJSONIndexes[b.source]&&delete this._geoJSONIndexes[b.source]};e.prototype._indexData=function(b,a,e){try{a.cluster?e(null,c(a.superclusterOptions).load(b.features)):e(null,g(b,a.geojsonVtOptions))}catch(r){return e(r)}};return e}(a("./vector_tile_worker_source"));k.exports=a},{"../util/ajax":195,"./geojson_wrapper":86,"./vector_tile_worker_source":99,"geojson-rewind":8,"geojson-vt":12,supercluster:29,"vt-pbf":38}],86:[function(a,k,m){var f=a("point-geometry"),
d=a("vector-tile").VectorTileFeature,n=a("../data/extent"),l=function(a){this.type=a.type;if(1===a.type){this.rawGeometry=[];for(var c=0;c<a.geometry.length;c++)this.rawGeometry.push([a.geometry[c]])}else this.rawGeometry=a.geometry;this.properties=a.tags;"id"in a&&!isNaN(a.id)&&(this.id=parseInt(a.id,10));this.extent=n};l.prototype.loadGeometry=function(){var a=this.rawGeometry;this.geometry=[];for(var d=0;d<a.length;d++){for(var h=a[d],e=[],b=0;b<h.length;b++)e.push(new f(h[b][0],h[b][1]));this.geometry.push(e)}return this.geometry};
l.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var a=this.geometry,d=Infinity,f=-Infinity,e=Infinity,b=-Infinity,p=0;p<a.length;p++)for(var q=a[p],l=0;l<q.length;l++)var n=q[l],d=Math.min(d,n.x),f=Math.max(f,n.x),e=Math.min(e,n.y),b=Math.max(b,n.y);return[d,e,f,b]};l.prototype.toGeoJSON=function(){d.prototype.toGeoJSON.call(this)};a=function(a){this.features=a;this.length=a.length;this.extent=n};a.prototype.feature=function(a){return new l(this.features[a])};k.exports=a},{"../data/extent":54,
"point-geometry":26,"vector-tile":34}],87:[function(a,k,m){var f=a("../util/util"),d=a("../util/window"),n=a("./tile_coord"),l=a("../geo/lng_lat"),c=a("point-geometry");m=a("../util/evented");var g=a("../util/ajax"),h=a("../data/extent"),e=a("../data/raster_bounds_array"),b=a("../data/buffer"),p=a("../render/vertex_array_object");a=function(a){function q(b,c,e,d){a.call(this);this.id=b;this.dispatcher=e;this.coordinates=c.coordinates;this.type="image";this.minzoom=0;this.maxzoom=22;this.tileSize=
512;this.tiles={};this.setEventedParent(d);this.options=c;this.textureLoaded=!1}a&&(q.__proto__=a);q.prototype=Object.create(a&&a.prototype);q.prototype.constructor=q;q.prototype.load=function(){var b=this;this.fire("dataloading",{dataType:"source"});this.url=this.options.url;g.getImage(this.options.url,function(a,c){if(a)return b.fire("error",{error:a});b.image=c;b._finishLoading()})};q.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire("data",{dataType:"source",
sourceDataType:"metadata"}))};q.prototype.onAdd=function(b){this.load();this.map=b;this.image&&this.setCoordinates(this.coordinates)};q.prototype.setCoordinates=function(b){this.coordinates=b;var a=this.map;b=b.map(function(b){return a.transform.locationCoordinate(l.convert(b)).zoomTo(0)});var e=this.centerCoord=f.getCoordinatesCenter(b);e.column=Math.floor(e.column);e.row=Math.floor(e.row);this.coord=new n(e.zoom,e.column,e.row);this.minzoom=this.maxzoom=e.zoom;this._tileCoords=b.map(function(b){b=
b.zoomTo(e.zoom);return new c(Math.round((b.column-e.column)*h),Math.round((b.row-e.row)*h))});this.fire("data",{dataType:"source",sourceDataType:"content"});return this};q.prototype._setTile=function(a){this.tiles[a.coord.w]=a;var c=new e;c.emplaceBack(this._tileCoords[0].x,this._tileCoords[0].y,0,0);c.emplaceBack(this._tileCoords[1].x,this._tileCoords[1].y,32767,0);c.emplaceBack(this._tileCoords[3].x,this._tileCoords[3].y,0,32767);c.emplaceBack(this._tileCoords[2].x,this._tileCoords[2].y,32767,
32767);a.buckets={};a.boundsBuffer=b.fromStructArray(c,b.BufferType.VERTEX);a.boundsVAO=new p};q.prototype.prepare=function(){0===Object.keys(this.tiles).length!==0&&this.image&&this._prepareImage(this.map.painter.gl,this.image)};q.prototype._prepareImage=function(b,a,c){if(!this.textureLoaded)this.textureLoaded=!0,this.texture=b.createTexture(),b.bindTexture(b.TEXTURE_2D,this.texture),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),
b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,a);else if(c)b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,a);else if(a instanceof d.HTMLVideoElement||a instanceof d.ImageData||a instanceof d.HTMLCanvasElement)b.bindTexture(b.TEXTURE_2D,this.texture),b.texSubImage2D(b.TEXTURE_2D,0,0,0,b.RGBA,b.UNSIGNED_BYTE,a);for(var e in this.tiles)b=this.tiles[e],"loaded"!==
b.state&&(b.state="loaded",b.texture=this.texture)};q.prototype.loadTile=function(b,a){this.coord&&this.coord.toString()===b.coord.toString()?this._setTile(b):b.state="errored";a(null)};q.prototype.serialize=function(){return{type:"image",urls:this.url,coordinates:this.coordinates}};return q}(m);k.exports=a},{"../data/buffer":51,"../data/extent":54,"../data/raster_bounds_array":59,"../geo/lng_lat":62,"../render/vertex_array_object":81,"../util/ajax":195,"../util/evented":204,"../util/util":217,"../util/window":198,
"./tile_coord":97,"point-geometry":26}],88:[function(a,k,m){var f=a("../util/util"),d=a("../util/ajax"),n=a("../util/browser"),l=a("../util/mapbox").normalizeSourceURL;k.exports=function(a,g){var c=function(a,b){if(a)return g(a);var c=f.pick(b,"tiles minzoom maxzoom attribution mapbox_logo bounds".split(" "));b.vector_layers&&(c.vectorLayers=b.vector_layers,c.vectorLayerIds=c.vectorLayers.map(function(b){return b.id}));g(null,c)};a.url?d.getJSON(l(a.url),c):n.frame(c.bind(null,null,a))}},{"../util/ajax":195,
"../util/browser":196,"../util/mapbox":211,"../util/util":217}],89:[function(a,k,m){var f=a("../data/extent");k.exports=function(a,n,l){return f/(a.tileSize*Math.pow(2,l-a.coord.z))*n}},{"../data/extent":54}],90:[function(a,k,m){function f(a,d){var c=a.coord,f=d.coord;return c.z-f.z||c.y-f.y||c.w-f.w||c.x-f.x}var d=a("./tile_coord");m.rendered=function(a,d,c,g,h,e){c=a.tilesIn(c);c.sort(f);a=[];for(h=0;h<c.length;h++){var b=c[h];b.tile.featureIndex&&a.push({wrappedTileID:b.coord.wrapped().id,queryResults:b.tile.featureIndex.query({queryGeometry:b.queryGeometry,
scale:b.scale,tileSize:b.tile.tileSize,bearing:e,params:g},d)})}d={};g={};for(e=0;e<a.length;e+=1){h=a[e];c=h.queryResults;h=h.wrappedTileID;h=g[h]=g[h]||{};for(var p in c)for(var q=c[p],b=h[p]=h[p]||{},l=d[p]=d[p]||[],n=0;n<q.length;n+=1){var k=q[n];b[k.featureIndex]||(b[k.featureIndex]=!0,l.push(k.feature))}}return d};m.source=function(a,f){for(var c=a.getRenderableIds().map(function(b){return a.getTileByID(b)}),g=[],h={},e=0;e<c.length;e++){var b=c[e],p=(new d(Math.min(b.sourceMaxZoom,b.coord.z),
b.coord.x,b.coord.y,0)).id;h[p]||(h[p]=!0,b.querySourceFeatures(g,f))}return g}},{"./tile_coord":97}],91:[function(a,k,m){var f=a("../util/util"),d=a("../util/ajax");m=a("../util/evented");var n=a("./load_tilejson"),l=a("../util/mapbox").normalizeTileURL,c=a("./tile_bounds");a=function(a){function g(c,b,d,g){a.call(this);this.id=c;this.dispatcher=d;this.setEventedParent(g);this.type="raster";this.minzoom=0;this.maxzoom=22;this.roundZoom=!0;this.scheme="xyz";this.tileSize=512;this._loaded=!1;this.options=
b;f.extend(this,f.pick(b,["url","scheme","tileSize"]))}a&&(g.__proto__=a);g.prototype=Object.create(a&&a.prototype);g.prototype.constructor=g;g.prototype.load=function(){var a=this;this.fire("dataloading",{dataType:"source"});n(this.options,function(b,c){if(b)return a.fire("error",b);f.extend(a,c);a.setBounds(c.bounds);a.fire("data",{dataType:"source",sourceDataType:"metadata"});a.fire("data",{dataType:"source",sourceDataType:"content"})})};g.prototype.onAdd=function(a){this.load();this.map=a};g.prototype.setBounds=
function(a){if(this.bounds=a)this.tileBounds=new c(a,this.minzoom,this.maxzoom)};g.prototype.serialize=function(){return{type:"raster",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds}};g.prototype.hasTile=function(a){return!this.tileBounds||this.tileBounds.contains(a,this.maxzoom)};g.prototype.loadTile=function(a,b){var c=l(a.coord.url(this.tiles,null,this.scheme),this.url,this.tileSize);a.request=d.getImage(c,function(c,e){delete a.request;if(a.aborted)return this.state="unloaded",
b(null);if(c)return this.state="errored",b(c);this.map._refreshExpiredTiles&&a.setExpiryData(e);delete e.cacheControl;delete e.expires;var d=this.map.painter.gl;a.texture=this.map.painter.getTileTexture(e.width);a.texture?(d.bindTexture(d.TEXTURE_2D,a.texture),d.texSubImage2D(d.TEXTURE_2D,0,0,0,d.RGBA,d.UNSIGNED_BYTE,e)):(a.texture=d.createTexture(),d.bindTexture(d.TEXTURE_2D,a.texture),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR_MIPMAP_NEAREST),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,
d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),this.map.painter.extTextureFilterAnisotropic&&d.texParameterf(d.TEXTURE_2D,this.map.painter.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this.map.painter.extTextureFilterAnisotropicMax),d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,e),a.texture.size=e.width);d.generateMipmap(d.TEXTURE_2D);a.state="loaded";b(null)}.bind(this))};g.prototype.abortTile=
function(a){a.request&&(a.request.abort(),delete a.request)};g.prototype.unloadTile=function(a){a.texture&&this.map.painter.saveTileTexture(a.texture)};return g}(m);k.exports=a},{"../util/ajax":195,"../util/evented":204,"../util/mapbox":211,"../util/util":217,"./load_tilejson":88,"./tile_bounds":96}],92:[function(a,k,m){var f=a("../util/ajax");m=a("../util/evented");var d=a("../util/window"),n=!1,l=null;k.exports.evented=new m;k.exports.registerForPluginAvailability=function(a){if(l)a(l,k.exports.errorCallback);
else k.exports.evented.once("pluginAvailable",a);return a};k.exports.setRTLTextPlugin=function(a,g){if(n)throw Error("setRTLTextPlugin cannot be called multiple times.");n=!0;k.exports.errorCallback=g;f.getArrayBuffer(a,function(a,c){a?g(a):(l=d.URL.createObjectURL(new d.Blob([c.data]),{type:"text/javascript"}),k.exports.evented.fire("pluginAvailable",{pluginBlobURL:l,errorCallback:g}))})}},{"../util/ajax":195,"../util/evented":204,"../util/window":198}],93:[function(a,k,m){var f=a("../util/util"),
d={vector:a("../source/vector_tile_source"),raster:a("../source/raster_tile_source"),geojson:a("../source/geojson_source"),video:a("../source/video_source"),image:a("../source/image_source"),canvas:a("../source/canvas_source")};m.create=function(a,l,c,g){l=new d[l.type](a,l,c,g);if(l.id!==a)throw Error("Expected Source id to be "+a+" instead of "+l.id);f.bindAll(["load","abort","unload","serialize","prepare"],l);return l};m.getType=function(a){return d[a]};m.setType=function(a,f){d[a]=f}},{"../source/canvas_source":83,
"../source/geojson_source":84,"../source/image_source":87,"../source/raster_tile_source":91,"../source/vector_tile_source":98,"../source/video_source":100,"../util/util":217}],94:[function(a,k,m){function f(b,a,c){a=c.zoomTo(Math.min(b.z,a));return{x:(a.column-(b.x+b.w*Math.pow(2,b.z)))*p,y:(a.row-b.y)*p}}function d(b,a){return b%32-a%32}function n(b){return"raster"===b||"image"===b||"video"===b||"normal"===b}var l=a("./source"),c=a("./tile");m=a("../util/evented");var g=a("./tile_coord"),h=a("../util/lru_cache"),
e=a("../geo/coordinate"),b=a("../util/util"),p=a("../data/extent");a=function(a){function q(b,c,e){a.call(this);this.id=b;this.dispatcher=e;this.on("data",function(b){"source"===b.dataType&&"metadata"===b.sourceDataType&&(this._sourceLoaded=!0);this._sourceLoaded&&"source"===b.dataType&&"content"===b.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))});this.on("error",function(){this._sourceErrored=!0});this._source=l.create(b,c,e,this);this._tiles={};this._cache=new h(0,
this.unloadTile.bind(this));this._timers={};this._cacheTimers={};this._isIdRenderable=this._isIdRenderable.bind(this)}a&&(q.__proto__=a);q.prototype=Object.create(a&&a.prototype);q.prototype.constructor=q;q.prototype.onAdd=function(b){this.map=b;if(this._source&&this._source.onAdd)this._source.onAdd(b)};q.prototype.onRemove=function(b){if(this._source&&this._source.onRemove)this._source.onRemove(b)};q.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;for(var b in this._tiles){var a=
this._tiles[b];if("loaded"!==a.state&&"errored"!==a.state)return!1}return!0};q.prototype.getSource=function(){return this._source};q.prototype.loadTile=function(b,a){return this._source.loadTile(b,a)};q.prototype.unloadTile=function(b){if(this._source.unloadTile)return this._source.unloadTile(b)};q.prototype.abortTile=function(b){if(this._source.abortTile)return this._source.abortTile(b)};q.prototype.serialize=function(){return this._source.serialize()};q.prototype.prepare=function(){if(this._sourceLoaded&&
this._source.prepare)return this._source.prepare()};q.prototype.getIds=function(){return Object.keys(this._tiles).map(Number).sort(d)};q.prototype.getRenderableIds=function(){return this.getIds().filter(this._isIdRenderable)};q.prototype._isIdRenderable=function(b){return this._tiles[b].hasData()&&!this._coveredTiles[b]};q.prototype.reload=function(){this._cache.reset();for(var b in this._tiles)this.reloadTile(b,"reloading")};q.prototype.reloadTile=function(b,a){var c=this._tiles[b];c&&("loading"!==
c.state&&(c.state=a),this.loadTile(c,this._tileLoaded.bind(this,c,b,a)))};q.prototype._tileLoaded=function(b,a,c,e){e?(b.state="errored",404!==e.status&&this._source.fire("error",{tile:b,error:e})):(b.sourceCache=this,b.timeAdded=(new Date).getTime(),"expired"===c&&(b.refreshedUponExpiration=!0),this._setTileReloadTimer(a,b),this._source.fire("data",{dataType:"source",tile:b,coord:b.coord}),this.map&&(this.map.painter.tileExtentVAO.vao=null))};q.prototype.getTile=function(b){return this.getTileByID(b.id)};
q.prototype.getTileByID=function(b){return this._tiles[b]};q.prototype.getZoom=function(b){return b.zoom+b.scaleZoom(b.tileSize/this._source.tileSize)};q.prototype.findLoadedChildren=function(b,a,c){var e=!1,d;for(d in this._tiles){var f=this._tiles[d];if(!(c[d]||!f.hasData()||f.coord.z<=b.z||f.coord.z>a)){var g=Math.pow(2,Math.min(f.coord.z,this._source.maxzoom)-Math.min(b.z,this._source.maxzoom));if(Math.floor(f.coord.x/g)===b.x&&Math.floor(f.coord.y/g)===b.y)for(e=c[d]=!0;f&&f.coord.z-1>b.z;)g=
f.coord.parent(this._source.maxzoom).id,(f=this._tiles[g])&&f.hasData()&&(delete c[d],c[g]=!0)}}return e};q.prototype.findLoadedParent=function(b,a,c){for(var e=b.z-1;e>=a;e--){b=b.parent(this._source.maxzoom);var d=this._tiles[b.id];if(d&&d.hasData())return c[b.id]=!0,d;if(this._cache.has(b.id))return c[b.id]=!0,this._cache.getWithoutRemoving(b.id)}};q.prototype.updateCacheSize=function(b){this._cache.setMaxSize(Math.floor((Math.ceil(b.width/b.tileSize)+1)*(Math.ceil(b.height/b.tileSize)+1)*5))};
q.prototype.update=function(a){var c=this;this.transform=a;if(this._sourceLoaded){var e,d;this.updateCacheSize(a);var f=(this._source.roundZoom?Math.round:Math.floor)(this.getZoom(a)),h=Math.max(f-q.maxOverzooming,this._source.minzoom),f=Math.max(f+q.maxUnderzooming,this._source.minzoom),p={};this._coveredTiles={};var l;this.used?this._source.coord?l=a.getVisibleWrappedCoordinates(this._source.coord):(l=a.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,
roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(l=l.filter(function(b){return c._source.hasTile(b)}))):l=[];for(e=0;e<l.length;e++)a=l[e],d=c.addTile(a),p[a.id]=!0,d.hasData()||c.findLoadedChildren(a,f,p)||(a=c.findLoadedParent(a,h,p))&&c.addTile(a.coord);e={};if(n(this._source.type)){l=Object.keys(p);for(var r=0;r<l.length;r++){var u=l[r];a=g.fromID(u);(d=c._tiles[u])&&("undefined"===typeof d.fadeEndTime||d.fadeEndTime>=Date.now())&&(c.findLoadedChildren(a,
f,p)&&(p[u]=!0),(a=c.findLoadedParent(a,h,e))&&c.addTile(a.coord))}}for(var k in e)p[k]||(c._coveredTiles[k]=!0);for(k in e)p[k]=!0;h=b.keysDifference(this._tiles,p);for(e=0;e<h.length;e++)c.removeTile(+h[e])}};q.prototype.addTile=function(b){var a=this._tiles[b.id];if(a)return a;if(a=this._cache.get(b.id))a.redoPlacement(this._source),this._cacheTimers[b.id]&&(clearTimeout(this._cacheTimers[b.id]),this._cacheTimers[b.id]=void 0,this._setTileReloadTimer(b.id,a));var e=!!a;e||(a=b.z,a=new c(b,this._source.tileSize*
(a>this._source.maxzoom?Math.pow(2,a-this._source.maxzoom):1),this._source.maxzoom),this.loadTile(a,this._tileLoaded.bind(this,a,b.id,a.state)));a.uses++;this._tiles[b.id]=a;e||this._source.fire("dataloading",{tile:a,coord:a.coord,dataType:"source"});return a};q.prototype._setTileReloadTimer=function(b,a){var c=this,e=a.getExpiryTimeout();e&&(this._timers[b]=setTimeout(function(){c.reloadTile(b,"expired");c._timers[b]=void 0},e))};q.prototype._setCacheInvalidationTimer=function(b,a){var c=this,e=
a.getExpiryTimeout();e&&(this._cacheTimers[b]=setTimeout(function(){c._cache.remove(b);c._cacheTimers[b]=void 0},e))};q.prototype.removeTile=function(b){var a=this._tiles[b];a&&(a.uses--,delete this._tiles[b],this._timers[b]&&(clearTimeout(this._timers[b]),this._timers[b]=void 0),0<a.uses||(a.stopPlacementThrottler(),a.hasData()?(b=a.coord.wrapped().id,this._cache.add(b,a),this._setCacheInvalidationTimer(b,a)):(a.aborted=!0,this.abortTile(a),this.unloadTile(a))))};q.prototype.clearTiles=function(){for(var b in this._tiles)this.removeTile(b);
this._cache.reset()};q.prototype.tilesIn=function(b){for(var a=[],c=this.getIds(),d=Infinity,h=Infinity,q=-Infinity,l=-Infinity,r=b[0].zoom,n=0;n<b.length;n++)var u=b[n],d=Math.min(d,u.column),h=Math.min(h,u.row),q=Math.max(q,u.column),l=Math.max(l,u.row);for(n=0;n<c.length;n++){var u=this._tiles[c[n]],k=g.fromID(c[n]),m=[f(k,u.sourceMaxZoom,new e(d,h,r)),f(k,u.sourceMaxZoom,new e(q,l,r))];if(m[0].x<p&&m[0].y<p&&0<=m[1].x&&0<=m[1].y){for(var m=[],H=0;H<b.length;H++)m.push(f(k,u.sourceMaxZoom,b[H]));
a.push({tile:u,coord:k,queryGeometry:[m],scale:Math.pow(2,this.transform.zoom-u.coord.z)})}}return a};q.prototype.redoPlacement=function(){for(var b=this.getIds(),a=0;a<b.length;a++)this.getTileByID(b[a]).redoPlacement(this._source)};q.prototype.getVisibleCoordinates=function(){for(var b=this.getRenderableIds().map(g.fromID),a=0;a<b.length;a+=1){var c=b[a];c.posMatrix=this.transform.calculatePosMatrix(c,this._source.maxzoom)}return b};return q}(m);a.maxOverzooming=10;a.maxUnderzooming=3;k.exports=
a},{"../data/extent":54,"../geo/coordinate":61,"../util/evented":204,"../util/lru_cache":210,"../util/util":217,"./source":93,"./tile":95,"./tile_coord":97}],95:[function(a,k,m){var f=a("../util/util"),d=a("../data/bucket"),n=a("../data/feature_index"),l=a("vector-tile"),c=a("pbf"),g=a("../util/vectortile_to_geojson"),h=a("../style-spec/feature_filter"),e=a("../symbol/collision_tile"),b=a("../symbol/collision_box"),p=a("../util/throttler");a=function(b,a,c){this.coord=b;this.uid=f.uniqueId();this.uses=
0;this.tileSize=a;this.sourceMaxZoom=c;this.buckets={};this.expirationTime=null;this.expiredRequestCount=0;this.state="loading";this.placementThrottler=new p(300,this._immediateRedoPlacement.bind(this))};a.prototype.registerFadeDuration=function(b,a){var c=a+this.timeAdded;c<Date.now()||this.fadeEndTime&&c<this.fadeEndTime||(this.fadeEndTime=c,b.set(this.fadeEndTime-Date.now()))};a.prototype.loadVectorData=function(a,c){this.hasData()&&this.unloadVectorData();this.state="loaded";a&&(a.rawTileData&&
(this.rawTileData=a.rawTileData),this.collisionBoxArray=new b(a.collisionBoxArray),this.collisionTile=new e(a.collisionTile,this.collisionBoxArray),this.featureIndex=new n(a.featureIndex,this.rawTileData,this.collisionTile),this.buckets=d.deserialize(a.buckets,c.style))};a.prototype.reloadSymbolData=function(b,a){if("unloaded"!==this.state){this.collisionTile=new e(b.collisionTile,this.collisionBoxArray);this.featureIndex.setCollisionTile(this.collisionTile);for(var c in this.buckets){var g=this.buckets[c];
"symbol"===g.layers[0].type&&(g.destroy(),delete this.buckets[c])}f.extend(this.buckets,d.deserialize(b.buckets,a))}};a.prototype.unloadVectorData=function(){for(var b in this.buckets)this.buckets[b].destroy();this.buckets={};this.featureIndex=this.collisionTile=this.collisionBoxArray=null;this.state="unloaded"};a.prototype.redoPlacement=function(b){if("vector"===b.type||"geojson"===b.type)if("loaded"!==this.state)this.redoWhenDone=!0;else if(this.collisionTile){var a=b.map.transform.cameraToTileDistance(this);
if(this.angle===b.map.transform.angle&&this.pitch===b.map.transform.pitch&&this.cameraToCenterDistance===b.map.transform.cameraToCenterDistance&&this.showCollisionBoxes===b.map.showCollisionBoxes){if(this.cameraToTileDistance===a)return;if(25>this.pitch){this.cameraToTileDistance=a;return}}this.angle=b.map.transform.angle;this.pitch=b.map.transform.pitch;this.cameraToCenterDistance=b.map.transform.cameraToCenterDistance;this.cameraToTileDistance=a;this.showCollisionBoxes=b.map.showCollisionBoxes;
this.placementSource=b;this.state="reloading";this.placementThrottler.invoke()}};a.prototype._immediateRedoPlacement=function(){var b=this;this.placementSource.dispatcher.send("redoPlacement",{type:this.placementSource.type,uid:this.uid,source:this.placementSource.id,angle:this.angle,pitch:this.pitch,cameraToCenterDistance:this.cameraToCenterDistance,cameraToTileDistance:this.cameraToTileDistance,showCollisionBoxes:this.showCollisionBoxes},function(a,c){b.reloadSymbolData(c,b.placementSource.map.style);
b.placementSource.map.showCollisionBoxes&&b.placementSource.fire("data",{tile:b,coord:b.coord,dataType:"source"});b.placementSource.map&&(b.placementSource.map.painter.tileExtentVAO.vao=null);b.state="loaded";b.redoWhenDone&&(b.redoWhenDone=!1,b._immediateRedoPlacement())},this.workerID)};a.prototype.getBucket=function(b){return this.buckets[b.id]};a.prototype.querySourceFeatures=function(b,a){if(this.rawTileData){this.vtLayers||(this.vtLayers=(new l.VectorTile(new c(this.rawTileData))).layers);var e=
this.vtLayers._geojsonTileLayer||this.vtLayers[a.sourceLayer];if(e)for(var d=h(a&&a.filter),f={z:this.coord.z,x:this.coord.x,y:this.coord.y},p=0;p<e.length;p++){var q=e.feature(p);d(q)&&(q=new g(q,this.coord.z,this.coord.x,this.coord.y),q.tile=f,b.push(q))}}};a.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state};a.prototype.setExpiryData=function(b){var a=this.expirationTime;b.cacheControl?(b=f.parseCacheControl(b.cacheControl),b["max-age"]&&
(this.expirationTime=Date.now()+1E3*b["max-age"])):b.expires&&(this.expirationTime=(new Date(b.expires)).getTime());if(this.expirationTime){b=Date.now();var c=!1;this.expirationTime>b?c=!1:a?this.expirationTime<a?c=!0:(a=this.expirationTime-a)?this.expirationTime=b+Math.max(a,3E4):c=!0:c=!0;c?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}};a.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1E3*(1<<Math.min(this.expiredRequestCount-
1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)};a.prototype.stopPlacementThrottler=function(){this.placementThrottler.stop();"reloading"===this.state&&(this.state="loaded")};k.exports=a},{"../data/bucket":45,"../data/feature_index":55,"../style-spec/feature_filter":106,"../symbol/collision_box":164,"../symbol/collision_tile":166,"../util/throttler":215,"../util/util":217,"../util/vectortile_to_geojson":218,pbf:25,"vector-tile":34}],96:[function(a,k,m){var f=a("../geo/lng_lat_bounds"),
d=a("../util/util").clamp;a=function(a,d,c){this.bounds=f.convert(this.validateBounds(a));this.minzoom=d||0;this.maxzoom=c||24};a.prototype.validateBounds=function(a){return Array.isArray(a)&&4===a.length?[Math.max(-180,a[0]),Math.max(-90,a[1]),Math.min(180,a[2]),Math.min(90,a[3])]:[-180,-90,180,90]};a.prototype.contains=function(a,d){var c=d?Math.min(a.z,d):a.z,f=Math.floor(this.lngX(this.bounds.getWest(),c)),h=Math.floor(this.latY(this.bounds.getNorth(),c)),e=Math.ceil(this.lngX(this.bounds.getEast(),
c)),c=Math.ceil(this.latY(this.bounds.getSouth(),c));return a.x>=f&&a.x<e&&a.y>=h&&a.y<c};a.prototype.lngX=function(a,d){return Math.pow(2,d)/360*(a+180)};a.prototype.latY=function(a,f){var c=d(Math.sin(Math.PI/180*a),-.9999,.9999);return Math.pow(2,f-1)+.5*Math.log((1+c)/(1-c))*-(Math.pow(2,f)/(2*Math.PI))};k.exports=a},{"../geo/lng_lat_bounds":63,"../util/util":217}],97:[function(a,k,m){function f(a,b){if(a.row>b.row){var c=a;a=b;b=c}return{x0:a.column,y0:a.row,x1:b.column,y1:b.row,dx:b.column-
a.column,dy:b.row-a.row}}function d(a,b,c,d,f){c=Math.max(c,Math.floor(b.y0));d=Math.min(d,Math.ceil(b.y1));if(a.x0===b.x0&&a.y0===b.y0?a.x0+b.dy/a.dy*a.dx<b.x1:a.x1-b.dy/a.dy*a.dx<b.x0){var e=a;a=b;b=e}for(var e=a.dx/a.dy,g=b.dx/b.dy,h=0<a.dx,p=0>b.dx;c<d;c++)f(Math.floor(g*Math.max(0,Math.min(b.dy,c+p-b.y0))+b.x0),Math.ceil(e*Math.max(0,Math.min(a.dy,c+h-a.y0))+a.x0),c)}function n(a,b,c,g,h,l){var e=f(a,b);b=f(b,c);a=f(c,a);e.dy>b.dy&&(c=e,e=b,b=c);e.dy>a.dy&&(c=e,e=a,a=c);b.dy>a.dy&&(c=b,b=a,a=
c);e.dy&&d(a,e,g,h,l);b.dy&&d(a,b,g,h,l)}var l=a("assert"),c=a("@mapbox/whoots-js"),g=a("../geo/coordinate"),h=function(a,b,c,d){l(!isNaN(a)&&0<=a&&0===a%1);l(!isNaN(b)&&0<=b&&0===b%1);l(!isNaN(c)&&0<=c&&0===c%1);isNaN(d)&&(d=0);this.z=+a;this.x=+b;this.y=+c;this.w=+d;d*=2;0>d&&(d=-1*d-1);a=1<<this.z;this.id=32*(a*a*d+a*this.y+this.x)+this.z;this.posMatrix=null};h.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};h.prototype.toCoordinate=function(a){a=Math.min(this.z,void 0===a?this.z:
a);return new g(this.x+Math.pow(2,a)*this.w,this.y,a)};h.prototype.url=function(a,b,d){var e=c.getTileBBox(this.x,this.y,this.z),f;f="";for(var g,h=this.z;0<h;h--)g=1<<h-1,f+=(this.x&g?1:0)+(this.y&g?2:0);return a[(this.x+this.y)%a.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",Math.min(this.z,b||this.z)).replace("{x}",this.x).replace("{y}","tms"===d?Math.pow(2,this.z)-this.y-1:this.y).replace("{quadkey}",f).replace("{bbox-epsg-3857}",e)};h.prototype.parent=
function(a){return 0===this.z?null:this.z>a?new h(this.z-1,this.x,this.y,this.w):new h(this.z-1,Math.floor(this.x/2),Math.floor(this.y/2),this.w)};h.prototype.wrapped=function(){return new h(this.z,this.x,this.y,0)};h.prototype.children=function(a){if(this.z>=a)return[new h(this.z+1,this.x,this.y,this.w)];a=this.z+1;var b=2*this.x,c=2*this.y;return[new h(a,b,c,this.w),new h(a,b+1,c,this.w),new h(a,b,c+1,this.w),new h(a,b+1,c+1,this.w)]};h.cover=function(a,b,c,d){function e(b,a,e){var p,l;if(0<=e&&
e<=f)for(;b<a;b++)if(p=Math.floor(b/f),l=(b%f+f)%f,0===p||!0===d)p=new h(c,l,e,p),g[p.id]=p}void 0===d&&(d=!0);var f=1<<a,g={};n(b[0],b[1],b[2],0,f,e);n(b[2],b[3],b[0],0,f,e);return Object.keys(g).map(function(b){return g[b]})};h.fromID=function(a){var b=a%32,c=1<<b;a=(a-b)/32;var e=a%c,d=Math.floor(a/(c*c));0!==d%2&&(d=-1*d-1);return new h(b,e,(a-e)/c%c,d/2)};k.exports=h},{"../geo/coordinate":61,"@mapbox/whoots-js":4,assert:5}],98:[function(a,k,m){m=a("../util/evented");var f=a("../util/util"),d=
a("./load_tilejson"),n=a("../util/mapbox").normalizeTileURL,l=a("./tile_bounds");a=function(a){function c(c,e,b,d){a.call(this);this.id=c;this.dispatcher=b;this.type="vector";this.minzoom=0;this.maxzoom=22;this.scheme="xyz";this.tileSize=512;this.isTileClipped=this.reparseOverscaled=!0;f.extend(this,f.pick(e,["url","scheme","tileSize"]));this._options=f.extend({type:"vector"},e);if(512!==this.tileSize)throw Error("vector tile sources must have a tileSize of 512");this.setEventedParent(d)}a&&(c.__proto__=
a);c.prototype=Object.create(a&&a.prototype);c.prototype.constructor=c;c.prototype.load=function(){var a=this;this.fire("dataloading",{dataType:"source"});d(this._options,function(c,b){c?a.fire("error",c):(f.extend(a,b),a.setBounds(b.bounds),a.fire("data",{dataType:"source",sourceDataType:"metadata"}),a.fire("data",{dataType:"source",sourceDataType:"content"}))})};c.prototype.setBounds=function(a){if(this.bounds=a)this.tileBounds=new l(a,this.minzoom,this.maxzoom)};c.prototype.hasTile=function(a){return!this.tileBounds||
this.tileBounds.contains(a,this.maxzoom)};c.prototype.onAdd=function(a){this.load();this.map=a};c.prototype.serialize=function(){return f.extend({},this._options)};c.prototype.loadTile=function(a,c){function b(b,e){if(!a.aborted){if(b)return c(b);this.map._refreshExpiredTiles&&a.setExpiryData(e);a.loadVectorData(e,this.map.painter);a.redoWhenDone&&(a.redoWhenDone=!1,a.redoPlacement(this));c(null);a.reloadCallback&&(this.loadTile(a,a.reloadCallback),a.reloadCallback=null)}}var e=a.coord.z>this.maxzoom?
Math.pow(2,a.coord.z-this.maxzoom):1,e={url:n(a.coord.url(this.tiles,this.maxzoom,this.scheme),this.url),uid:a.uid,coord:a.coord,zoom:a.coord.z,tileSize:this.tileSize*e,type:this.type,source:this.id,overscaling:e,angle:this.map.transform.angle,pitch:this.map.transform.pitch,cameraToCenterDistance:this.map.transform.cameraToCenterDistance,cameraToTileDistance:this.map.transform.cameraToTileDistance(a),showCollisionBoxes:this.map.showCollisionBoxes};a.workerID&&"expired"!==a.state?"loading"===a.state?
a.reloadCallback=c:this.dispatcher.send("reloadTile",e,b.bind(this),a.workerID):a.workerID=this.dispatcher.send("loadTile",e,b.bind(this))};c.prototype.abortTile=function(a){this.dispatcher.send("abortTile",{uid:a.uid,type:this.type,source:this.id},null,a.workerID)};c.prototype.unloadTile=function(a){a.unloadVectorData();this.dispatcher.send("removeTile",{uid:a.uid,type:this.type,source:this.id},null,a.workerID)};return c}(m);k.exports=a},{"../util/evented":204,"../util/mapbox":211,"../util/util":217,
"./load_tilejson":88,"./tile_bounds":96}],99:[function(a,k,m){var f=a("../util/ajax"),d=a("vector-tile"),n=a("pbf"),l=a("./worker_tile"),c=a("../util/util");a=function(a,c,e){this.actor=a;this.layerIndex=c;e&&(this.loadVectorData=e);this.loading={};this.loaded={}};a.prototype.loadTile=function(a,d){var e=a.source,b=a.uid;this.loading[e]||(this.loading[e]={});var f=this.loading[e][b]=new l(a);f.abort=this.loadVectorData(a,function(a,g){delete this.loading[e][b];if(a)return d(a);if(!g)return d(null,
null);f.vectorTile=g;f.parse(g,this.layerIndex,this.actor,function(b,a,e){if(b)return d(b);b={};g.expires&&(b.expires=g.expires);g.cacheControl&&(b.cacheControl=g.cacheControl);d(null,c.extend({rawTileData:g.rawData},a,b),e)});this.loaded[e]=this.loaded[e]||{};this.loaded[e][b]=f}.bind(this))};a.prototype.reloadTile=function(a,c){function e(b,a){if(this.reloadCallback){var e=this.reloadCallback;delete this.reloadCallback;this.parse(this.vectorTile,f.layerIndex,f.actor,e)}c(b,a)}var b=this.loaded[a.source],
d=a.uid,f=this;b&&b[d]&&(b=b[d],"parsing"===b.status?b.reloadCallback=c:"done"===b.status&&b.parse(b.vectorTile,this.layerIndex,this.actor,e.bind(b)))};a.prototype.abortTile=function(a){var c=this.loading[a.source];a=a.uid;c&&c[a]&&c[a].abort&&(c[a].abort(),delete c[a])};a.prototype.removeTile=function(a){var c=this.loaded[a.source];a=a.uid;c&&c[a]&&delete c[a]};a.prototype.loadVectorData=function(a,c){var e=f.getArrayBuffer(a.url,function(b,a){if(b)return c(b);var e=new d.VectorTile(new n(a.data));
e.rawData=a.data;e.cacheControl=a.cacheControl;e.expires=a.expires;c(b,e)}.bind(this));return function(){e.abort()}};a.prototype.redoPlacement=function(a,c){var e=this.loaded[a.source],b=this.loading[a.source],d=a.uid;e&&e[d]?(e=e[d].redoPlacement(a.angle,a.pitch,a.cameraToCenterDistance,a.cameraToTileDistance,a.showCollisionBoxes),e.result&&c(null,e.result,e.transferables)):b&&b[d]&&(b[d].angle=a.angle)};k.exports=a},{"../util/ajax":195,"../util/util":217,"./worker_tile":102,pbf:25,"vector-tile":34}],
100:[function(a,k,m){var f=a("../util/ajax");a=function(a){function d(d,c,f,h){a.call(this,d,c,f,h);this.roundZoom=!0;this.type="video";this.options=c}a&&(d.__proto__=a);d.prototype=Object.create(a&&a.prototype);d.prototype.constructor=d;d.prototype.load=function(){var a=this,c=this.options;this.urls=c.urls;f.getVideo(c.urls,function(c,d){if(c)return a.fire("error",{error:c});a.video=d;a.video.loop=!0;var e;a.video.addEventListener("playing",function(){e=a.map.style.animationLoop.set(Infinity);a.map._rerender()});
a.video.addEventListener("pause",function(){a.map.style.animationLoop.cancel(e)});a.map&&a.video.play();a._finishLoading()})};d.prototype.getVideo=function(){return this.video};d.prototype.onAdd=function(a){this.map||(this.load(),this.map=a,this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))};d.prototype.prepare=function(){0===Object.keys(this.tiles).length||2>this.video.readyState||this._prepareImage(this.map.painter.gl,this.video)};d.prototype.serialize=function(){return{type:"video",
urls:this.urls,coordinates:this.coordinates}};return d}(a("./image_source"));k.exports=a},{"../util/ajax":195,"./image_source":87}],101:[function(a,k,m){var f=a("../util/actor"),d=a("../style/style_layer_index"),n=a("./vector_tile_worker_source"),l=a("./geojson_worker_source"),c=a("assert"),g=a("./rtl_text_plugin"),h=function(a){var b=this;this.self=a;this.actor=new f(a,this);this.layerIndexes={};this.workerSourceTypes={vector:n,geojson:l};this.workerSources={};this.self.registerWorkerSource=function(a,
c){if(b.workerSourceTypes[a])throw Error('Worker source with name "'+a+'" already registered.');b.workerSourceTypes[a]=c};this.self.registerRTLTextPlugin=function(b){if(g.applyArabicShaping||g.processBidirectionalText)throw Error("RTL text plugin already registered.");g.applyArabicShaping=b.applyArabicShaping;g.processBidirectionalText=b.processBidirectionalText}};h.prototype.setLayers=function(a,b){this.getLayerIndex(a).replace(b)};h.prototype.updateLayers=function(a,b){this.getLayerIndex(a).update(b.layers,
b.removedIds,b.symbolOrder)};h.prototype.loadTile=function(a,b,d){c(b.type);this.getWorkerSource(a,b.type).loadTile(b,d)};h.prototype.reloadTile=function(a,b,d){c(b.type);this.getWorkerSource(a,b.type).reloadTile(b,d)};h.prototype.abortTile=function(a,b){c(b.type);this.getWorkerSource(a,b.type).abortTile(b)};h.prototype.removeTile=function(a,b){c(b.type);this.getWorkerSource(a,b.type).removeTile(b)};h.prototype.removeSource=function(a,b){c(b.type);var e=this.getWorkerSource(a,b.type);void 0!==e.removeSource&&
e.removeSource(b)};h.prototype.redoPlacement=function(a,b,d){c(b.type);this.getWorkerSource(a,b.type).redoPlacement(b,d)};h.prototype.loadWorkerSource=function(a,b,c){try{this.self.importScripts(b.url),c()}catch(q){c(q)}};h.prototype.loadRTLTextPlugin=function(a,b,c){try{g.applyArabicShaping||g.processBidirectionalText||this.self.importScripts(b)}catch(q){c(q)}};h.prototype.getLayerIndex=function(a){var b=this.layerIndexes[a];b||(b=this.layerIndexes[a]=new d);return b};h.prototype.getWorkerSource=
function(a,b){var c=this;this.workerSources[a]||(this.workerSources[a]={});this.workerSources[a][b]||(this.workerSources[a][b]=new this.workerSourceTypes[b]({send:function(b,e,d,f){c.actor.send(b,e,d,f,a)}},this.getLayerIndex(a)));return this.workerSources[a][b]};k.exports=function(a){return new h(a)}},{"../style/style_layer_index":158,"../util/actor":194,"./geojson_worker_source":85,"./rtl_text_plugin":92,"./vector_tile_worker_source":99,assert:5}],102:[function(a,k,m){function f(a,c){for(var b=
0,e=a.layers;b<e.length;b+=1)e[b].recalculate(c)}function d(a,c){return a.filter(function(a){return!a.isEmpty()}).map(function(a){return a.serialize(c)})}var n=a("../data/feature_index"),l=a("../symbol/collision_tile"),c=a("../symbol/collision_box"),g=a("../util/dictionary_coder"),h=a("../util/util"),e=a("assert");a=function(a){this.coord=a.coord;this.uid=a.uid;this.zoom=a.zoom;this.tileSize=a.tileSize;this.source=a.source;this.overscaling=a.overscaling;this.angle=a.angle;this.pitch=a.pitch;this.cameraToCenterDistance=
a.cameraToCenterDistance;this.cameraToTileDistance=a.cameraToTileDistance;this.showCollisionBoxes=a.showCollisionBoxes};a.prototype.parse=function(a,p,q,r){var b=this;a.layers||(a={layers:{_geojsonTileLayer:a}});this.status="parsing";this.data=a;this.collisionBoxArray=new c;var k=new g(Object.keys(a.layers).sort()),m=new n(this.coord,this.overscaling);m.bucketLayerIDs={};var t={},v=0,B={featureIndex:m,iconDependencies:{},glyphDependencies:{}},w=p.familiesBySource[this.source],x;for(x in w){var C=
a.layers[x];if(C){1===C.version&&h.warnOnce('Vector tile source "'+b.source+'" layer "'+x+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var z=k.encode(x),E=[],D=0;D<C.length;D++){var H=C.feature(D);H.index=D;H.sourceLayerIndex=z;E.push(H)}C=0;for(z=w[x];C<z.length;C+=1)if(D=z[C],H=D[0],e(H.source===b.source),!(H.minzoom&&b.zoom<H.minzoom||H.maxzoom&&b.zoom>=H.maxzoom||H.layout&&"none"===H.layout.visibility)){for(var I=0,G=D;I<G.length;I+=1)G[I].recalculate(b.zoom);
(t[H.id]=H.createBucket({index:v,layers:D,zoom:b.zoom,overscaling:b.overscaling,collisionBoxArray:b.collisionBoxArray})).populate(E,B);m.bucketLayerIDs[v]=D.map(function(a){return a.id});v++}}}var F=function(a){b.status="done";m.paintPropertyStatistics={};for(var c in t)h.extend(m.paintPropertyStatistics,t[c].getPaintPropertyStatistics());c=[];r(null,{buckets:d(h.values(t),c),featureIndex:m.serialize(c),collisionTile:a.serialize(c),collisionBoxArray:b.collisionBoxArray.serialize()},c)};this.symbolBuckets=
[];for(a=p.symbolOrder.length-1;0<=a;a--)(k=t[p.symbolOrder[a]])&&b.symbolBuckets.push(k);if(0===this.symbolBuckets.length)return F(new l(this.angle,this.pitch,this.cameraToCenterDistance,this.cameraToTileDistance,this.collisionBoxArray));var K=0,J=Object.keys(B.iconDependencies),L=h.mapObject(B.glyphDependencies,function(a){return Object.keys(a).map(Number)}),N=function(a){if(a)return r(a);K++;if(2===K){a=new l(b.angle,b.pitch,b.cameraToCenterDistance,b.cameraToTileDistance,b.collisionBoxArray);
for(var c=0,e=b.symbolBuckets;c<e.length;c+=1){var d=e[c];f(d,b.zoom);d.prepare(L,J);d.place(a,b.showCollisionBoxes)}F(a)}};Object.keys(L).length?q.send("getGlyphs",{uid:this.uid,stacks:L},function(a,b){L=b;N(a)}):N();J.length?q.send("getIcons",{icons:J},function(a,b){J=b;N(a)}):N()};a.prototype.redoPlacement=function(a,c,e,g,h){this.angle=a;this.pitch=c;this.cameraToCenterDistance=e;this.cameraToTileDistance=g;if("done"!==this.status)return{};a=new l(this.angle,this.pitch,this.cameraToCenterDistance,
this.cameraToTileDistance,this.collisionBoxArray);c=0;for(e=this.symbolBuckets;c<e.length;c+=1)g=e[c],f(g,this.zoom),g.place(a,h);h=[];return{result:{buckets:d(this.symbolBuckets,h),collisionTile:a.serialize(h)},transferables:h}};k.exports=a},{"../data/feature_index":55,"../symbol/collision_box":164,"../symbol/collision_tile":166,"../util/dictionary_coder":201,"../util/util":217,assert:5}],103:[function(a,k,m){function f(a,f){var c={},g;for(g in a)"ref"!==g&&(c[g]=a[g]);d.forEach(function(a){a in
f&&(c[a]=f[a])});return c}var d=a("./util/ref_properties");k.exports=function(a){a=a.slice();for(var d=Object.create(null),c=0;c<a.length;c++)d[a[c].id]=a[c];for(c=0;c<a.length;c++)"ref"in a[c]&&(a[c]=f(a[c],d[a[c].ref]));return a}},{"./util/ref_properties":126}],104:[function(a,k,m){function f(a,b,c,d){a=a||{};b=b||{};for(var e in a)a.hasOwnProperty(e)&&!b.hasOwnProperty(e)&&(c.push({command:h.removeSource,args:[e]}),d[e]=!0);for(e in b)b.hasOwnProperty(e)&&(a.hasOwnProperty(e)?g(a[e],b[e])||(c.push({command:h.removeSource,
args:[e]}),c.push({command:h.addSource,args:[e,b[e]]}),d[e]=!0):c.push({command:h.addSource,args:[e,b[e]]}))}function d(a,b,c,d,f,h){a=a||{};b=b||{};for(var e in a)a.hasOwnProperty(e)&&(g(a[e],b[e])||c.push({command:h,args:[d,e,b[e],f]}));for(e in b)b.hasOwnProperty(e)&&!a.hasOwnProperty(e)&&(g(a[e],b[e])||c.push({command:h,args:[d,e,b[e],f]}))}function n(a){return a.id}function l(a,b){a[b.id]=b;return a}function c(a,b,c){a=a||[];b=b||[];var e=a.map(n),f=b.map(n);a=a.reduce(l,{});b=b.reduce(l,{});
var p=e.slice(),k=Object.create(null),m,t,v,B,w;for(t=m=0;m<e.length;m++)v=e[m],b.hasOwnProperty(v)?t++:(c.push({command:h.removeLayer,args:[v]}),p.splice(p.indexOf(v,t),1));for(t=m=0;m<f.length;m++)v=f[f.length-1-m],p[p.length-1-m]!==v&&(a.hasOwnProperty(v)?(c.push({command:h.removeLayer,args:[v]}),p.splice(p.lastIndexOf(v,p.length-t),1)):t++,B=p[p.length-m],c.push({command:h.addLayer,args:[b[v],B]}),p.splice(p.length-m,0,v),k[v]=!0);for(m=0;m<f.length;m++)if(v=f[m],t=a[v],e=b[v],!k[v]&&!g(t,e))if(g(t.source,
e.source)&&g(t["source-layer"],e["source-layer"])&&g(t.type,e.type)){d(t.layout,e.layout,c,v,null,h.setLayoutProperty);d(t.paint,e.paint,c,v,null,h.setPaintProperty);g(t.filter,e.filter)||c.push({command:h.setFilter,args:[v,e.filter]});g(t.minzoom,e.minzoom)&&g(t.maxzoom,e.maxzoom)||c.push({command:h.setLayerZoomRange,args:[v,e.minzoom,e.maxzoom]});for(w in t)t.hasOwnProperty(w)&&"layout"!==w&&"paint"!==w&&"filter"!==w&&"metadata"!==w&&"minzoom"!==w&&"maxzoom"!==w&&(0===w.indexOf("paint.")?d(t[w],
e[w],c,v,w.slice(6),h.setPaintProperty):g(t[w],e[w])||c.push({command:h.setLayerProperty,args:[v,w,e[w]]}));for(w in e)e.hasOwnProperty(w)&&!t.hasOwnProperty(w)&&"layout"!==w&&"paint"!==w&&"filter"!==w&&"metadata"!==w&&"minzoom"!==w&&"maxzoom"!==w&&(0===w.indexOf("paint.")?d(t[w],e[w],c,v,w.slice(6),h.setPaintProperty):g(t[w],e[w])||c.push({command:h.setLayerProperty,args:[v,w,e[w]]}))}else c.push({command:h.removeLayer,args:[v]}),B=p[p.lastIndexOf(v)+1],c.push({command:h.addLayer,args:[e,B]})}var g=
a("lodash.isequal"),h={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};k.exports=function(a,
b){if(!a)return[{command:h.setStyle,args:[b]}];var e=[];try{if(!g(a.version,b.version))return[{command:h.setStyle,args:[b]}];g(a.center,b.center)||e.push({command:h.setCenter,args:[b.center]});g(a.zoom,b.zoom)||e.push({command:h.setZoom,args:[b.zoom]});g(a.bearing,b.bearing)||e.push({command:h.setBearing,args:[b.bearing]});g(a.pitch,b.pitch)||e.push({command:h.setPitch,args:[b.pitch]});g(a.sprite,b.sprite)||e.push({command:h.setSprite,args:[b.sprite]});g(a.glyphs,b.glyphs)||e.push({command:h.setGlyphs,
args:[b.glyphs]});g(a.transition,b.transition)||e.push({command:h.setTransition,args:[b.transition]});g(a.light,b.light)||e.push({command:h.setLight,args:[b.light]});var d={},l=[];f(a.sources,b.sources,l,d);var n=[];a.layers&&a.layers.forEach(function(a){d[a.source]?e.push({command:h.removeLayer,args:[a.id]}):n.push(a)});e=e.concat(l);c(n,b.layers,e)}catch(A){console.warn("Unable to compute style diff:",A),e=[{command:h.setStyle,args:[b]}]}return e};k.exports.operations=h},{"lodash.isequal":117}],
105:[function(a,k,m){var f=a("util").format;k.exports=function(a,n){for(var d=[],c=arguments.length-2;0<c--;)d[c]=arguments[c+2];this.message=(a?a+": ":"")+f.apply(f,d);null!==n&&void 0!==n&&n.__line__&&(this.line=n.__line__)}},{util:33}],106:[function(a,k,m){function f(a){if(!a)return"true";var b=a[0];return 1>=a.length?"any"===b?"false":"true":"("+("=="===b?n(a[1],a[2],"===",!1):"!="===b?n(a[1],a[2],"!==",!1):"<"===b||">"===b||"<="===b||">="===b?n(a[1],a[2],b,!0):"any"===b?l(a.slice(1),"||"):"all"===
b?l(a.slice(1),"&&"):"none"===b?"!("+l(a.slice(1),"||")+")":"in"===b?c(a[1],a.slice(2)):"!in"===b?"!("+c(a[1],a.slice(2))+")":"has"===b?g(a[1]):"!has"===b?"!("+g(a[1])+")":"true")+")"}function d(a){return"$type"===a?"f.type":"$id"===a?"f.id":"p["+JSON.stringify(a)+"]"}function n(a,c,f,g){var b=d(a);a="$type"===a?e.indexOf(c):JSON.stringify(c);return(g?"typeof "+b+"=== typeof "+a+"&&":"")+b+f+a}function l(a,c){return a.map(f).join(c)}function c(a,c){"$type"===a&&(c=c.map(function(a){return e.indexOf(a)}));
var b=JSON.stringify(c.sort(h)),f=d(a);return 200>=c.length?b+".indexOf("+f+") !== -1":"function(v, a, i, j) {while (i <= j) { var m = (i + j) >> 1;    if (a[m] === v) return true; if (a[m] > v) j = m - 1; else i = m + 1;}return false; }("+f+", "+b+",0,"+(c.length-1)+")"}function g(a){return"$id"===a?'"id" in f':JSON.stringify(a)+" in p"}function h(a,c){return a<c?-1:a>c?1:0}k.exports=function(a){return new Function("f","var p = (f && f.properties || {}); return "+f(a))};var e=["Unknown","Point",
"LineString","Polygon"]},{}],107:[function(a,k,m){function f(a){return a>p?Math.pow(a,1/3):a/b+h}function d(a){return a>e?a*a*a:b*(a-h)}function n(a){return 255*(.0031308>=a?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function l(a){a/=255;return.04045>=a?a/12.92:Math.pow((a+.055)/1.055,2.4)}function c(a){var b=l(a[0]),c=l(a[1]),e=l(a[2]),d=f((.4124564*b+.3575761*c+.1804375*e)/.95047),g=f((.2126729*b+.7151522*c+.072175*e)/1),b=f((.0193339*b+.119192*c+.9503041*e)/1.08883);return[116*g-16,500*(d-g),200*(g-
b),a[3]]}function g(a){var b=(a[0]+16)/116,c=isNaN(a[1])?b:b+a[1]/500,e=isNaN(a[2])?b:b-a[2]/200,b=1*d(b),c=.95047*d(c),e=1.08883*d(e);return[n(3.2404542*c-1.5371385*b-.4985314*e),n(-.969266*c+1.8760108*b+.041556*e),n(.0556434*c-.2040259*b+1.0572252*e),a[3]]}var h=4/29,e=6/29,b=3*e*e,p=e*e*e,q=Math.PI/180,r=180/Math.PI;k.exports={lab:{forward:c,reverse:g},hcl:{forward:function(a){var b=c(a),e=b[1],d=b[2],f=Math.atan2(d,e)*r;return[0>f?f+360:f,Math.sqrt(e*e+d*d),b[0],a[3]]},reverse:function(a){var b=
a[0]*q,c=a[1];return g([a[2],Math.cos(b)*c,Math.sin(b)*c,a[3]])}}}},{}],108:[function(a,k,m){function f(a){return a}function d(a,e){var p="color"===e.type,k;if(b(a)){var m=(k=a.stops&&"object"===typeof a.stops[0][0])||void 0!==a.property,m=k||!m,t=a.type||("interpolated"===e["function"]?"exponential":"interval");p&&(a=u({},a),a.stops&&(a.stops=a.stops.map(function(a){return[a[0],r(a[1])]})),a["default"]=a["default"]?r(a["default"]):r(e["default"]));var z,A,y;if("exponential"===t)z=g;else if("interval"===
t)z=c;else if("categorical"===t){z=l;A=Object.create(null);p=0;for(t=a.stops;p<t.length;p+=1){var v=t[p];A[v[0]]=v[1]}y=typeof a.stops[0][0]}else if("identity"===t)z=h;else throw Error('Unknown function type "'+t+'"');var I;if(a.colorSpace&&"rgb"!==a.colorSpace)if(q[a.colorSpace]){p=q[a.colorSpace];a=JSON.parse(JSON.stringify(a));for(t=0;t<a.stops.length;t++)a.stops[t]=[a.stops[t][0],p.forward(a.stops[t][1])];I=p.reverse}else throw Error("Unknown color space: "+a.colorSpace);else I=f;if(k){k={};m=
[];for(p=0;p<a.stops.length;p++)t=a.stops[p],v=t[0].zoom,void 0===k[v]&&(k[v]={zoom:v,type:a.type,property:a.property,"default":a["default"],stops:[]},m.push(v)),k[v].stops.push([t[0].value,t[1]]);for(var G=[],p=0;p<m.length;p+=1)t=m[p],G.push([k[t].zoom,d(k[t],e)]);k=function(b,c){return I(g({stops:G,base:a.base},e,b)(b,c))};k.isFeatureConstant=!1;k.isZoomConstant=!1}else m?(k=function(b){return I(z(a,e,b,A,y))},k.isFeatureConstant=!0,k.isZoomConstant=!1):(k=function(b,c){var d=c[a.property];return void 0===
d?n(a["default"],e["default"]):I(z(a,e,d,A,y))},k.isFeatureConstant=!1,k.isZoomConstant=!0)}else p&&a&&(a=r(a)),k=function(){return a},k.isFeatureConstant=!0,k.isZoomConstant=!0;return k}function n(a,b,c){if(void 0!==a)return a;if(void 0!==b)return b;if(void 0!==c)return c}function l(a,b,c,e,d){return n(typeof c===d?e[c]:void 0,a["default"],b["default"])}function c(a,b,c){if("number"!==A(c))return n(a["default"],b["default"]);b=a.stops.length;if(1===b||c<=a.stops[0][0])return a.stops[0][1];if(c>=
a.stops[b-1][0])return a.stops[b-1][1];c=e(a.stops,c);return a.stops[c][1]}function g(a,b,c){var d=void 0!==a.base?a.base:1;if("number"!==A(c))return n(a["default"],b["default"]);var g=a.stops.length;if(1===g||c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[g-1][0])return a.stops[g-1][1];var g=e(a.stops,c),h=p(c,d,a.stops[g][0],a.stops[g+1][0]),l=a.stops[g][1],q=a.stops[g+1][1],r=y[b.type]||f;return"function"===typeof l?function(){for(var a=[],b=arguments.length;b--;)a[b]=arguments[b];b=l.apply(void 0,
a);a=q.apply(void 0,a);if(void 0!==b&&void 0!==a)return r(b,a,h)}:r(l,q,h)}function h(a,b,c){"color"===b.type?c=r(c):A(c)!==b.type&&(c=void 0);return n(c,a["default"],b["default"])}function e(a,b){for(var c=0,e=a.length-1,d=0,f,g;c<=e;){d=Math.floor((c+e)/2);f=a[d][0];g=a[d+1][0];if(b===f||b>f&&b<g)return d;f<b?c=d+1:f>b&&(e=d-1)}return Math.max(d-1,0)}function b(a){return"object"===typeof a&&(a.stops||"identity"===a.type)}function p(a,b,c,e){e-=c;a-=c;return 1===b?a/e:(Math.pow(b,a)-1)/(Math.pow(b,
e)-1)}var q=a("./color_spaces"),r=a("../util/parse_color"),u=a("../util/extend"),A=a("../util/get_type"),y=a("../util/interpolate");k.exports=d;k.exports.isFunctionDefinition=b;k.exports.interpolationFactor=p;k.exports.findStopLessThanOrEqualTo=e},{"../util/extend":122,"../util/get_type":123,"../util/interpolate":124,"../util/parse_color":125,"./color_spaces":107}],109:[function(a,k,m){function f(a){return n(d.map(function(c){return a[c]}))}var d=a("./util/ref_properties"),n=a("fast-stable-stringify");
k.exports=function(a){for(var c={},d=0;d<a.length;d++){var h=f(a[d]),e=c[h];e||(e=c[h]=[]);e.push(a[d])}a=[];for(var b in c)a.push(c[b]);return a}},{"./util/ref_properties":126,"fast-stable-stringify":111}],110:[function(a,k,m){function f(a){a=Math.round(a);return 0>a?0:255<a?255:a}function d(a){return 0>a?0:1<a?1:a}function n(a){return"%"===a[a.length-1]?f(parseFloat(a)/100*255):f(parseInt(a))}function l(a){return"%"===a[a.length-1]?d(parseFloat(a)/100):d(parseFloat(a))}function c(a,b,c){0>c?c+=
1:1<c&&--c;return 1>6*c?a+(b-a)*c*6:1>2*c?b:2>3*c?a+(b-a)*(2/3-c)*6:a}function g(a){a=a.replace(/ /g,"").toLowerCase();if(a in h)return h[a].slice();if("#"===a[0])return 4===a.length?(a=parseInt(a.substr(1),16),0<=a&&4095>=a?[(a&3840)>>4|(a&3840)>>8,a&240|(a&240)>>4,a&15|(a&15)<<4,1]:null):7===a.length?(a=parseInt(a.substr(1),16),0<=a&&16777215>=a?[(a&16711680)>>16,(a&65280)>>8,a&255,1]:null):null;var b=a.indexOf("("),e=a.indexOf(")");if(-1!==b&&e+1===a.length){var d=a.substr(0,b),b=a.substr(b+1,
e-(b+1)).split(",");a=1;switch(d){case "rgba":if(4!==b.length)break;a=l(b.pop());case "rgb":if(3!==b.length)break;return[n(b[0]),n(b[1]),n(b[2]),a];case "hsla":if(4!==b.length)break;a=l(b.pop());case "hsl":if(3===b.length)return d=(parseFloat(b[0])%360+360)%360/360,e=l(b[1]),b=l(b[2]),e=.5>=b?b*(e+1):b+e-b*e,b=2*b-e,[f(255*c(b,e,d+1/3)),f(255*c(b,e,d)),f(255*c(b,e,d-1/3)),a]}}return null}var h={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,
255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,
1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,
144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,
252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,
50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,
230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,
69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,
245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};try{m.parseCSSColor=g}catch(e){}},{}],111:[function(a,k,m){function f(a){var e,b,d,h,r,k;switch(typeof a){case "object":if(null===a)return null;if(n(a)){d="[";b=a.length-1;for(e=0;e<b;e++)d+=f(a[e])+",";-1<b&&(d+=f(a[e]));return d+"]"}h=l(a).sort();b=h.length;d="{";r=h[e=0];for(k=0<b&&void 0!==a[r];e<b;)k?(d+='"'+r.replace(c,g)+'":'+f(a[r]),r=h[++e],(k=e<b&&void 0!==a[r])&&(d+=",")):(r=h[++e],k=e<b&&void 0!==a[r]);return d+"}";case "undefined":return null;
case "string":return'"'+a.replace(c,g)+'"';default:return a}}var d={}.toString,n=Array.isArray||function(a){return"[object Array]"===d.call(a)},l=Object.keys||function(a){var c=[],b;for(b in a)a.hasOwnProperty(b)&&c.push(b);return c},c=/[\u0000-\u001f"\\]/g,g=function(a){a=a.charCodeAt(0);switch(a){case 34:return'\\"';case 92:return"\\\\";case 12:return"\\f";case 10:return"\\n";case 13:return"\\r";case 9:return"\\t";case 8:return"\\b";default:return 15<a?"\\u00"+a.toString(16):"\\u000"+a.toString(16)}};
k.exports=function(a){if(void 0!==a)return""+f(a)};k.exports.stringSearch=c;k.exports.stringReplace=g},{}],112:[function(a,k,m){function f(a,b){for(var c=-1,e=a.length;++c<e;)if(b(a[c],c,a))return!0;return!1}function d(a,e,f,k,m,t){if(a===e)return!0;var q;(q=null==a||null==e)||(q=typeof a,q=!(a&&("object"==q||"function"==q))&&!(e&&"object"==typeof e));if(q)return a!==a&&e!==e;a:{q=g(a);var r=g(e),u="[object Array]",A="[object Array]";q||(u=p.call(a),"[object Arguments]"==u?u="[object Object]":"[object Object]"!=
u&&(q=h(a)));r||(A=p.call(e),"[object Arguments]"==A?A="[object Object]":"[object Object]"!=A&&h(e));var y="[object Object]"==u,r="[object Object]"==A,A=u==A;if(!A||q||y){if(!k&&(u=y&&b.call(a,"__wrapped__"),r=r&&b.call(e,"__wrapped__"),u||r)){a=d(u?a.value():a,r?e.value():e,f,k,m,t);break a}if(A){m||(m=[]);t||(t=[]);for(u=m.length;u--;)if(m[u]==a){a=t[u]==e;break a}m.push(a);t.push(e);a=(q?n:c)(a,e,d,f,k,m,t);m.pop();t.pop()}else a=!1}else a=l(a,e,u)}return a}function n(a,b,c,e,d,g,h){var l=-1,p=
a.length,n=b.length;if(p!=n&&!(d&&n>p))return!1;for(;++l<p;){var q=a[l],n=b[l],r=e?e(d?n:q,d?q:n,l):void 0;if(void 0!==r){if(r)continue;return!1}if(d){if(!f(b,function(a){return q===a||c(q,a,e,d,g,h)}))return!1}else if(q!==n&&!c(q,n,e,d,g,h))return!1}return!0}function l(a,b,c){switch(c){case "[object Boolean]":case "[object Date]":return+a==+b;case "[object Error]":return a.name==b.name&&a.message==b.message;case "[object Number]":return a!=+a?b!=+b:a==+b;case "[object RegExp]":case "[object String]":return a==
b+""}return!1}function c(a,c,d,f,g,h,l){var p=e(a),n=p.length,q=e(c).length;if(n!=q&&!g)return!1;for(q=n;q--;){var r=p[q];if(!(g?r in c:b.call(c,r)))return!1}for(var k=g;++q<n;){var r=p[q],m=a[r],u=c[r],t=f?f(g?u:m,g?m:u,r):void 0;if(void 0===t?!d(m,u,f,g,h,l):!t)return!1;k||(k="constructor"==r)}return k||(d=a.constructor,f=c.constructor,!(d!=f&&"constructor"in a&&"constructor"in c)||"function"==typeof d&&d instanceof d&&"function"==typeof f&&f instanceof f)?!0:!1}var g=a("lodash.isarray"),h=a("lodash.istypedarray"),
e=a("lodash.keys");a=Object.prototype;var b=a.hasOwnProperty,p=a.toString;k.exports=d},{"lodash.isarray":116,"lodash.istypedarray":118,"lodash.keys":119}],113:[function(a,k,m){function f(a){return a}k.exports=function(a,n,l){if("function"!=typeof a)return f;if(void 0===n)return a;switch(l){case 1:return function(c){return a.call(n,c)};case 3:return function(c,d,f){return a.call(n,c,d,f)};case 4:return function(c,d,f,e){return a.call(n,c,d,f,e)};case 5:return function(c,d,f,e,b){return a.call(n,c,
d,f,e,b)}}return function(){return a.apply(n,arguments)}}},{}],114:[function(a,k,m){var f=/^\[object .+?Constructor\]$/;a=Object.prototype;var d=Function.prototype.toString,n=a.toString,l=RegExp("^"+d.call(a.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");k.exports=function(a,g){var c=null==a?void 0:a[g];var e;null==c?e=!1:(e=typeof c,e=!c||"object"!=e&&"function"!=e||"[object Function]"!=n.call(c)?!!c&&"object"==
typeof c&&f.test(c):l.test(d.call(c)));return e?c:void 0}},{}],115:[function(a,k,m){a=Object.prototype;var f=a.hasOwnProperty,d=a.toString,n=a.propertyIsEnumerable;k.exports=function(a){var c;if(c=!!a&&"object"==typeof a){if(c=null!=a)c=a.length,c="number"==typeof c&&-1<c&&0==c%1&&9007199254740991>=c;c&&(c=typeof a,c=!a||"object"!=c&&"function"!=c?"":d.call(a),c=!("[object Function]"==c||"[object GeneratorFunction]"==c))}return c&&f.call(a,"callee")&&(!n.call(a,"callee")||"[object Arguments]"==d.call(a))}},
{}],116:[function(a,k,m){var f=/^\[object .+?Constructor\]$/;a=Object.prototype;var d=Function.prototype.toString,n=a.toString,l=RegExp("^"+d.call(a.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");a=function(a,g){var c=null==a?void 0:a[g];var e;null==c?e=!1:(e=typeof c,e=!c||"object"!=e&&"function"!=e||"[object Function]"!=n.call(c)?!!c&&"object"==typeof c&&f.test(c):l.test(d.call(c)));return e?c:void 0}(Array,"isArray")||
function(a){var c;if(c=!!a&&"object"==typeof a)c=a.length,c="number"==typeof c&&-1<c&&0==c%1&&9007199254740991>=c;return c&&"[object Array]"==n.call(a)};k.exports=a},{}],117:[function(a,k,m){var f=a("lodash._baseisequal"),d=a("lodash._bindcallback");k.exports=function(a,l,c,g){g=(c="function"==typeof c?d(c,g,3):void 0)?c(a,l):void 0;return void 0===g?f(a,l,c):!!g}},{"lodash._baseisequal":112,"lodash._bindcallback":113}],118:[function(a,k,m){var f={};f["[object Float32Array]"]=f["[object Float64Array]"]=
f["[object Int8Array]"]=f["[object Int16Array]"]=f["[object Int32Array]"]=f["[object Uint8Array]"]=f["[object Uint8ClampedArray]"]=f["[object Uint16Array]"]=f["[object Uint32Array]"]=!0;f["[object Arguments]"]=f["[object Array]"]=f["[object ArrayBuffer]"]=f["[object Boolean]"]=f["[object DataView]"]=f["[object Date]"]=f["[object Error]"]=f["[object Function]"]=f["[object Map]"]=f["[object Number]"]=f["[object Object]"]=f["[object RegExp]"]=f["[object Set]"]=f["[object String]"]=f["[object WeakMap]"]=
!1;var d=Object.prototype.toString;k.exports=function(a){var l;if(l=!!a&&"object"==typeof a)l=a.length,l="number"==typeof l&&-1<l&&0==l%1&&9007199254740991>=l;return l&&!!f[d.call(a)]}},{}],119:[function(a,k,m){function f(a,b){a="number"==typeof a||h.test(a)?+a:-1;return-1<a&&0==a%1&&a<(null==b?9007199254740991:b)}function d(a){return"number"==typeof a&&-1<a&&0==a%1&&9007199254740991>=a}function n(a){var b;b=a;if(null==b)b=[];else{l(b)||(b=Object(b));for(var h=b.length,h=h&&d(h)&&(g(b)||c(b))&&h||
0,p=b.constructor,n=-1,p="function"==typeof p&&p.prototype===b,q=Array(h),k=0<h;++n<h;)q[n]=n+"";for(var m in b)k&&f(m,h)||"constructor"==m&&(p||!e.call(b,m))||q.push(m);b=q}n=(h=b.length)&&a.length;m=!!n&&d(n)&&(g(a)||c(a));p=-1;for(q=[];++p<h;)k=b[p],(m&&f(k,n)||e.call(a,k))&&q.push(k);return q}function l(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}m=a("lodash._getnative");var c=a("lodash.isarguments"),g=a("lodash.isarray"),h=/^\d+$/,e=Object.prototype.hasOwnProperty,b=m(Object,"keys"),
p=function(a){return function(b){return null==b?void 0:b[a]}}("length");k.exports=b?function(a){var c=null==a?void 0:a.constructor;return"function"==typeof c&&c.prototype===a||"function"!=typeof a&&null!=a&&d(p(a))?n(a):l(a)?b(a):[]}:n},{"lodash._getnative":114,"lodash.isarguments":115,"lodash.isarray":116}],120:[function(a,k,m){k.exports=a("./v8.json")},{"./v8.json":121}],121:[function(a,k,m){k.exports={$version:8,$root:{version:{required:!0,type:"enum",values:[8],doc:"Style specification version number. Must be 8.",
example:8},name:{type:"string",doc:"A human-readable name for the style.",example:"Bright"},metadata:{type:"*",doc:"Arbitrary properties useful to track with the stylesheet, but do not influence rendering. Properties should be prefixed to avoid collisions, like 'mapbox:'."},center:{type:"array",value:"number",doc:"Default map center in longitude and latitude.  The style center will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:[-73.9749,
40.7736]},zoom:{type:"number",doc:"Default zoom level.  The style zoom will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:12.5},bearing:{type:"number","default":0,period:360,units:"degrees",doc:"Default bearing, in degrees clockwise from true north.  The style bearing will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:29},pitch:{type:"number","default":0,units:"degrees",
doc:"Default pitch, in degrees. Zero is perpendicular to the surface, for a look straight down at the map, while a greater value like 60 looks ahead towards the horizon. The style pitch will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:50},light:{type:"light",doc:"The global light source.",example:{anchor:"viewport",color:"white",intensity:.4}},sources:{required:!0,type:"sources",doc:"Data source specifications.",example:{"mapbox-streets":{type:"vector",
url:"mapbox://mapbox.mapbox-streets-v6"}}},sprite:{type:"string",doc:"A base URL for retrieving the sprite image and metadata. The extensions `.png`, `.json` and scale factor `@2x.png` will be automatically appended. This property is required if any layer uses the `background-pattern`, `fill-pattern`, `line-pattern`, `fill-extrusion-pattern`, or `icon-image` properties.",example:"mapbox://sprites/mapbox/bright-v8"},glyphs:{type:"string",doc:"A URL template for loading signed-distance-field glyph sets in PBF format. The URL must include `{fontstack}` and `{range}` tokens. This property is required if any layer uses the `text-field` layout property.",
example:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},transition:{type:"transition",doc:"A global transition definition to use as a default across properties.",example:{duration:300,delay:0}},layers:{required:!0,type:"array",value:"layer",doc:"Layers will be drawn in the order of this array.",example:[{id:"water",source:"mapbox-streets","source-layer":"water",type:"fill",paint:{"fill-color":"#00ffff"}}]}},sources:{"*":{type:"source",doc:"Specification of a data source. For vector and raster sources, either TileJSON or a URL to a TileJSON must be provided. For image and video sources, a URL must be provided. For GeoJSON sources, a URL or inline GeoJSON must be provided."}},
source:["source_tile","source_geojson","source_video","source_image","source_canvas"],source_tile:{type:{required:!0,type:"enum",values:{vector:{doc:"A vector tile source."},raster:{doc:"A raster tile source."}},doc:"The data type of the tile source."},url:{type:"string",doc:"A URL to a TileJSON resource. Supported protocols are `http:`, `https:`, and `mapbox://<mapid>`."},tiles:{type:"array",value:"string",doc:"An array of one or more tile source URLs, as in the TileJSON spec."},minzoom:{type:"number",
"default":0,doc:"Minimum zoom level for which tiles are available, as in the TileJSON spec."},maxzoom:{type:"number","default":22,doc:"Maximum zoom level for which tiles are available, as in the TileJSON spec. Data from tiles at the maxzoom are used when displaying the map at higher zoom levels."},tileSize:{type:"number","default":512,units:"pixels",doc:"The minimum visual size to display tiles for this layer. Only configurable for raster layers."},"*":{type:"*",doc:"Other keys to configure the data source."}},
source_geojson:{type:{required:!0,type:"enum",values:{geojson:{doc:"A GeoJSON data source."}},doc:"The data type of the GeoJSON source."},data:{type:"*",doc:"A URL to a GeoJSON file, or inline GeoJSON."},maxzoom:{type:"number","default":18,doc:"Maximum zoom level at which to create vector tiles (higher means greater detail at high zoom levels)."},buffer:{type:"number","default":128,maximum:512,minimum:0,doc:"Size of the tile buffer on each side. A value of 0 produces no buffer. A value of 512 produces a buffer as wide as the tile itself. Larger values produce fewer rendering artifacts near tile edges and slower performance."},
tolerance:{type:"number","default":.375,doc:"Douglas-Peucker simplification tolerance (higher means simpler geometries and faster performance)."},cluster:{type:"boolean","default":!1,doc:"If the data is a collection of point features, setting this to true clusters the points by radius into groups."},clusterRadius:{type:"number","default":50,minimum:0,doc:"Radius of each cluster if clustering is enabled. A value of 512 indicates a radius equal to the width of a tile."},clusterMaxZoom:{type:"number",
doc:"Max zoom on which to cluster points if clustering is enabled. Defaults to one zoom less than maxzoom (so that last zoom features are not clustered)."}},source_video:{type:{required:!0,type:"enum",values:{video:{doc:"A video data source."}},doc:"The data type of the video source."},urls:{required:!0,type:"array",value:"string",doc:"URLs to video content in order of preferred format."},coordinates:{required:!0,doc:"Corners of video specified in longitude, latitude pairs.",type:"array",length:4,
value:{type:"array",length:2,value:"number",doc:"A single longitude, latitude pair."}}},source_image:{type:{required:!0,type:"enum",values:{image:{doc:"An image data source."}},doc:"The data type of the image source."},url:{required:!0,type:"string",doc:"URL that points to an image."},coordinates:{required:!0,doc:"Corners of image specified in longitude, latitude pairs.",type:"array",length:4,value:{type:"array",length:2,value:"number",doc:"A single longitude, latitude pair."}}},source_canvas:{type:{required:!0,
type:"enum",values:{canvas:{doc:"A canvas data source."}},doc:"The data type of the canvas source."},coordinates:{required:!0,doc:"Corners of canvas specified in longitude, latitude pairs.",type:"array",length:4,value:{type:"array",length:2,value:"number",doc:"A single longitude, latitude pair."}},animate:{type:"boolean","default":"true",doc:"Whether the canvas source is animated. If the canvas is static, `animate` should be set to `false` to improve performance."},canvas:{type:"string",required:!0,
doc:"HTML ID of the canvas from which to read pixels."}},layer:{id:{type:"string",doc:"Unique layer name.",required:!0},type:{type:"enum",values:{fill:{doc:"A filled polygon with an optional stroked border.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},line:{doc:"A stroked line.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},symbol:{doc:"An icon or a text label.","sdk-support":{"basic functionality":{js:"0.10.0",
android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},circle:{doc:"A filled circle.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},"fill-extrusion":{doc:"An extruded (3D) polygon.","sdk-support":{"basic functionality":{js:"0.27.0"}}},raster:{doc:"Raster map textures such as satellite imagery.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},normal:{doc:"Normal mapping textures","sdk-support":{"basic functionality":{js:"0.10.0",
android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},background:{doc:"The background color or pattern of the map.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}}},doc:"Rendering type of this layer."},metadata:{type:"*",doc:"Arbitrary properties useful to track with the layer, but do not influence rendering. Properties should be prefixed to avoid collisions, like 'mapbox:'."},ref:{type:"string",doc:"References another layer to copy `type`, `source`, `source-layer`, `minzoom`, `maxzoom`, `filter`, and `layout` properties from. This allows the layers to share processing and be more efficient."},
source:{type:"string",doc:"Name of a source description to be used for this layer."},"source-layer":{type:"string",doc:"Layer to use from a vector tile source. Required if the source supports multiple layers."},minzoom:{type:"number",minimum:0,maximum:24,doc:"The minimum zoom level on which the layer gets parsed and appears on."},maxzoom:{type:"number",minimum:0,maximum:24,doc:"The maximum zoom level on which the layer gets parsed and appears on."},filter:{type:"filter",doc:"A expression specifying conditions on source features. Only features that match the filter are displayed."},
layout:{type:"layout",doc:"Layout properties for the layer."},paint:{type:"paint",doc:"Default paint properties for this layer."},"paint.*":{type:"paint",doc:"[Deprecated] Class-specific paint properties for this layer. The class name is the part after the first dot. Note: style classes are deprecated and will be removed in the next version of this spec."}},layout:"layout_fill layout_line layout_circle layout_fill-extrusion layout_symbol layout_raster layout_background".split(" "),layout_background:{visibility:{type:"enum",
values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},"default":"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}}},layout_fill:{visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},"default":"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}}},
layout_circle:{visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},"default":"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},"default":"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.27.0"}}}},
layout_line:{"line-cap":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{butt:{doc:"A cap with a squared-off end which is drawn to the exact endpoint of the line."},round:{doc:"A cap with a rounded end which is drawn beyond the endpoint of the line at a radius of one-half of the line's width and centered on the endpoint of the line."},square:{doc:"A cap with a squared-off end which is drawn beyond the endpoint of the line at a distance of one-half of the line's width."}},"default":"butt",
doc:"The display of line endings.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"line-join":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{bevel:{doc:"A join with a squared-off end which is drawn beyond the endpoint of the line at a distance of one-half of the line's width."},round:{doc:"A join with a rounded end which is drawn beyond the endpoint of the line at a radius of one-half of the line's width and centered on the endpoint of the line."},
miter:{doc:"A join with a sharp, angled corner which is drawn with the outer sides beyond the endpoint of the path until they meet."}},"default":"miter",doc:"The display of lines when joining.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"line-miter-limit":{type:"number","default":2,"function":"interpolated","zoom-function":!0,doc:"Used to automatically convert miter joins to bevel joins for sharp angles.",requires:[{"line-join":"miter"}],
"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"line-round-limit":{type:"number","default":1.05,"function":"interpolated","zoom-function":!0,doc:"Used to automatically convert round joins to miter joins for shallow angles.",requires:[{"line-join":"round"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},
none:{doc:"The layer is not shown."}},"default":"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}}},layout_symbol:{"symbol-placement":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{point:{doc:"The label is placed at the point where the geometry is located."},line:{doc:"The label is placed along the line of the geometry. Can only be used on `LineString` and `Polygon` geometries."}},
"default":"point",doc:"Label placement relative to its geometry.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"symbol-spacing":{type:"number","default":250,minimum:1,"function":"interpolated","zoom-function":!0,units:"pixels",doc:"Distance between two symbol anchors.",requires:[{"symbol-placement":"line"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},
"symbol-avoid-edges":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"default":!1,doc:"If true, the symbols will not cross tile edges to avoid mutual collisions. Recommended in layers that don't have enough padding in the vector tile to prevent collisions, or if it is a point symbol layer placed after a line symbol layer.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"icon-allow-overlap":{type:"boolean",
"function":"piecewise-constant","zoom-function":!0,"default":!1,doc:"If true, the icon will be visible even if it collides with other previously drawn symbols.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"icon-ignore-placement":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"default":!1,doc:"If true, other symbols can be visible even if they collide with the icon.",requires:["icon-image"],
"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"icon-optional":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"default":!1,doc:"If true, text will display without their corresponding icons when the icon collides with other symbols and the text does not.",requires:["icon-image","text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},
"icon-rotation-alignment":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{map:{doc:"When `symbol-placement` is set to `point`, aligns icons east-west. When `symbol-placement` is set to `line`, aligns icon x-axes with the line."},viewport:{doc:"Produces icons whose x-axes are aligned with the x-axis of the viewport, regardless of the value of `symbol-placement`."},auto:{doc:"When `symbol-placement` is set to `point`, this is equivalent to `viewport`. When `symbol-placement` is set to `line`, this is equivalent to `map`."}},
"default":"auto",doc:"In combination with `symbol-placement`, determines the rotation behavior of icons.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"`auto` value":{js:"0.25.0",android:"4.2.0",ios:"3.4.0",macos:"0.3.0"},"data-driven styling":{}}},"icon-size":{type:"number","default":1,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,doc:"Scale factor for icon. 1 is original size, 3 triples the size.",
requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0"}}},"icon-text-fit":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{none:{doc:"The icon is displayed at its intrinsic aspect ratio."},width:{doc:"The icon is scaled in the x-dimension to fit the width of the text."},height:{doc:"The icon is scaled in the y-dimension to fit the height of the text."},both:{doc:"The icon is scaled in both x- and y-dimensions."}},
"default":"none",doc:"Scales the icon to fit around the associated text.",requires:["icon-image","text-field"],"sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"},"data-driven styling":{}}},"icon-text-fit-padding":{type:"array",value:"number",length:4,"default":[0,0,0,0],units:"pixels","function":"interpolated","zoom-function":!0,doc:"Size of the additional area added to dimensions determined by `icon-text-fit`, in clockwise order: top, right, bottom, left.",
requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"},"data-driven styling":{}}},"icon-image":{type:"string","function":"piecewise-constant","zoom-function":!0,"property-function":!0,doc:"Name of image in sprite to use for drawing an image background. A string with {tokens} replaced, referencing the data property to pull from.",tokens:!0,"sdk-support":{"basic functionality":{js:"0.10.0",
android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0"}}},"icon-rotate":{type:"number","default":0,period:360,"function":"interpolated","zoom-function":!0,"property-function":!0,units:"degrees",doc:"Rotates the icon clockwise.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.21.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},"icon-padding":{type:"number","default":2,minimum:0,"function":"interpolated",
"zoom-function":!0,units:"pixels",doc:"Size of the additional area around the icon bounding box used for detecting symbol collisions.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"icon-keep-upright":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"default":!1,doc:"If true, the icon may be flipped to prevent it from being rendered upside-down.",requires:["icon-image",{"icon-rotation-alignment":"map"},
{"symbol-placement":"line"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"icon-offset":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated","zoom-function":!0,"property-function":!0,doc:"Offset distance of icon from its anchor. Positive values indicate right and down, while negative values indicate left and up. When combined with `icon-rotate` the offset will be as if the rotated direction was up.",
requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},"text-pitch-alignment":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{map:{doc:"The text is aligned to the plane of the map."},viewport:{doc:"The text is aligned to the plane of the viewport."},auto:{doc:"Automatically matches the value of `text-rotation-alignment`."}},"default":"auto",
doc:"Orientation of text when map is pitched.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"},"`auto` value":{js:"0.25.0",android:"4.2.0",ios:"3.4.0",macos:"0.3.0"},"data-driven styling":{}}},"text-rotation-alignment":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{map:{doc:"When `symbol-placement` is set to `point`, aligns text east-west. When `symbol-placement` is set to `line`, aligns text x-axes with the line."},
viewport:{doc:"Produces glyphs whose x-axes are aligned with the x-axis of the viewport, regardless of the value of `symbol-placement`."},auto:{doc:"When `symbol-placement` is set to `point`, this is equivalent to `viewport`. When `symbol-placement` is set to `line`, this is equivalent to `map`."}},"default":"auto",doc:"In combination with `symbol-placement`, determines the rotation behavior of the individual glyphs forming the text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",
android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"`auto` value":{js:"0.25.0",android:"4.2.0",ios:"3.4.0",macos:"0.3.0"},"data-driven styling":{}}},"text-field":{type:"string","function":"piecewise-constant","zoom-function":!0,"property-function":!0,"default":"",tokens:!0,doc:"Value to use for a text label. Feature properties are specified using tokens like {field_name}.  (Token replacement is only supported for literal `text-field` values--not for property functions.)","sdk-support":{"basic functionality":{js:"0.10.0",
android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},"text-font":{type:"array",value:"string","function":"piecewise-constant","zoom-function":!0,"default":["Open Sans Regular","Arial Unicode MS Regular"],doc:"Font stack to use for displaying text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"text-size":{type:"number","default":16,
minimum:0,units:"pixels","function":"interpolated","zoom-function":!0,"property-function":!0,doc:"Font size.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0"}}},"text-max-width":{type:"number","default":10,minimum:0,units:"ems","function":"interpolated","zoom-function":!0,doc:"The maximum line width for text wrapping.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",
ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"text-line-height":{type:"number","default":1.2,units:"ems","function":"interpolated","zoom-function":!0,doc:"Text leading value for multi-line text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"text-letter-spacing":{type:"number","default":0,units:"ems","function":"interpolated","zoom-function":!0,doc:"Text tracking amount.",requires:["text-field"],
"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"text-justify":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{left:{doc:"The text is aligned to the left."},center:{doc:"The text is centered."},right:{doc:"The text is aligned to the right."}},"default":"center",doc:"Text justification options.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},
"data-driven styling":{}}},"text-anchor":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{center:{doc:"The center of the text is placed closest to the anchor."},left:{doc:"The left side of the text is placed closest to the anchor."},right:{doc:"The right side of the text is placed closest to the anchor."},top:{doc:"The top of the text is placed closest to the anchor."},bottom:{doc:"The bottom of the text is placed closest to the anchor."},"top-left":{doc:"The top left corner of the text is placed closest to the anchor."},
"top-right":{doc:"The top right corner of the text is placed closest to the anchor."},"bottom-left":{doc:"The bottom left corner of the text is placed closest to the anchor."},"bottom-right":{doc:"The bottom right corner of the text is placed closest to the anchor."}},"default":"center",doc:"Part of the text placed closest to the anchor.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"text-max-angle":{type:"number",
"default":45,units:"degrees","function":"interpolated","zoom-function":!0,doc:"Maximum angle change between adjacent characters.",requires:["text-field",{"symbol-placement":"line"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"text-rotate":{type:"number","default":0,period:360,units:"degrees","function":"interpolated","zoom-function":!0,"property-function":!0,doc:"Rotates the text clockwise.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",
android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0"}}},"text-padding":{type:"number","default":2,minimum:0,units:"pixels","function":"interpolated","zoom-function":!0,doc:"Size of the additional area around the text bounding box used for detecting symbol collisions.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"text-keep-upright":{type:"boolean","function":"piecewise-constant",
"zoom-function":!0,"default":!0,doc:"If true, the text may be flipped vertically to prevent it from being rendered upside-down.",requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":"line"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"text-transform":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:{none:{doc:"The text is not altered."},uppercase:{doc:"Forces all letters to be displayed in uppercase."},
lowercase:{doc:"Forces all letters to be displayed in lowercase."}},"default":"none",doc:"Specifies how to capitalize text, similar to the CSS `text-transform` property.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},"text-offset":{type:"array",doc:"Offset distance of text from its anchor. Positive values indicate right and down, while negative values indicate left and up.",
value:"number",units:"ems","function":"interpolated","zoom-function":!0,"property-function":!0,length:2,"default":[0,0],requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0"}}},"text-allow-overlap":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"default":!1,doc:"If true, the text will be visible even if it collides with other previously drawn symbols.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",
android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"text-ignore-placement":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"default":!1,doc:"If true, other symbols can be visible even if they collide with the text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"text-optional":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"default":!1,doc:"If true, icons will display without their corresponding text when the text collides with other symbols and the icon does not.",
requires:["text-field","icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},"default":"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}}},layout_raster:{visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},
none:{doc:"The layer is not shown."}},"default":"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}}},filter:{type:"array",value:"*",doc:"A filter selects specific features from a layer."},filter_operator:{type:"enum",values:{"==":{doc:'`["==", key, value]` equality: `feature[key] = value`'},"!=":{doc:'`["!=", key, value]` inequality: `feature[key] \u2260 value`'},">":{doc:'`[">", key, value]` greater than: `feature[key] > value`'},
">=":{doc:'`[">=", key, value]` greater than or equal: `feature[key] \u2265 value`'},"<":{doc:'`["<", key, value]` less than: `feature[key] < value`'},"<=":{doc:'`["<=", key, value]` less than or equal: `feature[key] \u2264 value`'},"in":{doc:'`["in", key, v0, ..., vn]` set inclusion: `feature[key] \u2208 {v0, ..., vn}`'},"!in":{doc:'`["!in", key, v0, ..., vn]` set exclusion: `feature[key] \u2209 {v0, ..., vn}`'},all:{doc:'`["all", f0, ..., fn]` logical `AND`: `f0 \u2227 ... \u2227 fn`'},any:{doc:'`["any", f0, ..., fn]` logical `OR`: `f0 \u2228 ... \u2228 fn`'},
none:{doc:'`["none", f0, ..., fn]` logical `NOR`: `\u00acf0 \u2227 ... \u2227 \u00acfn`'},has:{doc:'`["has", key]` `feature[key]` exists'},"!has":{doc:'`["!has", key]` `feature[key]` does not exist'}},doc:"The filter operator."},geometry_type:{type:"enum",values:{Point:{doc:"Filter to point geometries."},LineString:{doc:"Filter to line geometries."},Polygon:{doc:"Filter to polygon geometries."}},doc:"The geometry type for the filter to select."},"function":{stops:{type:"array",doc:"An array of stops.",
value:"function_stop"},base:{type:"number","default":1,minimum:0,doc:"The exponential base of the interpolation curve. It controls the rate at which the result increases. Higher values make the result increase more towards the high end of the range. With `1` the stops are interpolated linearly."},property:{type:"string",doc:"The name of a feature property to use as the function input.","default":"$zoom"},type:{type:"enum",values:{identity:{doc:"Return the input value as the output value."},exponential:{doc:"Generate an output by interpolating between stops just less than and just greater than the function input."},
interval:{doc:"Return the output value of the stop just less than the function input."},categorical:{doc:"Return the output value of the stop equal to the function input."}},doc:"The interpolation strategy to use in function evaluation.","default":"exponential"},colorSpace:{type:"enum",values:{rgb:{doc:"Use the RGB color space to interpolate color values"},lab:{doc:"Use the LAB color space to interpolate color values."},hcl:{doc:"Use the HCL color space to interpolate color values, interpolating the Hue, Chroma, and Luminance channels individually."}},
doc:"The color space in which colors interpolated. Interpolating colors in perceptual color spaces like LAB and HCL tend to produce color ramps that look more consistent and produce colors that can be differentiated more easily than those interpolated in RGB space.","default":"rgb"},"default":{type:"*",required:!1,doc:"A value to serve as a fallback function result when a value isn't otherwise available. It is used in the following circumstances:\n* In categorical functions, when the feature value does not match any of the stop domain values.\n* In property and zoom-and-property functions, when a feature does not contain a value for the specified property.\n* In identity functions, when the feature value is not valid for the style property (for example, if the function is being used for a `circle-color` property but the feature property value is not a string or not a valid color).\n* In interval or exponential property and zoom-and-property functions, when the feature value is not numeric.\nIf no default is provided, the style property's default is used in these circumstances."}},
function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2,doc:"Zoom level and value pair."},light:{anchor:{type:"enum","default":"viewport",values:{map:{doc:"The position of the light source is aligned to the rotation of the map."},viewport:{doc:"The position of the light source is aligned to the rotation of the viewport."}},transition:!1,"zoom-function":!0,"property-function":!1,"function":"piecewise-constant",doc:"Whether extruded geometries are lit relative to the map or viewport.",
example:"map","sdk-support":{"basic functionality":{js:"0.27.0"}}},position:{type:"array","default":[1.15,210,30],length:3,value:"number",transition:!0,"function":"interpolated","zoom-function":!0,"property-function":!1,doc:"Position of the light source relative to lit (extruded) geometries, in [r radial coordinate, a azimuthal angle, p polar angle] where r indicates the distance from the center of the base of an object to its light, a indicates the position of the light relative to 0\u00b0 (0\u00b0 when `light.anchor` is set to `viewport` corresponds to the top of the viewport, or 0\u00b0 when `light.anchor` is set to `map` corresponds to due north, and degrees proceed clockwise), and p indicates the height of the light (from 0\u00b0, directly above, to 180\u00b0, directly below).",
example:[1.5,90,80],"sdk-support":{"basic functionality":{js:"0.27.0"}}},color:{type:"color","default":"#ffffff","function":"interpolated","zoom-function":!0,"property-function":!1,transition:!0,doc:"Color tint for lighting extruded geometries.","sdk-support":{"basic functionality":{js:"0.27.0"}}},intensity:{type:"number","default":.5,minimum:0,maximum:1,"function":"interpolated","zoom-function":!0,"property-function":!1,transition:!0,doc:"Intensity of lighting (on a scale from 0 to 1). Higher numbers will present as more extreme contrast.",
"sdk-support":{"basic functionality":{js:"0.27.0"}}}},paint:"paint_fill paint_line paint_circle paint_fill-extrusion paint_symbol paint_raster paint_background".split(" "),paint_fill:{"fill-antialias":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"default":!0,doc:"Whether or not the fill should be antialiased.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"fill-opacity":{type:"number","function":"interpolated",
"zoom-function":!0,"property-function":!0,"default":1,minimum:0,maximum:1,doc:"The opacity of the entire fill layer. In contrast to the `fill-color`, this value will also affect the 1px stroke around the fill, if the stroke is used.",transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.21.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},"fill-color":{type:"color","default":"#000000",doc:"The color of the filled part of this layer. This color can be specified as `rgba` with an alpha component and the color's opacity will not affect the opacity of the 1px stroke, if it is used.",
"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.19.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},"fill-outline-color":{type:"color",doc:"The outline color of the fill. Matches the value of `fill-color` if unspecified.","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-pattern"},
{"fill-antialias":!0}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.19.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},"fill-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated","zoom-function":!0,transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",
ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"fill-translate-anchor":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{map:{doc:"The fill is translated relative to the map."},viewport:{doc:"The fill is translated relative to the viewport."}},doc:"Controls the translation reference point.","default":"map",requires:["fill-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"fill-pattern":{type:"string",
"function":"piecewise-constant","zoom-function":!0,transition:!0,doc:"Name of image in sprite to use for drawing image fills. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512).","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number","function":"interpolated","zoom-function":!0,"property-function":!1,"default":1,minimum:0,maximum:1,
doc:"The opacity of the entire fill extrusion layer. This is rendered on a per-layer, not per-feature, basis, and data-driven styling is not available.",transition:!0,"sdk-support":{"basic functionality":{js:"0.27.0"}}},"fill-extrusion-color":{type:"color","default":"#000000",doc:"The base color of the extruded fill. The extrusion's surfaces will be shaded differently based on this color in combination with the root `light` settings. If this color is specified as `rgba` with an alpha component, the alpha component will be ignored; use `fill-extrusion-opacity` to set layer opacity.",
"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-extrusion-pattern"}],"sdk-support":{"basic functionality":{js:"0.27.0"},"data-driven styling":{js:"0.27.0"}}},"fill-extrusion-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated","zoom-function":!0,transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up (on the flat plane), respectively.","sdk-support":{"basic functionality":{js:"0.27.0"},
"data-driven styling":{}}},"fill-extrusion-translate-anchor":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{map:{doc:"The fill extrusion is translated relative to the map."},viewport:{doc:"The fill extrusion is translated relative to the viewport."}},doc:"Controls the translation reference point.","default":"map",requires:["fill-extrusion-translate"],"sdk-support":{"basic functionality":{js:"0.27.0"},"data-driven styling":{}}},"fill-extrusion-pattern":{type:"string","function":"piecewise-constant",
"zoom-function":!0,transition:!0,doc:"Name of image in sprite to use for drawing images on extruded fills. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512).","sdk-support":{"basic functionality":{js:"0.27.0"},"data-driven styling":{}}},"fill-extrusion-height":{type:"number","function":"interpolated","zoom-function":!0,"property-function":!0,"default":0,minimum:0,maximum:65535,units:"meters",doc:"The height with which to extrude this layer.",transition:!0,"sdk-support":{"basic functionality":{js:"0.27.0"},
"data-driven styling":{js:"0.27.0"}}},"fill-extrusion-base":{type:"number","function":"interpolated","zoom-function":!0,"property-function":!0,"default":0,minimum:0,maximum:65535,units:"meters",doc:"The height with which to extrude the base of this layer. Must be less than or equal to `fill-extrusion-height`.",transition:!0,requires:["fill-extrusion-height"],"sdk-support":{"basic functionality":{js:"0.27.0"},"data-driven styling":{js:"0.27.0"}}}},paint_line:{"line-opacity":{type:"number",doc:"The opacity at which the line will be drawn.",
"function":"interpolated","zoom-function":!0,"property-function":!0,"default":1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},"line-color":{type:"color",doc:"The color with which the line will be drawn.","default":"#000000","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"line-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",
android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.23.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},"line-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated","zoom-function":!0,transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"line-translate-anchor":{type:"enum",
"function":"piecewise-constant","zoom-function":!0,values:{map:{doc:"The line is translated relative to the map."},viewport:{doc:"The line is translated relative to the viewport."}},doc:"Controls the translation reference point.","default":"map",requires:["line-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"line-width":{type:"number","default":1,minimum:0,"function":"interpolated","zoom-function":!0,transition:!0,
units:"pixels",doc:"Stroke thickness.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"line-gap-width":{type:"number","default":0,minimum:0,doc:"Draws a line casing outside of a line's actual path. Value indicates the width of the inner gap.","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},
"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},"line-offset":{type:"number","default":0,doc:"The line's offset. For linear features, a positive value offsets the line to the right, relative to the direction of the line, and a negative value to the left. For polygon features, a positive value results in an inset, and a negative value results in an outset.","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels","sdk-support":{"basic functionality":{js:"0.12.1",
android:"3.0.0",ios:"3.1.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},"line-blur":{type:"number","default":0,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",doc:"Blur applied to the line, in pixels.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},"line-dasharray":{type:"array",
value:"number","function":"piecewise-constant","zoom-function":!0,doc:"Specifies the lengths of the alternating dashes and gaps that form the dash pattern. The lengths are later scaled by the line width. To convert a dash length to pixels, multiply the length by the current line width.",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"line-pattern":{type:"string",
"function":"piecewise-constant","zoom-function":!0,transition:!0,doc:"Name of image in sprite to use for drawing image lines. For seamless patterns, image width must be a factor of two (2, 4, 8, ..., 512).","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}}},paint_circle:{"circle-radius":{type:"number","default":5,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",doc:"Circle radius.",
"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.18.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},"circle-color":{type:"color","default":"#000000",doc:"The fill color of the circle.","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.18.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},
"circle-blur":{type:"number","default":0,doc:"Amount to blur the circle. 1 blurs the circle such that only the centerpoint is full opacity.","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.20.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},"circle-opacity":{type:"number",doc:"The opacity at which the circle will be drawn.","default":1,minimum:0,
maximum:1,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.20.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},"circle-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated","zoom-function":!0,transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively.",
"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"circle-translate-anchor":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{map:{doc:"The circle is translated relative to the map."},viewport:{doc:"The circle is translated relative to the viewport."}},doc:"Controls the translation reference point.","default":"map",requires:["circle-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",
ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"circle-pitch-scale":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{map:{doc:"Circles are scaled according to their apparent distance to the camera."},viewport:{doc:"Circles are not scaled."}},"default":"map",doc:"Controls the scaling behavior of the circle when the map is pitched.","sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"},"data-driven styling":{}}},"circle-stroke-width":{type:"number",
"default":0,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",doc:"The width of the circle's stroke. Strokes are placed outside of the `circle-radius`.","sdk-support":{"basic functionality":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},"circle-stroke-color":{type:"color","default":"#000000",doc:"The stroke color of the circle.","function":"interpolated",
"zoom-function":!0,"property-function":!0,transition:!0,"sdk-support":{"basic functionality":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},"circle-stroke-opacity":{type:"number",doc:"The opacity of the circle's stroke.","default":1,minimum:0,maximum:1,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,"sdk-support":{"basic functionality":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",
macos:"0.4.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}}},paint_symbol:{"icon-opacity":{doc:"The opacity at which the icon will be drawn.",type:"number","default":1,minimum:0,maximum:1,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},
"icon-color":{type:"color","default":"#000000","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,doc:"The color of the icon. This can only be used with sdf icons.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},"icon-halo-color":{type:"color","default":"rgba(0, 0, 0, 0)","function":"interpolated","zoom-function":!0,"property-function":!0,
transition:!0,doc:"The color of the icon's halo. Icon halos can only be used with SDF icons.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},"icon-halo-width":{type:"number","default":0,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",doc:"Distance of halo to the icon outline.",requires:["icon-image"],
"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},"icon-halo-blur":{type:"number","default":0,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",doc:"Fade out the halo towards the outside.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",
android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},"icon-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated","zoom-function":!0,transition:!0,units:"pixels",doc:"Distance that the icon's anchor is moved from its original placement. Positive values indicate right and down, while negative values indicate left and up.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"icon-translate-anchor":{type:"enum",
"function":"piecewise-constant","zoom-function":!0,values:{map:{doc:"Icons are translated relative to the map."},viewport:{doc:"Icons are translated relative to the viewport."}},doc:"Controls the translation reference point.","default":"map",requires:["icon-image","icon-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"text-opacity":{type:"number",doc:"The opacity at which the text will be drawn.","default":1,minimum:0,
maximum:1,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},"text-color":{type:"color",doc:"The color with which the text will be drawn.","default":"#000000","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",
android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},"text-halo-color":{type:"color","default":"rgba(0, 0, 0, 0)","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,doc:"The color of the text's halo, which helps it stand out from backgrounds.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",
ios:"3.5.0",macos:"0.4.0"}}},"text-halo-width":{type:"number","default":0,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",doc:"Distance of halo to the font outline. Max text halo width is 1/4 of the font-size.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},"text-halo-blur":{type:"number","default":0,
minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",doc:"The halo's fadeout distance towards the outside.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}}},"text-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated","zoom-function":!0,transition:!0,units:"pixels",
doc:"Distance that the text's anchor is moved from its original placement. Positive values indicate right and down, while negative values indicate left and up.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"text-translate-anchor":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{map:{doc:"The text is translated relative to the map."},viewport:{doc:"The text is translated relative to the viewport."}},
doc:"Controls the translation reference point.","default":"map",requires:["text-field","text-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}}},paint_raster:{"raster-opacity":{type:"number",doc:"The opacity at which the image will be drawn.","default":1,minimum:0,maximum:1,"function":"interpolated","zoom-function":!0,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},
"data-driven styling":{}}},"raster-hue-rotate":{type:"number","default":0,period:360,"function":"interpolated","zoom-function":!0,transition:!0,units:"degrees",doc:"Rotates hues around the color wheel.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"raster-brightness-min":{type:"number","function":"interpolated","zoom-function":!0,doc:"Increase or reduce the brightness of the image. The value is the minimum brightness.","default":0,
minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"raster-brightness-max":{type:"number","function":"interpolated","zoom-function":!0,doc:"Increase or reduce the brightness of the image. The value is the maximum brightness.","default":1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"raster-saturation":{type:"number",
doc:"Increase or reduce the saturation of the image.","default":0,minimum:-1,maximum:1,"function":"interpolated","zoom-function":!0,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"raster-contrast":{type:"number",doc:"Increase or reduce the contrast of the image.","default":0,minimum:-1,maximum:1,"function":"interpolated","zoom-function":!0,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",
ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"raster-fade-duration":{type:"number","default":300,minimum:0,"function":"interpolated","zoom-function":!0,transition:!0,units:"milliseconds",doc:"Fade duration when a new tile is added.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}}},paint_normal:{"normal-opacity":{type:"number",doc:"The opacity at which the image will be drawn.","default":1,minimum:0,maximum:1,"function":"interpolated",
"zoom-function":!0,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"normal-hue-rotate":{type:"number","default":0,period:360,"function":"interpolated","zoom-function":!0,transition:!0,units:"degrees",doc:"Rotates hues around the color wheel.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"normal-brightness-min":{type:"number","function":"interpolated",
"zoom-function":!0,doc:"Increase or reduce the brightness of the image. The value is the minimum brightness.","default":0,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"normal-brightness-max":{type:"number","function":"interpolated","zoom-function":!0,doc:"Increase or reduce the brightness of the image. The value is the maximum brightness.","default":1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",
android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"normal-saturation":{type:"number",doc:"Increase or reduce the saturation of the image.","default":0,minimum:-1,maximum:1,"function":"interpolated","zoom-function":!0,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"normal-contrast":{type:"number",doc:"Increase or reduce the contrast of the image.","default":0,minimum:-1,maximum:1,"function":"interpolated",
"zoom-function":!0,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}},"normal-fade-duration":{type:"number","default":300,minimum:0,"function":"interpolated","zoom-function":!0,transition:!0,units:"milliseconds",doc:"Fade duration when a new tile is added.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}}}},paint_background:{"background-color":{type:"color",
"default":"#000000",doc:"The color with which the background will be drawn.","function":"interpolated","zoom-function":!0,transition:!0,requires:[{"!":"background-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},"background-pattern":{type:"string","function":"piecewise-constant","zoom-function":!0,transition:!0,doc:"Name of image in sprite to use for drawing an image background. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512).",
"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},"background-opacity":{type:"number","default":1,minimum:0,maximum:1,doc:"The opacity at which the background will be drawn.","function":"interpolated","zoom-function":!0,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}}},transition:{duration:{type:"number","default":300,minimum:0,units:"milliseconds",doc:"Time allotted for transitions to complete."},
delay:{type:"number","default":0,minimum:0,units:"milliseconds",doc:"Length of time before a transition begins."}}}},{}],122:[function(a,k,m){k.exports=function(a){for(var d=[],f=arguments.length-1;0<f--;)d[f]=arguments[f+1];for(f=0;f<d.length;f+=1){var l=d[f],c;for(c in l)a[c]=l[c]}return a}},{}],123:[function(a,k,m){k.exports=function(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":null===a?"null":typeof a}},{}],124:[function(a,
k,m){function f(a,f,l){return a*(1-l)+f*l}k.exports=f;f.number=f;f.vec2=function(a,n,l){return[f(a[0],n[0],l),f(a[1],n[1],l)]};f.color=function(a,n,l){return[f(a[0],n[0],l),f(a[1],n[1],l),f(a[2],n[2],l),f(a[3],n[3],l)]};f.array=function(a,n,l){return a.map(function(a,d){return f(a,n[d],l)})}},{}],125:[function(a,k,m){var f=a("csscolorparser").parseCSSColor;k.exports=function(a){if("string"===typeof a)return(a=f(a))?[a[0]/255*a[3],a[1]/255*a[3],a[2]/255*a[3],a[3]]:void 0;if(Array.isArray(a))return a}},
{csscolorparser:110}],126:[function(a,k,m){k.exports="type source source-layer minzoom maxzoom filter layout".split(" ")},{}],127:[function(a,k,m){k.exports=function(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}},{}],128:[function(a,k,m){var f=a("../error/validation_error"),d=a("../util/get_type"),n=a("../util/extend");k.exports=function(l){var c=a("./validate_function"),g=a("./validate_object"),h={"*":function(){return[]},array:a("./validate_array"),"boolean":a("./validate_boolean"),
number:a("./validate_number"),color:a("./validate_color"),constants:a("./validate_constants"),"enum":a("./validate_enum"),filter:a("./validate_filter"),"function":a("./validate_function"),layer:a("./validate_layer"),object:a("./validate_object"),source:a("./validate_source"),light:a("./validate_light"),string:a("./validate_string")},e=l.value,b=l.valueSpec,p=l.key,q=l.styleSpec,r=l.style;if("string"===d(e)&&"@"===e[0]){if(7<q.$version)return[new f(p,e,"constants have been deprecated as of v8")];if(!(e in
r.constants))return[new f(p,e,'constant "%s" not found',e)];l=n({},l,{value:r.constants[e]})}return b["function"]&&"object"===d(e)?c(l):b.type&&h[b.type]?h[b.type](l):g(n({},l,{valueSpec:b.type?q[b.type]:b}))}},{"../error/validation_error":105,"../util/extend":122,"../util/get_type":123,"./validate_array":129,"./validate_boolean":130,"./validate_color":131,"./validate_constants":132,"./validate_enum":133,"./validate_filter":134,"./validate_function":135,"./validate_layer":137,"./validate_light":139,
"./validate_number":140,"./validate_object":141,"./validate_source":144,"./validate_string":145}],129:[function(a,k,m){var f=a("../util/get_type"),d=a("./validate"),n=a("../error/validation_error");k.exports=function(a){var c=a.value,g=a.valueSpec,h=a.style,e=a.styleSpec,b=a.key;a=a.arrayElementValidator||d;if("array"!==f(c))return[new n(b,c,"array expected, %s found",f(c))];if(g.length&&c.length!==g.length)return[new n(b,c,"array length %d expected, length %d found",g.length,c.length)];if(g["min-length"]&&
c.length<g["min-length"])return[new n(b,c,"array length at least %d expected, length %d found",g["min-length"],c.length)];var p={type:g.value};7>e.$version&&(p["function"]=g["function"]);"object"===f(g.value)&&(p=g.value);for(var g=[],l=0;l<c.length;l++)g=g.concat(a({array:c,arrayIndex:l,value:c[l],valueSpec:p,style:h,styleSpec:e,key:b+"["+l+"]"}));return g}},{"../error/validation_error":105,"../util/get_type":123,"./validate":128}],130:[function(a,k,m){var f=a("../util/get_type"),d=a("../error/validation_error");
k.exports=function(a){var l=a.value;a=a.key;var c=f(l);return"boolean"!==c?[new d(a,l,"boolean expected, %s found",c)]:[]}},{"../error/validation_error":105,"../util/get_type":123}],131:[function(a,k,m){var f=a("../error/validation_error"),d=a("../util/get_type"),n=a("csscolorparser").parseCSSColor;k.exports=function(a){var c=a.key;a=a.value;var g=d(a);return"string"!==g?[new f(c,a,"color expected, %s found",g)]:null===n(a)?[new f(c,a,'color expected, "%s" found',a)]:[]}},{"../error/validation_error":105,
"../util/get_type":123,csscolorparser:110}],132:[function(a,k,m){var f=a("../error/validation_error"),d=a("../util/get_type");k.exports=function(a){var l=a.key,c=a.value;if(7<a.styleSpec.$version)return c?[new f(l,c,"constants have been deprecated as of v8")]:[];a=d(c);if("object"!==a)return[new f(l,c,"object expected, %s found",a)];a=[];for(var g in c)"@"!==g[0]&&a.push(new f(l+"."+g,c[g],'constants must start with "@"'));return a}},{"../error/validation_error":105,"../util/get_type":123}],133:[function(a,
k,m){var f=a("../error/validation_error"),d=a("../util/unbundle_jsonlint");k.exports=function(a){var l=a.key,c=a.value;a=a.valueSpec;var g=[];Array.isArray(a.values)?-1===a.values.indexOf(d(c))&&g.push(new f(l,c,"expected one of [%s], %s found",a.values.join(", "),c)):-1===Object.keys(a.values).indexOf(d(c))&&g.push(new f(l,c,"expected one of [%s], %s found",Object.keys(a.values).join(", "),c));return g}},{"../error/validation_error":105,"../util/unbundle_jsonlint":127}],134:[function(a,k,m){var f=
a("../error/validation_error"),d=a("./validate_enum"),n=a("../util/get_type"),l=a("../util/unbundle_jsonlint");k.exports=function g(a){var e=a.value,b=a.key,h=a.styleSpec,q,r=[];if("array"!==n(e))return[new f(b,e,"array expected, %s found",n(e))];if(1>e.length)return[new f(b,e,"filter array must have at least 1 element")];r=r.concat(d({key:b+"[0]",value:e[0],valueSpec:h.filter_operator,style:a.style,styleSpec:a.styleSpec}));switch(l(e[0])){case "<":case "<=":case ">":case ">=":2<=e.length&&"$type"===
l(e[1])&&r.push(new f(b,e,'"$type" cannot be use with operator "%s"',e[0]));case "==":case "!=":3!==e.length&&r.push(new f(b,e,'filter array for operator "%s" must have 3 elements',e[0]));case "in":case "!in":2<=e.length&&(q=n(e[1]),"string"!==q&&r.push(new f(b+"[1]",e[1],"string expected, %s found",q)));for(var k=2;k<e.length;k++)q=n(e[k]),"$type"===l(e[1])?r=r.concat(d({key:b+"["+k+"]",value:e[k],valueSpec:h.geometry_type,style:a.style,styleSpec:a.styleSpec})):"string"!==q&&"number"!==q&&"boolean"!==
q&&r.push(new f(b+"["+k+"]",e[k],"string, number, or boolean expected, %s found",q));break;case "any":case "all":case "none":for(h=1;h<e.length;h++)r=r.concat(g({key:b+"["+h+"]",value:e[h],style:a.style,styleSpec:a.styleSpec}));break;case "has":case "!has":q=n(e[1]),2!==e.length?r.push(new f(b,e,'filter array for "%s" operator must have 2 elements',e[0])):"string"!==q&&r.push(new f(b+"[1]",e[1],"string expected, %s found",q))}return r}},{"../error/validation_error":105,"../util/get_type":123,"../util/unbundle_jsonlint":127,
"./validate_enum":133}],135:[function(a,k,m){var f=a("../error/validation_error"),d=a("../util/get_type"),n=a("./validate"),l=a("./validate_object"),c=a("./validate_array"),g=a("./validate_number"),h=a("../util/unbundle_jsonlint");k.exports=function(a){function b(a){var b=[],c=a.value,p=a.key;if("array"!==d(c))return[new f(p,c,"array expected, %s found",d(c))];if(2!==c.length)return[new f(p,c,"array length %d expected, length %d found",2,c.length)];if(w){if("object"!==d(c[0]))return[new f(p,c,"object expected, %s found",
d(c[0]))];if(void 0===c[0].zoom)return[new f(p,c,"object stop key must have zoom")];if(void 0===c[0].value)return[new f(p,c,"object stop key must have value")];if(t&&t>h(c[0].zoom))return[new f(p,c[0].zoom,"stop zoom values must appear in ascending order")];h(c[0].zoom)!==t&&(t=h(c[0].zoom),y=void 0,m={});b=b.concat(l({key:p+"[0]",value:c[0],valueSpec:{zoom:{}},style:a.style,styleSpec:a.styleSpec,objectElementValidators:{zoom:g,value:e}}))}else b=b.concat(e({key:p+"[0]",value:c[0],valueSpec:{},style:a.style,
styleSpec:a.styleSpec}));return b.concat(n({key:p+"[1]",value:c[1],valueSpec:q,style:a.style,styleSpec:a.styleSpec}))}function e(a){var b=d(a.value),c=h(a.value);if(!k)k=b;else if(b!==k)return[new f(a.key,a.value,"%s stop domain type must match previous stop domain type %s",b,k)];if("number"!==b&&"string"!==b&&"boolean"!==b)return[new f(a.key,a.value,"stop domain value must be a number, string, or boolean")];if("number"!==b&&"categorical"!==r)return c="number expected, %s found",q["property-function"]&&
void 0===r&&(c+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new f(a.key,a.value,c,b)];if("categorical"===r&&"number"===b&&(!isFinite(c)||Math.floor(c)!==c))return[new f(a.key,a.value,"integer expected, found %s",c)];if("number"===b&&void 0!==y&&c<y)return[new f(a.key,a.value,"stop domain values must appear in ascending order")];y=c;if("categorical"===r&&c in m)return[new f(a.key,a.value,"stop domain values must be unique")];m[c]=!0;return[]}var q=a.valueSpec,
r=h(a.value.type),k,m={},y,t,v="categorical"!==r&&void 0===a.value.property,B=!v,w="array"===d(a.value.stops)&&"array"===d(a.value.stops[0])&&"object"===d(a.value.stops[0][0]),x=l({key:a.key,value:a.value,valueSpec:a.styleSpec["function"],style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(a){if("identity"===r)return[new f(a.key,a.value,'identity function may not have a "stops" property')];var e=[],g=a.value,e=e.concat(c({key:a.key,value:g,valueSpec:a.valueSpec,style:a.style,
styleSpec:a.styleSpec,arrayElementValidator:b}));"array"===d(g)&&0===g.length&&e.push(new f(a.key,g,"array must have at least one stop"));return e},"default":function(a){return n({key:a.key,value:a.value,valueSpec:q,style:a.style,styleSpec:a.styleSpec})}}});"identity"===r&&v&&x.push(new f(a.key,a.value,'missing required property "property"'));"identity"===r||a.value.stops||x.push(new f(a.key,a.value,'missing required property "stops"'));"exponential"===r&&"piecewise-constant"===a.valueSpec["function"]&&
x.push(new f(a.key,a.value,"exponential functions not supported"));8<=a.styleSpec.$version&&(B&&!a.valueSpec["property-function"]?x.push(new f(a.key,a.value,"property functions not supported")):v&&!a.valueSpec["zoom-function"]&&x.push(new f(a.key,a.value,"zoom functions not supported")));"categorical"!==r&&!w||void 0!==a.value.property||x.push(new f(a.key,a.value,'"property" property is required'));return x}},{"../error/validation_error":105,"../util/get_type":123,"../util/unbundle_jsonlint":127,
"./validate":128,"./validate_array":129,"./validate_number":140,"./validate_object":141}],136:[function(a,k,m){var f=a("../error/validation_error"),d=a("./validate_string");k.exports=function(a){var l=a.value,c=a.key;a=d(a);if(a.length)return a;-1===l.indexOf("{fontstack}")&&a.push(new f(c,l,'"glyphs" url must include a "{fontstack}" token'));-1===l.indexOf("{range}")&&a.push(new f(c,l,'"glyphs" url must include a "{range}" token'));return a}},{"../error/validation_error":105,"./validate_string":145}],
137:[function(a,k,m){var f=a("../error/validation_error"),d=a("../util/unbundle_jsonlint"),n=a("./validate_object"),l=a("./validate_filter"),c=a("./validate_paint_property"),g=a("./validate_layout_property"),h=a("../util/extend");k.exports=function(a){var b=[],e=a.value,q=a.key,r=a.style,k=a.styleSpec;e.type||e.ref||b.push(new f(q,e,'either "type" or "ref" is required'));var m=d(e.type),y=d(e.ref);if(e.id)for(var t=d(e.id),v=0;v<a.arrayIndex;v++){var B=r.layers[v];d(B.id)===t&&b.push(new f(q,e.id,
'duplicate layer id "%s", previously used at line %d',e.id,B.id.__line__))}if("ref"in e){["type","source","source-layer","filter","layout"].forEach(function(a){a in e&&b.push(new f(q,e[a],'"%s" is prohibited for ref layers',a))});var w;r.layers.forEach(function(a){d(a.id)===y&&(w=a)});w?w.ref?b.push(new f(q,e.ref,"ref cannot reference another ref layer")):m=d(w.type):b.push(new f(q,e.ref,'ref layer "%s" not found',y))}else"background"!==m&&(e.source?(t=(r=r.sources&&r.sources[e.source])&&d(r.type),
r?"vector"===t&&"raster"===m?b.push(new f(q,e.source,'layer "%s" requires a raster source',e.id)):"raster"===t&&"raster"!==m&&"normal"!==m?b.push(new f(q,e.source,'layer "%s" requires a vector source',e.id)):"vector"!==t||e["source-layer"]||b.push(new f(q,e,'layer "%s" must specify a "source-layer"',e.id)):b.push(new f(q,e.source,'source "%s" not found',e.source))):b.push(new f(q,e,'missing required property "source"')));return b=b.concat(n({key:q,value:e,valueSpec:k.layer,style:a.style,styleSpec:a.styleSpec,
objectElementValidators:{"*":function(){return[]},filter:l,layout:function(a){return n({layer:e,key:a.key,value:a.value,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":function(a){return g(h({layerType:m},a))}}})},paint:function(a){return n({layer:e,key:a.key,value:a.value,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":function(a){return c(h({layerType:m},a))}}})}}}))}},{"../error/validation_error":105,"../util/extend":122,"../util/unbundle_jsonlint":127,"./validate_filter":134,
"./validate_layout_property":138,"./validate_object":141,"./validate_paint_property":142}],138:[function(a,k,m){var f=a("./validate_property");k.exports=function(a){return f(a,"layout")}},{"./validate_property":143}],139:[function(a,k,m){var f=a("../error/validation_error"),d=a("../util/get_type"),n=a("./validate");k.exports=function(a){var c=a.value,g=a.styleSpec,h=g.light;a=a.style;var e=[],b=d(c);if(void 0===c)return e;if("object"!==b)return e=e.concat([new f("light",c,"object expected, %s found",
b)]);for(var p in c)e=(b=p.match(/^(.*)-transition$/))&&h[b[1]]&&h[b[1]].transition?e.concat(n({key:p,value:c[p],valueSpec:g.transition,style:a,styleSpec:g})):h[p]?e.concat(n({key:p,value:c[p],valueSpec:h[p],style:a,styleSpec:g})):e.concat([new f(p,c[p],'unknown property "%s"',p)]);return e}},{"../error/validation_error":105,"../util/get_type":123,"./validate":128}],140:[function(a,k,m){var f=a("../util/get_type"),d=a("../error/validation_error");k.exports=function(a){var l=a.key,c=a.value;a=a.valueSpec;
var g=f(c);return"number"!==g?[new d(l,c,"number expected, %s found",g)]:"minimum"in a&&c<a.minimum?[new d(l,c,"%s is less than the minimum value %s",c,a.minimum)]:"maximum"in a&&c>a.maximum?[new d(l,c,"%s is greater than the maximum value %s",c,a.maximum)]:[]}},{"../error/validation_error":105,"../util/get_type":123}],141:[function(a,k,m){var f=a("../error/validation_error"),d=a("../util/get_type"),n=a("./validate");k.exports=function(a){var c=a.key,g=a.value,h=a.valueSpec||{},e=a.objectElementValidators||
{},b=a.style;a=a.styleSpec;var p=[],l=d(g);if("object"!==l)return[new f(c,g,"object expected, %s found",l)];for(var r in g){var k=r.split(".")[0],l=h[k]||h["*"];if(e[k])k=e[k];else if(h[k])k=n;else if(e["*"])k=e["*"];else if(h["*"])k=n;else{p.push(new f(c,g[r],'unknown property "%s"',r));continue}p=p.concat(k({key:(c?c+".":c)+r,value:g[r],valueSpec:l,style:b,styleSpec:a,object:g,objectKey:r}))}for(var m in h)h[m].required&&void 0===h[m]["default"]&&void 0===g[m]&&p.push(new f(c,g,'missing required property "%s"',
m));return p}},{"../error/validation_error":105,"../util/get_type":123,"./validate":128}],142:[function(a,k,m){var f=a("./validate_property");k.exports=function(a){return f(a,"paint")}},{"./validate_property":143}],143:[function(a,k,m){var f=a("./validate"),d=a("../error/validation_error"),n=a("../util/get_type");k.exports=function(a,c){var g=a.key,h=a.style,e=a.styleSpec,b=a.value,p=a.objectKey,l=e[c+"_"+a.layerType];if(!l)return[];var r=p.match(/^(.*)-transition$/);if("paint"===c&&r&&l[r[1]]&&l[r[1]].transition)return f({key:g,
value:b,valueSpec:e.transition,style:h,styleSpec:e});l=a.valueSpec||l[p];if(!l)return[new d(g,b,'unknown property "%s"',p)];var k;if("string"===n(b)&&l["property-function"]&&!l.tokens&&(k=/^{([^}]+)}$/.exec(b)))return[new d(g,b,'"%s" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": %s` }`.',p,JSON.stringify(k[1]))];k=[];"symbol"===a.layerType&&"text-field"===p&&h&&!h.glyphs&&k.push(new d(g,b,'use of "text-field" requires a style "glyphs" property'));
return k.concat(f({key:a.key,value:b,valueSpec:l,style:h,styleSpec:e}))}},{"../error/validation_error":105,"../util/get_type":123,"./validate":128}],144:[function(a,k,m){var f=a("../error/validation_error"),d=a("../util/unbundle_jsonlint"),n=a("./validate_object"),l=a("./validate_enum");k.exports=function(a){var c=a.value,h=a.key,e=a.styleSpec,b=a.style;if(!c.type)return[new f(h,c,'"type" is required')];var p=[];switch(d(c.type)){case "vector":case "raster":p=p.concat(n({key:h,value:c,valueSpec:e.source_tile,
style:a.style,styleSpec:e}));if("url"in c)for(var q in c)0>["type","url","tileSize"].indexOf(q)&&p.push(new f(h+"."+q,c[q],'a source with a "url" property may not include a "%s" property',q));return p;case "geojson":return n({key:h,value:c,valueSpec:e.source_geojson,style:b,styleSpec:e});case "video":return n({key:h,value:c,valueSpec:e.source_video,style:b,styleSpec:e});case "image":return n({key:h,value:c,valueSpec:e.source_image,style:b,styleSpec:e});case "canvas":return n({key:h,value:c,valueSpec:e.source_canvas,
style:b,styleSpec:e});default:return l({key:h+".type",value:c.type,valueSpec:{values:"vector raster geojson video image canvas".split(" ")},style:b,styleSpec:e})}}},{"../error/validation_error":105,"../util/unbundle_jsonlint":127,"./validate_enum":133,"./validate_object":141}],145:[function(a,k,m){var f=a("../util/get_type"),d=a("../error/validation_error");k.exports=function(a){var l=a.value;a=a.key;var c=f(l);return"string"!==c?[new d(a,l,"string expected, %s found",c)]:[]}},{"../error/validation_error":105,
"../util/get_type":123}],146:[function(a,k,m){function f(a,b){b=b||g;var e=[],e=e.concat(c({key:"",value:a,valueSpec:b.$root,styleSpec:b,style:a,objectElementValidators:{glyphs:h,"*":function(){return[]}}}));7<b.$version&&a.constants&&(e=e.concat(l({key:"constants",value:a.constants,style:a,styleSpec:b})));return d(e)}function d(a){return[].concat(a).sort(function(a,c){return a.line-c.line})}function n(a){return function(){return d(a.apply(this,arguments))}}var l=a("./validate/validate_constants"),
c=a("./validate/validate"),g=a("./reference/latest"),h=a("./validate/validate_glyphs_url");f.source=n(a("./validate/validate_source"));f.light=n(a("./validate/validate_light"));f.layer=n(a("./validate/validate_layer"));f.filter=n(a("./validate/validate_filter"));f.paintProperty=n(a("./validate/validate_paint_property"));f.layoutProperty=n(a("./validate/validate_layout_property"));k.exports=f},{"./reference/latest":120,"./validate/validate":128,"./validate/validate_constants":132,"./validate/validate_filter":134,
"./validate/validate_glyphs_url":136,"./validate/validate_layer":137,"./validate/validate_layout_property":138,"./validate/validate_light":139,"./validate/validate_paint_property":142,"./validate/validate_source":144}],147:[function(a,k,m){a=function(){this.n=0;this.times=[]};a.prototype.stopped=function(){this.times=this.times.filter(function(a){return a.time>=(new Date).getTime()});return!this.times.length};a.prototype.set=function(a){this.times.push({id:this.n,time:a+(new Date).getTime()});return this.n++};
a.prototype.cancel=function(a){this.times=this.times.filter(function(d){return d.id!==a})};k.exports=a},{}],148:[function(a,k,m){m=a("../util/evented");var f=a("../util/ajax"),d=a("../util/browser"),n=a("../util/mapbox").normalizeSpriteURL,l=function(){this.height=this.width=this.y=this.x=0;this.pixelRatio=1;this.sdf=!1};a=function(a){function c(c,e){var b=this;a.call(this);this.base=c;this.retina=1<d.devicePixelRatio;this.setEventedParent(e);var g=this.retina?"@2x":"";f.getJSON(n(c,g,".json"),function(a,
c){a?b.fire("error",{error:a}):(b.data=c,b.imgData&&b.fire("data",{dataType:"style"}))});f.getImage(n(c,g,".png"),function(a,c){a?b.fire("error",{error:a}):(b.imgData=d.getImageData(c),b.width=c.width,b.data&&b.fire("data",{dataType:"style"}))})}a&&(c.__proto__=a);c.prototype=Object.create(a&&a.prototype);c.prototype.constructor=c;c.prototype.toJSON=function(){return this.base};c.prototype.loaded=function(){return!(!this.data||!this.imgData)};c.prototype.resize=function(){var a=this;if(1<d.devicePixelRatio!==
this.retina){var e=new c(this.base);e.on("data",function(){a.data=e.data;a.imgData=e.imgData;a.width=e.width;a.retina=e.retina})}};c.prototype.getSpritePosition=function(a){return this.loaded()?(a=this.data&&this.data[a])&&this.imgData?a:new l:new l};return c}(m);k.exports=a},{"../util/ajax":195,"../util/browser":196,"../util/evented":204,"../util/mapbox":211}],149:[function(a,k,m){var f=a("../style-spec/reference/latest"),d=a("../util/util");m=a("../util/evented");var n=a("./validate_style"),l=a("./style_declaration"),
c=a("./style_transition");a=function(a){function g(c){a.call(this);this.properties=["anchor","color","position","intensity"];this._specifications=f.light;this.set(c)}a&&(g.__proto__=a);g.prototype=Object.create(a&&a.prototype);g.prototype.constructor=g;g.prototype.set=function(a){if(!this._validate(n.light,a)){this._declarations={};this._transitions={};this._transitionOptions={};this.calculated={};a=d.extend({anchor:this._specifications.anchor["default"],color:this._specifications.color["default"],
position:this._specifications.position["default"],intensity:this._specifications.intensity["default"]},a);for(var b=0,c=this.properties;b<c.length;b+=1){var e=c[b];this._declarations[e]=new l(this._specifications[e],a[e])}return this}};g.prototype.getLight=function(){return{anchor:this.getLightProperty("anchor"),color:this.getLightProperty("color"),position:this.getLightProperty("position"),intensity:this.getLightProperty("intensity")}};g.prototype.getLightProperty=function(a){return d.endsWith(a,
"-transition")?this._transitionOptions[a]:this._declarations[a]&&this._declarations[a].value};g.prototype.getLightValue=function(a,b){if("position"===a){var c=this._transitions[a].calculate(b),c=d.sphericalToCartesian(c);return{x:c[0],y:c[1],z:c[2]}}return this._transitions[a].calculate(b)};g.prototype.setLight=function(a){if(!this._validate(n.light,a))for(var b in a){var c=a[b];d.endsWith(b,"-transition")?this._transitionOptions[b]=c:null===c||void 0===c?delete this._declarations[b]:this._declarations[b]=
new l(this._specifications[b],c)}};g.prototype.recalculate=function(a){for(var b in this._declarations)this.calculated[b]=this.getLightValue(b,{zoom:a})};g.prototype._applyLightDeclaration=function(a,b,f,g,h){f=f.transition?this._transitions[a]:void 0;var e=this._specifications[a];if(null===b||void 0===b)b=new l(e,e["default"]);f&&f.declaration.json===b.json||(g=d.extend({duration:300,delay:0},g,this.getLightProperty(a+"-transition")),a=this._transitions[a]=new c(e,b,f,g),a.instant()||(a.loopID=h.set(a.endTime-
Date.now())),f&&h.cancel(f.loopID))};g.prototype.updateLightTransitions=function(a,b,c){for(var e in this._declarations)this._applyLightDeclaration(e,this._declarations[e],a,b,c)};g.prototype._validate=function(a,b){return n.emitErrors(this,a.call(n,d.extend({value:b,style:{glyphs:!0,sprite:!0},styleSpec:f})))};return g}(m);k.exports=a},{"../style-spec/reference/latest":120,"../util/evented":204,"../util/util":217,"./style_declaration":151,"./style_transition":159,"./validate_style":160}],150:[function(a,
k,m){var f=a("assert");m=a("../util/evented");var d=a("./style_layer"),n=a("./image_sprite"),l=a("./light"),c=a("../symbol/glyph_source"),g=a("../symbol/sprite_atlas"),h=a("../render/line_atlas"),e=a("../util/util"),b=a("../util/ajax"),p=a("../util/mapbox"),q=a("../util/browser"),r=a("../util/dispatcher"),u=a("./animation_loop"),A=a("./validate_style"),y=a("../source/source"),t=a("../source/query_features"),v=a("../source/source_cache"),B=a("../style-spec/reference/latest"),w=a("../style-spec/function"),
x=a("../util/global_worker_pool"),C=a("../style-spec/deref"),z=a("../style-spec/diff"),E=a("../source/rtl_text_plugin"),D=e.pick(z.operations,"addLayer removeLayer setPaintProperty setLayoutProperty setFilter addSource removeSource setLayerZoomRange setLight setTransition".split(" ")),H=e.pick(z.operations,["setCenter","setZoom","setBearing","setPitch"]);a=function(a){function k(d,f,l){var k=this;a.call(this);this.animationLoop=(this.map=f)&&f.animationLoop||new u;this.dispatcher=new r(x(),this);
this.spriteAtlas=new g(1024,1024);this.spriteAtlas.setEventedParent(this);this.lineAtlas=new h(256,512);this._layers={};this._order=[];this.sourceCaches={};this.zoomHistory={};this._loaded=!1;e.bindAll(["_redoPlacement"],this);this._resetUpdates();l=e.extend({validate:"string"===typeof d?!p.isMapboxURL(d):!0},l);this.setEventedParent(f);this.fire("dataloading",{dataType:"style"});var m=this;this._rtlTextPluginCallback=E.registerForPluginAvailability(function(a){m.dispatcher.broadcast("loadRTLTextPlugin",
a.pluginBlobURL,a.errorCallback);for(var b in m.sourceCaches)m.sourceCaches[b].reload()});f=function(a,b){if(a)k.fire("error",{error:a});else if(!l.validate||!A.emitErrors(k,A(b))){k._loaded=!0;k.stylesheet=b;k.updateClasses();for(var e in b.sources)k.addSource(e,b.sources[e],l);b.sprite&&(k.sprite=new n(b.sprite,k));k.glyphSource=new c(b.glyphs);k._resolve();k.fire("data",{dataType:"style"});k.fire("style.load")}};"string"===typeof d?b.getJSON(p.normalizeStyleURL(d),f):q.frame(f.bind(this,null,d));
this.on("data",function(a){if("source"===a.dataType&&"metadata"===a.sourceDataType&&(a=k.sourceCaches[a.sourceId].getSource())&&a.vectorLayerIds)for(var b in k._layers){var c=k._layers[b];c.source===a.id&&k._validateLayer(c)}})}a&&(k.__proto__=a);k.prototype=Object.create(a&&a.prototype);k.prototype.constructor=k;k.prototype._validateLayer=function(a){var b=this.sourceCaches[a.source];a.sourceLayer&&b&&(b=b.getSource(),("geojson"===b.type||b.vectorLayerIds&&-1===b.vectorLayerIds.indexOf(a.sourceLayer))&&
this.fire("error",{error:Error('Source layer "'+a.sourceLayer+'" does not exist on source "'+b.id+'" as specified by style layer "'+a.id+'"')}))};k.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var a in this.sourceCaches)if(!this.sourceCaches[a].loaded())return!1;return this.sprite&&!this.sprite.loaded()?!1:!0};k.prototype._resolve=function(){var a=C(this.stylesheet.layers);this._order=a.map(function(a){return a.id});this._layers={};for(var b=
0;b<a.length;b+=1){var c=a[b],c=d.create(c);c.setEventedParent(this,{layer:{id:c.id}});this._layers[c.id]=c}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order));this.light=new l(this.stylesheet.light)};k.prototype._serializeLayers=function(a){var b=this;return a.map(function(a){return b._layers[a].serialize()})};k.prototype._applyClasses=function(a,b){if(this._loaded){a=a||[];b=b||{transition:!0};var c=this.stylesheet.transition||{},e=this._updatedAllPaintProps?this._layers:this._updatedPaintProps,
d;for(d in e){var e=this._layers[d],f=this._updatedPaintProps[d];if(this._updatedAllPaintProps||f.all)e.updatePaintTransitions(a,b,c,this.animationLoop,this.zoomHistory);else for(var g in f)this._layers[d].updatePaintTransition(g,a,b,c,this.animationLoop,this.zoomHistory)}this.light.updateLightTransitions(b,c,this.animationLoop)}};k.prototype._recalculate=function(a){if(this._loaded){for(var b in this.sourceCaches)this.sourceCaches[b].used=!1;this._updateZoomHistory(a);b=0;for(var c=this._order;b<
c.length;b+=1){var e=this._layers[c[b]];e.recalculate(a);!e.isHidden(a)&&e.source&&(this.sourceCaches[e.source].used=!0)}this.light.recalculate(a);Math.floor(this.z)!==Math.floor(a)&&this.animationLoop.set(300);this.z=a}};k.prototype._updateZoomHistory=function(a){var b=this.zoomHistory;void 0===b.lastIntegerZoom&&(b.lastIntegerZoom=Math.floor(a),b.lastIntegerZoomTime=0,b.lastZoom=a);Math.floor(b.lastZoom)<Math.floor(a)?(b.lastIntegerZoom=Math.floor(a),b.lastIntegerZoomTime=Date.now()):Math.floor(b.lastZoom)>
Math.floor(a)&&(b.lastIntegerZoom=Math.floor(a+1),b.lastIntegerZoomTime=Date.now());b.lastZoom=a};k.prototype._checkLoaded=function(){if(!this._loaded)throw Error("Style is not done loading");};k.prototype.update=function(a,b){if(this._changed){var c=Object.keys(this._updatedLayers),e=Object.keys(this._removedLayers);(c.length||e.length||this._updatedSymbolOrder)&&this._updateWorkerLayers(c,e);for(var d in this._updatedSources)c=this._updatedSources[d],f("reload"===c||"clear"===c),"reload"===c?this._reloadSource(d):
"clear"===c&&this._clearSource(d);this._applyClasses(a,b);this._resetUpdates();this.fire("data",{dataType:"style"})}};k.prototype._updateWorkerLayers=function(a,b){var c=this,e=this._updatedSymbolOrder?this._order.filter(function(a){return"symbol"===c._layers[a].type}):null;this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(a),removedIds:b,symbolOrder:e})};k.prototype._resetUpdates=function(){this._changed=!1;this._updatedLayers={};this._removedLayers={};this._updatedSymbolOrder=
!1;this._updatedSources={};this._updatedPaintProps={};this._updatedAllPaintProps=!1};k.prototype.setState=function(a){var b=this;this._checkLoaded();if(A.emitErrors(this,A(a)))return!1;a=e.extend({},a);a.layers=C(a.layers);var c=z(this.serialize(),a).filter(function(a){return!(a.command in H)});if(0===c.length)return!1;var d=c.filter(function(a){return!(a.command in D)});if(0<d.length)throw Error("Unimplemented: "+d.map(function(a){return a.command}).join(", ")+".");c.forEach(function(a){"setTransition"!==
a.command&&b[a.command].apply(b,a.args)});this.stylesheet=a;return!0};k.prototype.addSource=function(a,b,c){var e=this;this._checkLoaded();if(void 0!==this.sourceCaches[a])throw Error("There is already a source with this ID");if(!b.type)throw Error("The type property must be defined, but the only the following properties were given: "+Object.keys(b)+".");if(!(0<="vector raster geojson video image canvas".split(" ").indexOf(b.type)&&this._validate(A.source,"sources."+a,b,null,c))){var d=this.sourceCaches[a]=
new v(a,b,this.dispatcher);d.style=this;d.setEventedParent(this,function(){return{isSourceLoaded:e.loaded(),source:d.serialize(),sourceId:a}});d.onAdd(this.map);this._changed=!0}};k.prototype.removeSource=function(a){this._checkLoaded();if(void 0===this.sourceCaches[a])throw Error("There is no source with this ID");var b=this.sourceCaches[a];delete this.sourceCaches[a];delete this._updatedSources[a];b.setEventedParent(null);b.clearTiles();if(b.onRemove)b.onRemove(this.map);this._changed=!0};k.prototype.getSource=
function(a){return this.sourceCaches[a]&&this.sourceCaches[a].getSource()};k.prototype.addLayer=function(a,b,c){this._checkLoaded();var f=a.id;"object"===typeof a.source&&(this.addSource(f,a.source),a=e.extend(a,{source:f}));this._validate(A.layer,"layers."+f,a,{arrayIndex:-1},c)||(a=d.create(a),this._validateLayer(a),a.setEventedParent(this,{layer:{id:f}}),b=b?this._order.indexOf(b):this._order.length,this._order.splice(b,0,f),this._layers[f]=a,this._removedLayers[f]&&a.source&&(b=this._removedLayers[f],
delete this._removedLayers[f],this._updatedSources[a.source]=b.type!==a.type?"clear":"reload"),this._updateLayer(a),"symbol"===a.type&&(this._updatedSymbolOrder=!0),this.updateClasses(f))};k.prototype.moveLayer=function(a,b){this._checkLoaded();this._changed=!0;var c=this._layers[a];if(c){var e=this._order.indexOf(a);this._order.splice(e,1);e=b?this._order.indexOf(b):this._order.length;this._order.splice(e,0,a);"symbol"===c.type&&(this._updatedSymbolOrder=!0,c.source&&!this._updatedSources[c.source]&&
(this._updatedSources[c.source]="reload"))}else this.fire("error",{error:Error("The layer '"+a+"' does not exist in the map's style and cannot be moved.")})};k.prototype.removeLayer=function(a){this._checkLoaded();var b=this._layers[a];if(b){b.setEventedParent(null);var c=this._order.indexOf(a);this._order.splice(c,1);"symbol"===b.type&&(this._updatedSymbolOrder=!0);this._changed=!0;this._removedLayers[a]=b;delete this._layers[a];delete this._updatedLayers[a];delete this._updatedPaintProps[a]}else this.fire("error",
{error:Error("The layer '"+a+"' does not exist in the map's style and cannot be removed.")})};k.prototype.getLayer=function(a){return this._layers[a]};k.prototype.setLayerZoomRange=function(a,b,c){this._checkLoaded();var e=this.getLayer(a);if(!e)this.fire("error",{error:Error("The layer '"+a+"' does not exist in the map's style and cannot have zoom extent.")});else if(e.minzoom!==b||e.maxzoom!==c)null!=b&&(e.minzoom=b),null!=c&&(e.maxzoom=c),this._updateLayer(e)};k.prototype.setFilter=function(a,
b){this._checkLoaded();var c=this.getLayer(a);c?null!==b&&void 0!==b&&this._validate(A.filter,"layers."+c.id+".filter",b)||e.deepEqual(c.filter,b)||(c.filter=e.clone(b),this._updateLayer(c)):this.fire("error",{error:Error("The layer '"+a+"' does not exist in the map's style and cannot be filtered.")})};k.prototype.getFilter=function(a){return e.clone(this.getLayer(a).filter)};k.prototype.setLayoutProperty=function(a,b,c){this._checkLoaded();var d=this.getLayer(a);d?e.deepEqual(d.getLayoutProperty(b),
c)||(d.setLayoutProperty(b,c),this._updateLayer(d)):this.fire("error",{error:Error("The layer '"+a+"' does not exist in the map's style and cannot be styled.")})};k.prototype.getLayoutProperty=function(a,b){return this.getLayer(a).getLayoutProperty(b)};k.prototype.setPaintProperty=function(a,b,c,d){this._checkLoaded();var f=this.getLayer(a);if(!f)this.fire("error",{error:Error("The layer '"+a+"' does not exist in the map's style and cannot be styled.")});else if(!e.deepEqual(f.getPaintProperty(b,
d),c)){var g=f.isPaintValueFeatureConstant(b);f.setPaintProperty(b,c,d);(c&&w.isFunctionDefinition(c)&&"$zoom"!==c.property&&void 0!==c.property||!g)&&this._updateLayer(f);this.updateClasses(a,b)}};k.prototype.getPaintProperty=function(a,b,c){return this.getLayer(a).getPaintProperty(b,c)};k.prototype.getTransition=function(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)};k.prototype.updateClasses=function(a,b){this._changed=!0;if(a){var c=this._updatedPaintProps;
c[a]||(c[a]={});c[a][b||"all"]=!0}else this._updatedAllPaintProps=!0};k.prototype.serialize=function(){var a=this;return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e.mapObject(this.sourceCaches,
function(a){return a.serialize()}),layers:this._order.map(function(b){return a._layers[b].serialize()})},function(a){return void 0!==a})};k.prototype._updateLayer=function(a){this._updatedLayers[a.id]=!0;a.source&&!this._updatedSources[a.source]&&(this._updatedSources[a.source]="reload");this._changed=!0};k.prototype._flattenRenderedFeatures=function(a){for(var b=[],c=this._order.length-1;0<=c;c--)for(var e=this._order[c],d=0,f=a;d<f.length;d+=1){var g=f[d][e];if(g)for(var h=0;h<g.length;h+=1)b.push(g[h])}return b};
k.prototype.queryRenderedFeatures=function(a,b,c,e){b&&b.filter&&this._validate(A.filter,"queryRenderedFeatures.filter",b.filter);var d={};if(b&&b.layers){if(!Array.isArray(b.layers)){this.fire("error",{error:"parameters.layers must be an Array."});return}for(var f=0,g=b.layers;f<g.length;f+=1){var h=g[f],l=this._layers[h];if(!l){this.fire("error",{error:"The layer '"+h+"' does not exist in the map's style and cannot be queried for features."});return}d[l.source]=!0}}var f=[],p;for(p in this.sourceCaches)if(!b.layers||
d[p])g=t.rendered(this.sourceCaches[p],this._layers,a,b,c,e),f.push(g);return this._flattenRenderedFeatures(f)};k.prototype.querySourceFeatures=function(a,b){b&&b.filter&&this._validate(A.filter,"querySourceFeatures.filter",b.filter);var c=this.sourceCaches[a];return c?t.source(c,b):[]};k.prototype.addSourceType=function(a,b,c){if(y.getType(a))return c(Error('A source type called "'+a+'" already exists.'));y.setType(a,b);if(!b.workerSourceURL)return c(null,null);this.dispatcher.broadcast("loadWorkerSource",
{name:a,url:b.workerSourceURL},c)};k.prototype.getLight=function(){return this.light.getLight()};k.prototype.setLight=function(a,b){this._checkLoaded();var c=this.light.getLight(),d=!1,f;for(f in a)if(!e.deepEqual(a[f],c[f])){d=!0;break}d&&(c=this.stylesheet.transition||{},this.light.setLight(a),this.light.updateLightTransitions(b||{transition:!0},c,this.animationLoop))};k.prototype._validate=function(a,b,c,d,f){return f&&!1===f.validate?!1:A.emitErrors(this,a.call(A,e.extend({key:b,style:this.serialize(),
value:c,styleSpec:B},d)))};k.prototype._remove=function(){E.evented.off("pluginAvailable",this._rtlTextPluginCallback);for(var a in this.sourceCaches)this.sourceCaches[a].clearTiles();this.dispatcher.remove()};k.prototype._clearSource=function(a){this.sourceCaches[a].clearTiles()};k.prototype._reloadSource=function(a){this.sourceCaches[a].reload()};k.prototype._updateSources=function(a){for(var b in this.sourceCaches)this.sourceCaches[b].update(a)};k.prototype._redoPlacement=function(){for(var a in this.sourceCaches)this.sourceCaches[a].redoPlacement()};
k.prototype.getIcons=function(a,b,c){var e=this;a=function(){e.spriteAtlas.setSprite(e.sprite);e.spriteAtlas.addIcons(b.icons,c)};if(!this.sprite||this.sprite.loaded())a();else this.sprite.on("data",a)};k.prototype.getGlyphs=function(a,b,c){function e(a,b,e){a&&console.error(a);f[e]=b;d--;0===d&&c(null,f)}a=b.stacks;var d=Object.keys(a).length,f={},g;for(g in a)this.glyphSource.getSimpleGlyphs(g,a[g],b.uid,e)};return k}(m);k.exports=a},{"../render/line_atlas":77,"../source/query_features":90,"../source/rtl_text_plugin":92,
"../source/source":93,"../source/source_cache":94,"../style-spec/deref":103,"../style-spec/diff":104,"../style-spec/function":108,"../style-spec/reference/latest":120,"../symbol/glyph_source":169,"../symbol/sprite_atlas":173,"../util/ajax":195,"../util/browser":196,"../util/dispatcher":202,"../util/evented":204,"../util/global_worker_pool":206,"../util/mapbox":211,"../util/util":217,"./animation_loop":147,"./image_sprite":148,"./light":149,"./style_layer":152,"./validate_style":160,assert:5}],151:[function(a,
k,m){var f=a("../style-spec/function"),d=a("../util/util");a=function(a,l){this.value=d.clone(l);this.isFunction=f.isFunctionDefinition(l);this.json=JSON.stringify(this.value);this.minimum=a.minimum;this["function"]=f(this.value,a);this.isFeatureConstant=this["function"].isFeatureConstant;this.isZoomConstant=this["function"].isZoomConstant;if(!this.isFeatureConstant&&!this.isZoomConstant){this.stopZoomLevels=[];for(var c=[],g=0,h=this.value.stops;g<h.length;g+=1){var e=h[g][0].zoom;0>this.stopZoomLevels.indexOf(e)&&
(this.stopZoomLevels.push(e),c.push([e,c.length]))}this._functionInterpolationT=f({type:"exponential",stops:c,base:l.base},{type:"number"})}else if(!this.isZoomConstant)for(this.stopZoomLevels=[],c=0,g=this.value.stops;c<g.length;c+=1)h=g[c],0>this.stopZoomLevels.indexOf(h[0])&&this.stopZoomLevels.push(h[0])};a.prototype.calculate=function(a,d){var c=this["function"](a&&a.zoom,d||{});return void 0!==this.minimum&&c<this.minimum?this.minimum:c};a.prototype.calculateInterpolationT=function(a){return this.isFeatureConstant||
this.isZoomConstant?0:this._functionInterpolationT(a&&a.zoom,{})};k.exports=a},{"../style-spec/function":108,"../util/util":217}],152:[function(a,k,m){function f(a){return a.value}var d=a("../util/util"),n=a("./style_transition"),l=a("./style_declaration"),c=a("../style-spec/reference/latest"),g=a("./validate_style"),h=a("./../style-spec/util/parse_color"),e=function(a){function b(b){a.call(this);this.id=b.id;this.metadata=b.metadata;this.type=b.type;this.source=b.source;this.sourceLayer=b["source-layer"];
this.minzoom=b.minzoom;this.maxzoom=b.maxzoom;this.filter=b.filter;this.paint={};this.layout={};this._paintSpecifications=c["paint_"+this.type];this._layoutSpecifications=c["layout_"+this.type];this._paintTransitions={};this._paintTransitionOptions={};this._paintDeclarations={};this._layoutDeclarations={};this._layoutFunctions={};var e,d,f={validate:!1},g;for(g in b){var h=g.match(/^paint(?:\.(.*))?$/);if(h)for(e in h=h[1]||"",b[g])this.setPaintProperty(e,b[g][e],h,f)}for(d in b.layout)this.setLayoutProperty(d,
b.layout[d],f);for(e in this._paintSpecifications)this.paint[e]=this.getPaintValue(e);for(d in this._layoutSpecifications)this._updateLayoutValue(d)}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);b.prototype.constructor=b;b.prototype.setLayoutProperty=function(a,b,c){if(null==b)delete this._layoutDeclarations[a];else{if(this._validate(g.layoutProperty,"layers."+this.id+".layout."+a,a,b,c))return;this._layoutDeclarations[a]=new l(this._layoutSpecifications[a],b)}this._updateLayoutValue(a)};
b.prototype.getLayoutProperty=function(a){return this._layoutDeclarations[a]&&this._layoutDeclarations[a].value};b.prototype.getLayoutValue=function(a,b,c){var e=this._layoutSpecifications[a];return(a=this._layoutDeclarations[a])?a.calculate(b,c):e["default"]};b.prototype.setPaintProperty=function(a,b,c,e){var f="layers."+this.id+(c?'["paint.'+c+'"].':".paint.")+a;d.endsWith(a,"-transition")?(this._paintTransitionOptions[c||""]||(this._paintTransitionOptions[c||""]={}),null===b||void 0===b?delete this._paintTransitionOptions[c||
""][a]:this._validate(g.paintProperty,f,a,b,e)||(this._paintTransitionOptions[c||""][a]=b)):(this._paintDeclarations[c||""]||(this._paintDeclarations[c||""]={}),null===b||void 0===b?delete this._paintDeclarations[c||""][a]:this._validate(g.paintProperty,f,a,b,e)||(this._paintDeclarations[c||""][a]=new l(this._paintSpecifications[a],b)))};b.prototype.getPaintProperty=function(a,b){b=b||"";return d.endsWith(a,"-transition")?this._paintTransitionOptions[b]&&this._paintTransitionOptions[b][a]:this._paintDeclarations[b]&&
this._paintDeclarations[b][a]&&this._paintDeclarations[b][a].value};b.prototype.getPaintValue=function(a,b,c){var e=this._paintSpecifications[a];return(a=this._paintTransitions[a])?a.calculate(b,c):"color"===e.type&&e["default"]?h(e["default"]):e["default"]};b.prototype.getPaintValueStopZoomLevels=function(a){return(a=this._paintTransitions[a])?a.declaration.stopZoomLevels:[]};b.prototype.getLayoutValueStopZoomLevels=function(a){return(a=this._layoutDeclarations[a])?a.stopZoomLevels:[]};b.prototype.getPaintInterpolationT=
function(a,b){return this._paintTransitions[a].declaration.calculateInterpolationT(b)};b.prototype.getLayoutInterpolationT=function(a,b){return this._layoutDeclarations[a].calculateInterpolationT(b)};b.prototype.isPaintValueFeatureConstant=function(a){return(a=this._paintTransitions[a])?a.declaration.isFeatureConstant:!0};b.prototype.isLayoutValueFeatureConstant=function(a){return(a=this._layoutDeclarations[a])?a.isFeatureConstant:!0};b.prototype.isPaintValueZoomConstant=function(a){return(a=this._paintTransitions[a])?
a.declaration.isZoomConstant:!0};b.prototype.isLayoutValueZoomConstant=function(a){return(a=this._layoutDeclarations[a])?a.isZoomConstant:!0};b.prototype.isHidden=function(a){return this.minzoom&&a<this.minzoom||this.maxzoom&&a>=this.maxzoom||"none"===this.layout.visibility?!0:!1};b.prototype.updatePaintTransitions=function(a,b,c,e,f){for(var g=d.extend({},this._paintDeclarations[""]),h=0;h<a.length;h++)d.extend(g,this._paintDeclarations[a[h]]);for(var l in g)this._applyPaintDeclaration(l,g[l],b,
c,e,f);for(l in this._paintTransitions)l in g||this._applyPaintDeclaration(l,null,b,c,e,f)};b.prototype.updatePaintTransition=function(a,b,c,e,d,f){for(var g=this._paintDeclarations[""][a],h=0;h<b.length;h++){var l=this._paintDeclarations[b[h]];l&&l[a]&&(g=l[a])}this._applyPaintDeclaration(a,g,c,e,d,f)};b.prototype.recalculate=function(a){for(var b in this._paintTransitions)this.paint[b]=this.getPaintValue(b,{zoom:a});for(var c in this._layoutFunctions)this.layout[c]=this.getLayoutValue(c,{zoom:a})};
b.prototype.serialize=function(){var a={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:d.mapObject(this._layoutDeclarations,f)},b;for(b in this._paintDeclarations)a[""===b?"paint":"paint."+b]=d.mapObject(this._paintDeclarations[b],f);return d.filterObject(a,function(a,b){return void 0!==a&&!("layout"===b&&!Object.keys(a).length)})};b.prototype._applyPaintDeclaration=function(a,
b,c,e,f,g){c=c.transition?this._paintTransitions[a]:void 0;var h=this._paintSpecifications[a];if(null===b||void 0===b)b=new l(h,h["default"]);c&&c.declaration.json===b.json||(e=d.extend({duration:300,delay:0},e,this.getPaintProperty(a+"-transition")),a=this._paintTransitions[a]=new n(h,b,c,e,g),a.instant()||(a.loopID=f.set(a.endTime-Date.now())),c&&f.cancel(c.loopID))};b.prototype._updateLayoutValue=function(a){var b=this._layoutDeclarations[a];b&&b.isFunction?this._layoutFunctions[a]=!0:(delete this._layoutFunctions[a],
this.layout[a]=this.getLayoutValue(a))};b.prototype._validate=function(a,b,e,d,f){return f&&!1===f.validate?!1:g.emitErrors(this,a.call(g,{key:b,layerType:this.type,objectKey:e,value:d,styleSpec:c,style:{glyphs:!0,sprite:!0}}))};return b}(a("../util/evented"));k.exports=e;var b={circle:a("./style_layer/circle_style_layer"),fill:a("./style_layer/fill_style_layer"),"fill-extrusion":a("./style_layer/fill_extrusion_style_layer"),line:a("./style_layer/line_style_layer"),symbol:a("./style_layer/symbol_style_layer")};
e.create=function(a){return new (b[a.type]||e)(a)}},{"../style-spec/reference/latest":120,"../util/evented":204,"../util/util":217,"./../style-spec/util/parse_color":125,"./style_declaration":151,"./style_layer/circle_style_layer":153,"./style_layer/fill_extrusion_style_layer":154,"./style_layer/fill_style_layer":155,"./style_layer/line_style_layer":156,"./style_layer/symbol_style_layer":157,"./style_transition":159,"./validate_style":160}],153:[function(a,k,m){m=a("../style_layer");var f=a("../../data/bucket/circle_bucket");
a=function(a){function d(){a.apply(this,arguments)}a&&(d.__proto__=a);d.prototype=Object.create(a&&a.prototype);d.prototype.constructor=d;d.prototype.createBucket=function(a){return new f(a)};return d}(m);k.exports=a},{"../../data/bucket/circle_bucket":46,"../style_layer":152}],154:[function(a,k,m){m=a("../style_layer");var f=a("../../data/bucket/fill_extrusion_bucket");a=function(a){function d(){a.apply(this,arguments)}a&&(d.__proto__=a);d.prototype=Object.create(a&&a.prototype);d.prototype.constructor=
d;d.prototype.getPaintValue=function(d,c,f){c=a.prototype.getPaintValue.call(this,d,c,f);"fill-extrusion-color"===d&&c&&(c[3]=1);return c};d.prototype.createBucket=function(a){return new f(a)};return d}(m);k.exports=a},{"../../data/bucket/fill_extrusion_bucket":48,"../style_layer":152}],155:[function(a,k,m){m=a("../style_layer");var f=a("../../data/bucket/fill_bucket");a=function(a){function d(){a.apply(this,arguments)}a&&(d.__proto__=a);d.prototype=Object.create(a&&a.prototype);d.prototype.constructor=
d;d.prototype.getPaintValue=function(d,c,f){if("fill-outline-color"===d){if(void 0===this.getPaintProperty("fill-outline-color"))return a.prototype.getPaintValue.call(this,"fill-color",c,f);for(var g=this._paintTransitions["fill-outline-color"];g;){if(!(g&&g.declaration&&g.declaration.value))return a.prototype.getPaintValue.call(this,"fill-color",c,f);g=g.oldTransition}}return a.prototype.getPaintValue.call(this,d,c,f)};d.prototype.getPaintValueStopZoomLevels=function(d){return"fill-outline-color"===
d&&void 0===this.getPaintProperty("fill-outline-color")?a.prototype.getPaintValueStopZoomLevels.call(this,"fill-color"):a.prototype.getPaintValueStopZoomLevels.call(this,d)};d.prototype.getPaintInterpolationT=function(d,c){return"fill-outline-color"===d&&void 0===this.getPaintProperty("fill-outline-color")?a.prototype.getPaintInterpolationT.call(this,"fill-color",c):a.prototype.getPaintInterpolationT.call(this,d,c)};d.prototype.isPaintValueFeatureConstant=function(d){return"fill-outline-color"===
d&&void 0===this.getPaintProperty("fill-outline-color")?a.prototype.isPaintValueFeatureConstant.call(this,"fill-color"):a.prototype.isPaintValueFeatureConstant.call(this,d)};d.prototype.isPaintValueZoomConstant=function(d){return"fill-outline-color"===d&&void 0===this.getPaintProperty("fill-outline-color")?a.prototype.isPaintValueZoomConstant.call(this,"fill-color"):a.prototype.isPaintValueZoomConstant.call(this,d)};d.prototype.createBucket=function(a){return new f(a)};return d}(m);k.exports=a},{"../../data/bucket/fill_bucket":47,
"../style_layer":152}],156:[function(a,k,m){m=a("../style_layer");var f=a("../../data/bucket/line_bucket"),d=a("../../util/util");a=function(a){function l(){a.apply(this,arguments)}a&&(l.__proto__=a);l.prototype=Object.create(a&&a.prototype);l.prototype.constructor=l;l.prototype.getPaintValue=function(c,f,h){var e=a.prototype.getPaintValue.call(this,c,f,h);e&&"line-dasharray"===c&&(c=this.getPaintValue("line-width",d.extend({},f,{zoom:Math.floor(f.zoom)}),h),e.fromScale*=c,e.toScale*=c);return e};
l.prototype.createBucket=function(a){return new f(a)};return l}(m);k.exports=a},{"../../data/bucket/line_bucket":49,"../../util/util":217,"../style_layer":152}],157:[function(a,k,m){m=a("../style_layer");var f=a("../../data/bucket/symbol_bucket");a=function(a){function d(){a.apply(this,arguments)}a&&(d.__proto__=a);d.prototype=Object.create(a&&a.prototype);d.prototype.constructor=d;d.prototype.getLayoutValue=function(d,c,f){var g=a.prototype.getLayoutValue.call(this,d,c,f);if("auto"!==g)return g;
switch(d){case "text-rotation-alignment":case "icon-rotation-alignment":return"line"===this.getLayoutValue("symbol-placement",c,f)?"map":"viewport";case "text-pitch-alignment":return this.getLayoutValue("text-rotation-alignment",c,f);default:return g}};d.prototype.createBucket=function(a){return new f(a)};return d}(m);k.exports=a},{"../../data/bucket/symbol_bucket":50,"../style_layer":152}],158:[function(a,k,m){var f=a("./style_layer"),d=a("../util/util"),n=a("../style-spec/feature_filter"),l=a("../style-spec/group_by_layout");
a=function(a){a&&this.replace(a)};a.prototype.replace=function(a){this.symbolOrder=[];for(var c=0;c<a.length;c+=1){var d=a[c];"symbol"===d.type&&this.symbolOrder.push(d.id)}this._layerConfigs={};this._layers={};this.update(a,[])};a.prototype.update=function(a,g,h){for(var c=this,b=0;b<a.length;b+=1){var p=a[b];c._layerConfigs[p.id]=p;p=c._layers[p.id]=f.create(p);p.updatePaintTransitions({},{transition:!1});p.filter=n(p.filter)}for(a=0;a<g.length;a+=1)b=g[a],delete c._layerConfigs[b],delete c._layers[b];
h&&(this.symbolOrder=h);this.familiesBySource={};g=0;for(h=l(d.values(this._layerConfigs));g<h.length;g+=1)if(a=h[g].map(function(a){return c._layers[a.id]}),p=a[0],!p.layout||"none"!==p.layout.visibility){var k=p.source||"";(b=c.familiesBySource[k])||(b=c.familiesBySource[k]={});p=p.sourceLayer||"_geojsonTileLayer";(k=b[p])||(k=b[p]=[]);k.push(a)}};k.exports=a},{"../style-spec/feature_filter":106,"../style-spec/group_by_layout":109,"../util/util":217,"./style_layer":152}],159:[function(a,k,m){function f(a,
d,f){if(void 0!==a&&void 0!==d)return{from:a.to,fromScale:a.toScale,to:d.to,toScale:d.toScale,t:f}}var d=a("../util/util"),n=a("../style-spec/util/interpolate"),l={lastIntegerZoom:0,lastIntegerZoomTime:0,lastZoom:0};a=function(a,d,h,e,b){this.declaration=d;this.startTime=this.endTime=(new Date).getTime();this.oldTransition=h;this.duration=e.duration||0;this.delay=e.delay||0;this.interp=(this.zoomTransitioned="piecewise-constant"===a["function"]&&a.transition)?f:n[a.type];this.zoomHistory=b||l;this.instant()||
(this.endTime=this.startTime+this.duration+this.delay);h&&h.endTime<=this.startTime&&delete h.oldTransition};a.prototype.instant=function(){return!this.oldTransition||!this.interp||0===this.duration&&0===this.delay};a.prototype.calculate=function(a,f,h){var c=this._calculateTargetValue(a,f);if(this.instant())return c;h=h||Date.now();if(h>=this.endTime)return c;a=this.oldTransition.calculate(a,f,this.startTime);h=d.easeCubicInOut((h-this.startTime-this.delay)/this.duration);return this.interp(a,c,
h)};a.prototype._calculateTargetValue=function(a,d){if(!this.zoomTransitioned)return this.declaration.calculate(a,d);var c=a.zoom,e=this.zoomHistory.lastIntegerZoom,b=c>e?2:.5,f=this.declaration.calculate({zoom:c>e?c-1:c+1},d),g=this.declaration.calculate({zoom:c},d),l=Math.min((Date.now()-this.zoomHistory.lastIntegerZoomTime)/this.duration,1),c=n(l,1,Math.abs(c-e));if(void 0!==f&&void 0!==g)return{from:f,fromScale:b,to:g,toScale:1,t:c}};k.exports=a},{"../style-spec/util/interpolate":124,"../util/util":217}],
160:[function(a,k,m){k.exports=a("../style-spec/validate_style.min");k.exports.emitErrors=function(a,d){if(d&&d.length){for(var f=0;f<d.length;f++)a.fire("error",{error:Error(d[f].message)});return!0}return!1}},{"../style-spec/validate_style.min":146}],161:[function(a,k,m){a=function(a){function d(d,f,c,g){a.call(this,d,f);this.angle=c;void 0!==g&&(this.segment=g)}a&&(d.__proto__=a);d.prototype=Object.create(a&&a.prototype);d.prototype.constructor=d;d.prototype.clone=function(){return new d(this.x,
this.y,this.angle,this.segment)};return d}(a("point-geometry"));k.exports=a},{"point-geometry":26}],162:[function(a,k,m){k.exports=function(a,d,k,l,c){if(void 0===d.segment)return!0;var f=d;d=d.segment+1;for(var h=0;h>-k/2;){d--;if(0>d)return!1;h-=a[d].dist(f);f=a[d]}h+=a[d].dist(a[d+1]);d++;for(var f=[],e=0;h<k/2;){var b=a[d],p=a[d+1];if(!p)return!1;var q=a[d-1].angleTo(b)-b.angleTo(p),q=Math.abs((q+3*Math.PI)%(2*Math.PI)-Math.PI);f.push({distance:h,angleDelta:q});for(e+=q;h-f[0].distance>l;)e-=
f.shift().angleDelta;if(e>c)return!1;d++;h+=b.dist(p)}return!0}},{}],163:[function(a,k,m){var f=a("point-geometry");k.exports=function(a,k,l,c,g){for(var d=[],e=0;e<a.length;e++)for(var b=a[e],p=void 0,q=0;q<b.length-1;q++){var n=b[q],m=b[q+1];n.x<k&&m.x<k||(n.x<k?n=(new f(k,n.y+(k-n.x)/(m.x-n.x)*(m.y-n.y)))._round():m.x<k&&(m=(new f(k,n.y+(k-n.x)/(m.x-n.x)*(m.y-n.y)))._round()),n.y<l&&m.y<l||(n.y<l?n=(new f(n.x+(l-n.y)/(m.y-n.y)*(m.x-n.x),l))._round():m.y<l&&(m=(new f(n.x+(l-n.y)/(m.y-n.y)*(m.x-
n.x),l))._round()),n.x>=c&&m.x>=c||(n.x>=c?n=(new f(c,n.y+(c-n.x)/(m.x-n.x)*(m.y-n.y)))._round():m.x>=c&&(m=(new f(c,n.y+(c-n.x)/(m.x-n.x)*(m.y-n.y)))._round()),n.y>=g&&m.y>=g||(n.y>=g?n=(new f(n.x+(g-n.y)/(m.y-n.y)*(m.x-n.x),g))._round():m.y>=g&&(m=(new f(n.x+(g-n.y)/(m.y-n.y)*(m.x-n.x),g))._round()),p&&n.equals(p[p.length-1])||(p=[n],d.push(p)),p.push(m)))))}return d}},{"point-geometry":26}],164:[function(a,k,m){m=a("../util/struct_array");var f=a("point-geometry");a=m({members:[{type:"Int16",name:"anchorPointX"},
{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Float32",name:"maxScale"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"bbox0"},{type:"Int16",name:"bbox1"},{type:"Int16",name:"bbox2"},{type:"Int16",name:"bbox3"},{type:"Float32",name:"placementScale"}]});Object.defineProperty(a.prototype.StructType.prototype,"anchorPoint",
{get:function(){return new f(this.anchorPointX,this.anchorPointY)}});k.exports=a},{"../util/struct_array":214,"point-geometry":26}],165:[function(a,k,m){a=function(a,d,k,l,c,g,h,e,b,p,q){var f=h.top*e-b,n=h.bottom*e+b,m=h.left*e-b;h=h.right*e+b;this.boxStartIndex=a.length;p?(p=n-f,m=h-m,0<p&&(p=Math.max(10*e,p),q?(d=d[k.segment+1].sub(d[k.segment])._unit()._mult(m),d=[k.sub(d),k.add(d)],this._addLineCollisionBoxes(a,d,k,0,m,p,l,c,g)):this._addLineCollisionBoxes(a,d,k,k.segment,m,p,l,c,g))):a.emplaceBack(k.x,
k.y,m,f,h,n,Infinity,l,c,g,0,0,0,0,0);this.boxEndIndex=a.length};a.prototype._addLineCollisionBoxes=function(a,d,k,l,c,g,h,e,b){var f=g/2,n=Math.floor(c/f),m=Math.floor(n/4),u=-g/2,A=k;l+=1;k=u;var y=-c/2,t=y-c/8;do if(l--,0>l){if(k>y)return;l=0;break}else k-=d[l].dist(A),A=d[l];while(k>t);A=d[l].dist(d[l+1]);for(t=-m;t<n+m;t++){var v=y+t*f;if(!(v<k)){for(;k+A<v;){k+=A;l++;if(l+1>=d.length)return;A=d[l].dist(d[l+1])}var B=v-k,w=d[l],B=d[l+1].sub(w)._unit()._mult(B)._add(w)._round(),v=c/2/Math.max(Math.abs(v-
u)-f/2,0);if(0>t||t>=n)v=Math.min(v,.99);a.emplaceBack(B.x,B.y,-g/2,-g/2,g/2,g/2,v,h,e,b,0,0,0,0,0)}}};k.exports=a},{}],166:[function(a,k,m){var f=a("point-geometry"),d=a("../data/extent"),n=a("grid-index"),l=a("../util/intersection_tests");a=function(a,f,h,e,b){if("object"===typeof a){var c=a;b=f;a=c.angle;f=c.pitch;h=c.cameraToCenterDistance;e=c.cameraToTileDistance;this.grid=new n(c.grid);this.ignoredGrid=new n(c.ignoredGrid)}else this.grid=new n(d,12,6),this.ignoredGrid=new n(d,12,0);this.perspectiveRatio=
1+.5*(e/h-1);this.minScale=.5/this.perspectiveRatio;this.maxScale=2/this.perspectiveRatio;this.angle=a;this.pitch=f;this.cameraToCenterDistance=h;this.cameraToTileDistance=e;c=Math.sin(a);a=Math.cos(a);this.rotationMatrix=[a,-c,c,a];this.reverseRotationMatrix=[a,c,-c,a];this.yStretch=Math.max(1,e/(h*Math.cos(f/180*Math.PI)));this.collisionBoxArray=b;0===b.length&&(b.emplaceBack(),b.emplaceBack(0,0,0,-32767,0,32767,32767,0,0,0,0,0,0,0,0,0),b.emplaceBack(d,0,0,-32767,0,32767,32767,0,0,0,0,0,0,0,0,0),
b.emplaceBack(0,0,-32767,0,32767,0,32767,0,0,0,0,0,0,0,0,0),b.emplaceBack(0,d,-32767,0,32767,0,32767,0,0,0,0,0,0,0,0,0));this.tempCollisionBox=b.get(0);this.edges=[b.get(1),b.get(2),b.get(3),b.get(4)]};a.prototype.serialize=function(a){var c=this.grid.toArrayBuffer(),d=this.ignoredGrid.toArrayBuffer();a&&(a.push(c),a.push(d));return{angle:this.angle,pitch:this.pitch,cameraToCenterDistance:this.cameraToCenterDistance,cameraToTileDistance:this.cameraToTileDistance,grid:c,ignoredGrid:d}};a.prototype.placeCollisionFeature=
function(a,d,h){for(var c=this.collisionBoxArray,b=this.minScale,g=this.rotationMatrix,l=this.yStretch,k=a.boxStartIndex;k<a.boxEndIndex;k++){var n=c.get(k),m=n.anchorPoint._matMult(g),y=m.x,t=m.y,v=y+n.x1*this.perspectiveRatio,B=t+n.y1*l*this.perspectiveRatio,y=y+n.x2*this.perspectiveRatio,t=t+n.y2*l*this.perspectiveRatio;n.bbox0=v;n.bbox1=B;n.bbox2=y;n.bbox3=t;if(!d)for(v=this.grid.query(v,B,y,t),B=0;B<v.length;B++)if(t=c.get(v[B]),y=t.anchorPoint._matMult(g),b=this.getPlacementScale(b,m,n,y,t),
b>=this.maxScale)return b;if(h)for(this.angle?(m=this.reverseRotationMatrix,v=(new f(n.x1,n.y1)).matMult(m),B=(new f(n.x2,n.y1)).matMult(m),t=(new f(n.x1,n.y2)).matMult(m),y=(new f(n.x2,n.y2)).matMult(m),m=this.tempCollisionBox,m.anchorPointX=n.anchorPoint.x,m.anchorPointY=n.anchorPoint.y,m.x1=Math.min(v.x,B.x,t.x,y.x),m.y1=Math.min(v.y,B.x,t.x,y.x),m.x2=Math.max(v.x,B.x,t.x,y.x),m.y2=Math.max(v.y,B.x,t.x,y.x),m.maxScale=n.maxScale):m=n,v=0;v<this.edges.length;v++)if(B=this.edges[v],b=this.getPlacementScale(b,
n.anchorPoint,m,B.anchorPoint,B),b>=this.maxScale)return b}return b};a.prototype.queryRenderedSymbols=function(a,d){var c={},e=[];if(0===a.length||0===this.grid.keys.length&&0===this.ignoredGrid.keys.length)return e;for(var b=this.collisionBoxArray,g=this.rotationMatrix,k=this.yStretch,n=[],m=Infinity,A=Infinity,y=-Infinity,t=-Infinity,v=0;v<a.length;v++)for(var B=a[v],w=0;w<B.length;w++){var x=B[w].matMult(g),m=Math.min(m,x.x),A=Math.min(A,x.y),y=Math.max(y,x.x),t=Math.max(t,x.y);n.push(x)}v=this.grid.query(m,
A,y,t);m=this.ignoredGrid.query(m,A,y,t);for(A=0;A<m.length;A++)v.push(m[A]);m=Math.pow(2,Math.ceil(Math.log(d)/Math.LN2*10)/10);for(A=0;A<v.length;A++){var C=b.get(v[A]),y=C.sourceLayerIndex,t=C.featureIndex;void 0===c[y]&&(c[y]={});if(!(c[y][t]||m<C.placementScale||m>C.maxScale)){var z=C.anchorPoint.matMult(g),B=z.x+C.x1/d,w=z.y+C.y1/d*k,x=z.x+C.x2/d,C=z.y+C.y2/d*k,B=[new f(B,w),new f(x,w),new f(x,C),new f(B,C)];l.polygonIntersectsPolygon(n,B)&&(c[y][t]=!0,e.push(v[A]))}}return e};a.prototype.getPlacementScale=
function(a,d,f,e,b){var c=d.x-e.x;e=d.y-e.y;d=(b.x1-f.x2)/c;var c=(b.x2-f.x1)/c,g=(b.y1-f.y2)*this.yStretch/e;e=(b.y2-f.y1)*this.yStretch/e;if(isNaN(d)||isNaN(c))d=c=1;if(isNaN(g)||isNaN(e))g=e=1;d=Math.min(Math.max(d,c),Math.max(g,e));c=b.maxScale;f=f.maxScale;d>c&&(d=c);d>f&&(d=f);d>a&&d>=b.placementScale&&(a=d);return a};a.prototype.insertCollisionFeature=function(a,d,f){f=f?this.ignoredGrid:this.grid;for(var c=this.collisionBoxArray,b=a.boxStartIndex;b<a.boxEndIndex;b++){var g=c.get(b);g.placementScale=
d;d<this.maxScale&&(1===this.perspectiveRatio||1<=g.maxScale)&&f.insert(b,g.bbox0,g.bbox1,g.bbox2,g.bbox3)}};k.exports=a},{"../data/extent":54,"../util/intersection_tests":208,"grid-index":17,"point-geometry":26}],167:[function(a,k,m){function f(a,g,h,e,b,p,k,m,u){for(var c=p/2,q=0,r=0;r<a.length-1;r++)q+=a[r].dist(a[r+1]);r=0;g-=h;for(var v=[],B=0;B<a.length-1;B++){for(var w=a[B],x=a[B+1],C=w.dist(x),z=x.angleTo(w);g+h<r+C;){g+=h;var E=(g-r)/C,D=d(w.x,x.x,E),E=d(w.y,x.y,E);0<=D&&D<u&&0<=E&&E<u&&
0<=g-c&&g+c<=q&&(D=(new n(D,E,z,B))._round(),e&&!l(a,D,p,e,b)||v.push(D))}r+=C}m||v.length||k||(v=f(a,r/2,h,e,b,p,k,!0,u));return v}var d=a("../style-spec/util/interpolate"),n=a("../symbol/anchor"),l=a("./check_max_angle");k.exports=function(a,d,h,e,b,l,k,n,m){b=Math.max(e?e.right-e.left:0,b?b.right-b.left:0);var c=0===a[0].x||a[0].x===m||0===a[0].y||a[0].y===m;d-b*k<d/4&&(d=b*k+d/4);return f(a,c?d/2*n%d:(b/2+2*l)*k*n%d,d,e?.6*l*k:0,h,b*k,c,!1,m)}},{"../style-spec/util/interpolate":124,"../symbol/anchor":161,
"./check_max_angle":162}],168:[function(a,k,m){var f=a("@mapbox/shelf-pack"),d=a("../util/util");a=function(){this.height=this.width=128;this.atlas=new f(this.width,this.height);this.index={};this.ids={};this.data=new Uint8Array(this.width*this.height)};a.prototype.getGlyphs=function(){var a={},d,c,f;for(f in this.ids)d=f.split("#"),c=d[0],d=d[1],a[c]||(a[c]=[]),a[c].push(d);return a};a.prototype.getRects=function(){var a={},d,c,f;for(f in this.ids)d=f.split("#"),c=d[0],d=d[1],a[c]||(a[c]={}),a[c][d]=
this.index[f];return a};a.prototype.addGlyph=function(a,f,c,g){if(!c)return null;var h=f+"#"+c.id;if(this.index[h])return 0>this.ids[h].indexOf(a)&&this.ids[h].push(a),this.index[h];if(!c.bitmap)return null;f=c.width+2*g;g=c.height+2*g;var e=f+2,b=g+2,l=this.atlas.packOne(e,b);l||(this.resize(),l=this.atlas.packOne(e,b));if(!l)return d.warnOnce("glyph bitmap overflow"),null;this.index[h]=l;this.ids[h]=[a];a=this.data;c=c.bitmap;for(h=0;h<g;h++)for(var e=this.width*(l.y+h+1)+l.x+1,b=f*h,k=0;k<f;k++)a[e+
k]=c[b+k];this.dirty=!0;return l};a.prototype.resize=function(){var a=this.width,d=this.height;if(!(2048<=a||2048<=d)){this.texture&&(this.gl&&this.gl.deleteTexture(this.texture),this.texture=null);this.width*=4;this.height*=4;this.atlas.resize(this.width,this.height);for(var c=new ArrayBuffer(this.width*this.height),f=0;f<d;f++){var h=new Uint8Array(this.data.buffer,d*f,a);(new Uint8Array(c,d*f*4,a)).set(h)}this.data=new Uint8Array(c)}};a.prototype.bind=function(a){this.gl=a;this.texture?a.bindTexture(a.TEXTURE_2D,
this.texture):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,null))};a.prototype.updateTexture=function(a){this.bind(a);this.dirty&&(a.texSubImage2D(a.TEXTURE_2D,
0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data),this.dirty=!1)};k.exports=a},{"../util/util":217,"@mapbox/shelf-pack":2}],169:[function(a,k,m){function f(a,c,d,e){e=e||"abc";return d.replace("{s}",e[a.length%e.length]).replace("{fontstack}",a).replace("{range}",c)}var d=a("../util/mapbox").normalizeGlyphsURL,n=a("../util/ajax"),l=a("../util/verticalize_punctuation"),c=a("../util/glyphs"),g=a("../symbol/glyph_atlas"),h=a("pbf"),e=function(a,c,d){this.advance=a.advance;this.left=a.left-
d-1;this.top=a.top+d+1;this.rect=c};a=function(a){this.url=a&&d(a);this.atlases={};this.stacks={};this.loading={}};a.prototype.getSimpleGlyphs=function(a,c,d,f){var b=this;void 0===this.stacks[a]&&(this.stacks[a]={});void 0===this.atlases[a]&&(this.atlases[a]=new g);for(var h={},p=this.stacks[a],k=this.atlases[a],n={},q=0,m=function(b){var c=Math.floor(b/256);if(p[c]){var c=p[c].glyphs[b],f=k.addGlyph(d,a,c,3);c&&(h[b]=new e(c,f,3))}else void 0===n[c]&&(n[c]=[],q++),n[c].push(b)},r=0;r<c.length;r++){var C=
c[r],z=String.fromCharCode(C);m(C);l.lookup[z]&&m(l.lookup[z].charCodeAt(0))}q||f(void 0,h,a);c=function(c,g,l){if(!c)for(c=b.stacks[a][g]=l.stacks[0],l=0;l<n[g].length;l++){var p=n[g][l],m=c.glyphs[p],r=k.addGlyph(d,a,m,3);m&&(h[p]=new e(m,r,3))}q--;q||f(void 0,h,a)};for(var E in n)b.loadRange(a,E,c)};a.prototype.loadRange=function(a,d,e){if(65535<256*d)return e("glyphs > 65535 not supported");void 0===this.loading[a]&&(this.loading[a]={});var b=this.loading[a];b[d]?b[d].push(e):(b[d]=[e],a=f(a,
256*d+"-"+(256*d+255),this.url),n.getArrayBuffer(a,function(a,e){for(var f=!a&&new c(new h(e.data)),g=0;g<b[d].length;g++)b[d][g](a,d,f);delete b[d]}))};a.prototype.getGlyphAtlas=function(a){return this.atlases[a]};k.exports=a},{"../symbol/glyph_atlas":168,"../util/ajax":195,"../util/glyphs":207,"../util/mapbox":211,"../util/verticalize_punctuation":219,pbf:25}],170:[function(a,k,m){k.exports=function(a){function d(a,b,c){var d=g[a];delete g[a];g[b]=d;h[d].geometry[0].pop();h[d].geometry[0]=h[d].geometry[0].concat(c[0]);
return d}function f(a,b,d){var e=c[b];delete c[b];c[a]=e;h[e].geometry[0].shift();h[e].geometry[0]=d[0].concat(h[e].geometry[0]);return e}function l(a,b,c){b=c?b[0][b[0].length-1]:b[0][0];return a+":"+b.x+":"+b.y}for(var c={},g={},h=[],e=0,b=0;b<a.length;b++){var p=a[b],k=p.geometry;if(p=p.text){var m=l(p,k),u=l(p,k,!0);if(m in g&&u in c&&g[m]!==c[u]){var k=f(m,u,k),A=d(m,u,h[k].geometry);delete c[m];delete g[u];g[l(p,h[A].geometry,!0)]=A;h[k].geometry=null}else m in g?d(m,u,k):u in c?f(m,u,k):(h.push(a[b]),
e++,c[m]=e-1,g[u]=e-1)}else h.push(a[b]),e++}return h.filter(function(a){return a.geometry})}},{}],171:[function(a,k,m){function f(a,d,f,e,b,l,k,n,m,A,y){this.anchorPoint=a;this.tl=d;this.tr=f;this.bl=e;this.br=b;this.tex=l;this.anchorAngle=k;this.glyphAngle=n;this.minScale=m;this.maxScale=A;this.writingMode=y}function d(a,d,f,e,b,l){var c=0<=f^l;f=Math.abs(f);var g=new n(d.x,d.y),h=c?e[b+1]:e[b],k=g.dist(h);for(b={anchor:g,end:h,index:b,minScale:f/k,maxScale:Infinity};;){g=Math.atan2(b.end.y-b.anchor.y,
b.end.x-b.anchor.x);a.push({anchorPoint:b.anchor,upsideDown:l,minScale:b.minScale,maxScale:b.maxScale,angle:((c?g:g+Math.PI)+2*Math.PI)%(2*Math.PI)});if(b.minScale<=d.scale)return d.scale;a:{for(var g=b,p=e,k=f,m=c,v=g.end,h=v,B=g.index;h.equals(v);){if(m&&B+2<p.length)B+=1;else if(m||0===B){g=null;break a}else--B;h=m?p[B+1]:p[B]}p=v;m=g.anchor.dist(g.end);v=h.sub(p)._unit();p=p.sub(v._mult(m));m=h;h=p.dist(h);g={anchor:p,end:m,index:B,minScale:k/h,maxScale:g.minScale}}if(g)b=g;else return b.minScale}}
var n=a("point-geometry");k.exports={getIconQuads:function(a,d,h,e,b,p,k,m,u){h=d.image;var c=b.layout,g=d.top-1/h.pixelRatio,q=d.left-1/h.pixelRatio,r=d.bottom+1/h.pixelRatio,B=d.right+1/h.pixelRatio;if("none"!==c["icon-text-fit"]&&k){d=B-q;var w=r-g,g=c["text-size"]/24,r=k.left*g,q=k.top*g,x=k.right*g-r,C=k.bottom*g-q,z=c["icon-text-fit-padding"][0];k=c["icon-text-fit-padding"][1];var g=c["icon-text-fit-padding"][2],B=c["icon-text-fit-padding"][3],E="width"===c["icon-text-fit"]?.5*(C-w):0,D="height"===
c["icon-text-fit"]?.5*(x-d):0,x="width"===c["icon-text-fit"]||"both"===c["icon-text-fit"]?x:d,w="height"===c["icon-text-fit"]||"both"===c["icon-text-fit"]?C:w,c=new n(r+D-B,q+E-z);d=new n(r+D+k+x,q+E-z);k=new n(r+D+k+x,q+E+g+w);r=new n(r+D-B,q+E+g+w)}else c=new n(q,g),d=new n(B,g),k=new n(B,r),r=new n(q,r);b=b.getLayoutValue("icon-rotate",m,u)*Math.PI/180;p&&(p=e[a.segment],a.y===p.y&&a.x===p.x&&a.segment+1<e.length?(e=e[a.segment+1],b+=Math.atan2(a.y-e.y,a.x-e.x)+Math.PI):b+=Math.atan2(a.y-p.y,a.x-
p.x));b&&(e=Math.sin(b),p=Math.cos(b),e=[p,-e,e,p],c=c.matMult(e),d=d.matMult(e),r=r.matMult(e),k=k.matMult(e));h={x:h.textureRect.x-1,y:h.textureRect.y-1,w:h.textureRect.w+2,h:h.textureRect.h+2};return[new f(new n(a.x,a.y),c,d,r,k,h,0,0,l,Infinity)]},getGlyphQuads:function(a,g,h,e,b,k,m,r){m=b.getLayoutValue("text-rotate",m,r)*Math.PI/180;b=b.layout["text-keep-upright"];r=g.positionedGlyphs;for(var c=[],p=l,q=0;q<r.length;q++){var t=r[q],v=t.glyph;if(v){var B=v.rect;if(B){var w=(t.x+v.advance/2)*
h,x;k?(x=[],p=Math.max(p,d(x,a,w,e,a.segment,!1)),b&&(p=Math.max(p,d(x,a,w,e,a.segment,!0)))):x=[{anchorPoint:new n(a.x,a.y),upsideDown:!1,angle:0,maxScale:Infinity,minScale:l}];var C=t.x+v.left,w=t.y-v.top,z=C+B.w,E=w+B.h,D=new n(t.x,v.advance/2),v=new n(C,w),w=new n(z,w),C=new n(C,E),z=new n(z,E);0!==t.angle&&(v._sub(D)._rotate(t.angle)._add(D),w._sub(D)._rotate(t.angle)._add(D),C._sub(D)._rotate(t.angle)._add(D),z._sub(D)._rotate(t.angle)._add(D));for(t=0;t<x.length;t++){var E=x[t],D=v,H=w,I=C,
G=z;if(m)var F=Math.sin(m),K=Math.cos(m),F=[K,-F,F,K],D=D.matMult(F),H=H.matMult(F),I=I.matMult(F),G=G.matMult(F);c.push(new f(E.anchorPoint,D,H,I,G,B,(a.angle+(E.upsideDown?Math.PI:0)+2*Math.PI)%(2*Math.PI),(E.angle+(E.upsideDown?Math.PI:0)+2*Math.PI)%(2*Math.PI),Math.max(E.minScale,p),E.maxScale,g.writingMode))}}}}return c},SymbolQuad:f};var l=.5},{"point-geometry":26}],172:[function(a,k,m){function f(a,b,c,d,e){this.codePoint=a;this.x=b;this.y=c;this.glyph=d||null;this.angle=e}function d(a,b,c,
d,e,f,g){this.positionedGlyphs=a;this.text=b;this.top=c;this.bottom=d;this.left=e;this.right=f;this.writingMode=g}function n(a,b,c,d){var e=Math.pow(a-b,2);return d?a<b?e/2:2*e:e+Math.abs(c)*c}function l(a,b){var c=0;10===a&&(c-=1E4);if(40===a||65288===a)c+=50;if(41===b||65289===b)c+=50;return c}function c(a,b,c,d,e,f){for(var g=null,h=n(b,c,e,f),l=0;l<d.length;l+=1){var k=d[l],p=n(b-k.x,c,e,f)+k.badness;p<=h&&(g=k,h=p)}return{index:a,x:b,priorBreak:g,badness:h}}function g(a){return a?g(a.priorBreak).concat(a.index):
[]}function h(a,d,e,f){if(!e||!a)return[];var h=[],k=0,p;for(p in a){var n=f[a.charCodeAt(p)];n&&(k+=n.advance+d)}e=k/Math.max(1,Math.ceil(k/e));for(p=k=0;p<a.length;p++){var n=a.charCodeAt(p),m=f[n];m&&!u[n]&&(k+=m.advance+d);p<a.length-1&&(A[n]||b.charAllowsIdeographicBreaking(n))&&h.push(c(p+1,k,e,h,l(n,a.charCodeAt(p+1)),!1))}return g(c(a.length,k,e,h,0,!0))}function e(a,b,c,d,e){this.image=a;this.top=b;this.bottom=c;this.left=d;this.right=e}var b=a("../util/script_detection"),p=a("../util/verticalize_punctuation"),
q=a("../source/rtl_text_plugin"),r={horizontal:1,vertical:2};k.exports={shapeText:function(a,c,e,g,l,k,n,m,u,A,H){var z=a.trim();H===r.vertical&&(z=p(z));a=[];var t=new d(a,z,u[1],u[1],u[0],u[0],H),x;if(q.processBidirectionalText)x=q.processBidirectionalText(z,h(z,m,e,c));else{x=z;var y=[],v=0,w=0;for(e=h(z,m,e,c);w<e.length;w+=1)z=e[w],y.push(x.substring(v,z)),v=z;v<x.length&&y.push(x.substring(v,x.length));x=y}y=x;z=0;w=-17;x=0;var v=t.positionedGlyphs,E;for(E in y){var B=y[E].trim();if(B.length){e=
v.length;for(var C=0;C<B.length;C++){var D=B.charCodeAt(C),Q=c[D];Q&&(b.charHasUprightVerticalOrientation(D)&&H!==r.horizontal?(v.push(new f(D,z,0,Q,-Math.PI/2)),z+=A+m):(v.push(new f(D,z,w,Q,0)),z+=Q.advance+m))}if(v.length!==e&&(x=Math.max(z-m,x),z=v,B=v.length-1,n))for(C=(z[B].x+c[z[B].codePoint].advance)*n;e<=B;e++)z[e].x-=C;z=0}w+=g}c=(n-l)*x+u[0];u=(-k*y.length+.5)*g+u[1];for(n=0;n<v.length;n++)v[n].x+=c,v[n].y+=u;g*=y.length;t.top+=-k*g;t.bottom=t.top+g;t.left+=-l*x;t.right=t.left+x;return a.length?
t:!1},shapeIcon:function(a,b){var c=b[0]-a.displaySize[0]/2,d=b[1]-a.displaySize[1]/2;return new e(a,d,d+a.displaySize[1],c,c+a.displaySize[0])},WritingMode:r};var u={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},A={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0}},{"../source/rtl_text_plugin":92,"../util/script_detection":212,"../util/verticalize_punctuation":219}],173:[function(a,k,m){function f(a){var c={x:a.rect.x+1,y:a.rect.y+1,w:a.rect.w-2,h:a.rect.h-2};return{sdf:a.sdf,
pixelRatio:a.pixelRatio,isNativePixelRatio:a.pixelRatio===n.devicePixelRatio,textureRect:c,tl:[c.x,c.y],br:[c.x+c.w,c.y+c.h],displaySize:[c.w/a.pixelRatio,c.h/a.pixelRatio]}}var d=a("@mapbox/shelf-pack"),n=a("../util/browser"),l=a("../util/util"),c=a("../util/window");a=function(a){function g(c,b){a.call(this);this.images={};this.data=!1;this.filter=this.texture=0;this.width=c*n.devicePixelRatio;this.height=b*n.devicePixelRatio;this.shelfPack=new d(this.width,this.height);this.dirty=!0}a&&(g.__proto__=
a);g.prototype=Object.create(a&&a.prototype);g.prototype.constructor=g;g.prototype.getPixelSize=function(){return[this.width,this.height]};g.prototype.allocateImage=function(a,b){var c=this.shelfPack.packOne(a+2,b+2);return c?c:(l.warnOnce("SpriteAtlas out of space."),null)};g.prototype.addImage=function(a,b,d){var e,f;b instanceof c.HTMLImageElement?(e=b.width,f=b.height,b=n.getImageData(b),d=1):(e=d.width,f=d.height,d=d.pixelRatio||1);ArrayBuffer.isView(b)&&(b=new Uint32Array(b.buffer));if(!(b instanceof
Uint32Array))return this.fire("error",{error:Error("Image provided in an invalid format. Supported formats are HTMLImageElement and ArrayBufferView.")});if(this.images[a])return this.fire("error",{error:Error("An image with this name already exists.")});var g=this.allocateImage(e,f);if(!g)return this.fire("error",{error:Error("There is not enough space to add this image.")});this.images[a]={rect:g,width:e,height:f,pixelRatio:d,sdf:!1};this.copy(b,e,g,{x:0,y:0,width:e,height:f},!1);this.fire("data",
{dataType:"style"})};g.prototype.removeImage=function(a){var b=this.images[a];delete this.images[a];if(!b)return this.fire("error",{error:Error("No image with this name exists.")});this.shelfPack.unref(b.rect);this.fire("data",{dataType:"style"})};g.prototype.getIcon=function(a){return this._getImage(a,!1)};g.prototype.getPattern=function(a){return this._getImage(a,!0)};g.prototype._getImage=function(a,b){if(this.images[a])return f(this.images[a]);if(!this.sprite)return null;var c=this.sprite.getSpritePosition(a);
if(!c.width||!c.height)return null;var d=this.allocateImage(c.width,c.height);if(!d)return null;var e={rect:d,width:c.width,height:c.height,sdf:c.sdf,pixelRatio:c.pixelRatio};this.images[a]=e;if(!this.sprite.imgData)return null;var g=new Uint32Array(this.sprite.imgData.buffer);this.copy(g,this.sprite.width,d,c,b);return f(e)};g.prototype.allocate=function(){if(!this.data){this.data=new Uint32Array(this.width*this.height);for(var a=0;a<this.data.length;a++)this.data[a]=0}};g.prototype.copy=function(a,
b,c,d,f){this.allocate();var e=d.x,g=d.y,h=this.data,l=this.getPixelSize()[0],k=d.width;d=d.height;var p=g*b+e;c=(c.y+1)*l+(c.x+1);var n;if(f)for(c-=l,n=-1;n<=d;n++,c+=l)for(p=((n+d)%d+g)*b+e,f=-1;f<=k;f++)h[c+f]=a[p+(f+k)%k];else for(n=0;n<d;n++,p+=b,c+=l)for(f=0;f<k;f++)h[c+f]=a[p+f];this.dirty=!0};g.prototype.setSprite=function(a){a&&this.canvas&&(this.canvas.width=this.width,this.canvas.height=this.height);this.sprite=a};g.prototype.addIcons=function(a,b){for(var c={},d=0;d<a.length;d+=1){var e=
a[d];c[e]=this.getIcon(e)}b(null,c)};g.prototype.bind=function(a,b){var c=!1;this.texture?a.bindTexture(a.TEXTURE_2D,this.texture):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),c=!0);var d=b?a.LINEAR:a.NEAREST;d!==this.filter&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,d),a.texParameteri(a.TEXTURE_2D,
a.TEXTURE_MAG_FILTER,d),this.filter=d);this.dirty&&(this.allocate(),c?a.texImage2D(a.TEXTURE_2D,0,a.RGBA,this.width,this.height,0,a.RGBA,a.UNSIGNED_BYTE,new Uint8Array(this.data.buffer)):a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.RGBA,a.UNSIGNED_BYTE,new Uint8Array(this.data.buffer)),this.dirty=!1)};return g}(a("../util/evented"));k.exports=a},{"../util/browser":196,"../util/evented":204,"../util/util":217,"../util/window":198,"@mapbox/shelf-pack":2}],174:[function(a,k,m){var f=a("../source/rtl_text_plugin");
k.exports=function(a,k,l,c){k=k.getLayoutValue("text-transform",l,c);"uppercase"===k?a=a.toLocaleUpperCase():"lowercase"===k&&(a=a.toLocaleLowerCase());f.applyArabicShaping&&(a=f.applyArabicShaping(a));return a}},{"../source/rtl_text_plugin":92}],175:[function(a,k,m){var f=a("../util/dom"),d=a("point-geometry"),n={scrollZoom:a("./handler/scroll_zoom"),boxZoom:a("./handler/box_zoom"),dragRotate:a("./handler/drag_rotate"),dragPan:a("./handler/drag_pan"),keyboard:a("./handler/keyboard"),doubleClickZoom:a("./handler/dblclick_zoom"),
touchZoomRotate:a("./handler/touch_zoom_rotate")};k.exports=function(a,c){function g(){u=null}function h(c,d){var e=f.mousePos(b,d);return a.fire(c,{lngLat:a.unproject(e),point:e,originalEvent:d})}function e(c,e){var g=f.touchPos(b,e),h=g.reduce(function(a,b,c,d){return a.add(b.div(d.length))},new d(0,0));return a.fire(c,{lngLat:a.unproject(h),point:h,lngLats:g.map(function(b){return a.unproject(b)},this),points:g,originalEvent:e})}var b=a.getCanvasContainer(),l=null,k=!1,m=null,u=null,A;for(A in n)a[A]=
new n[A](a,c),c.interactive&&c[A]&&a[A].enable(c[A]);b.addEventListener("mouseout",function(a){h("mouseout",a)},!1);b.addEventListener("mousedown",function(c){a.stop();m=f.mousePos(b,c);h("mousedown",c);k=!0},!1);b.addEventListener("mouseup",function(b){var c=a.dragRotate&&a.dragRotate.isActive();l&&!c&&h("contextmenu",l);l=null;k=!1;h("mouseup",b)},!1);b.addEventListener("mousemove",function(c){if(!a.dragPan||!a.dragPan.isActive())if(!a.dragRotate||!a.dragRotate.isActive()){for(var d=c.toElement||
c.target;d&&d!==b;)d=d.parentNode;d===b&&h("mousemove",c)}},!1);b.addEventListener("touchstart",function(b){a.stop();e("touchstart",b);!b.touches||1<b.touches.length||(u?(clearTimeout(u),u=null,h("dblclick",b)):u=setTimeout(g,300))},!1);b.addEventListener("touchend",function(a){e("touchend",a)},!1);b.addEventListener("touchmove",function(a){e("touchmove",a)},!1);b.addEventListener("touchcancel",function(a){e("touchcancel",a)},!1);b.addEventListener("click",function(a){f.mousePos(b,a).equals(m)&&h("click",
a)},!1);b.addEventListener("dblclick",function(a){h("dblclick",a);a.preventDefault()},!1);b.addEventListener("contextmenu",function(b){var c=a.dragRotate&&a.dragRotate.isActive();k||c?k&&(l=b):h("contextmenu",b);b.preventDefault()},!1)}},{"../util/dom":203,"./handler/box_zoom":183,"./handler/dblclick_zoom":184,"./handler/drag_pan":185,"./handler/drag_rotate":186,"./handler/keyboard":187,"./handler/scroll_zoom":188,"./handler/touch_zoom_rotate":189,"point-geometry":26}],176:[function(a,k,m){var f=
a("../util/util"),d=a("../style-spec/util/interpolate"),n=a("../util/browser"),l=a("../geo/lng_lat"),c=a("../geo/lng_lat_bounds"),g=a("point-geometry");a=function(a){function e(b,c){a.call(this);this.moving=!1;this.transform=b;this._bearingSnap=c.bearingSnap}a&&(e.__proto__=a);e.prototype=Object.create(a&&a.prototype);e.prototype.constructor=e;e.prototype.getCenter=function(){return this.transform.center};e.prototype.setCenter=function(a,c){return this.jumpTo({center:a},c)};e.prototype.panBy=function(a,
c,d){a=g.convert(a).mult(-1);return this.panTo(this.transform.center,f.extend({offset:a},c),d)};e.prototype.panTo=function(a,c,d){return this.easeTo(f.extend({center:a},c),d)};e.prototype.getZoom=function(){return this.transform.zoom};e.prototype.setZoom=function(a,c){this.jumpTo({zoom:a},c);return this};e.prototype.zoomTo=function(a,c,d){return this.easeTo(f.extend({zoom:a},c),d)};e.prototype.zoomIn=function(a,c){this.zoomTo(this.getZoom()+1,a,c);return this};e.prototype.zoomOut=function(a,c){this.zoomTo(this.getZoom()-
1,a,c);return this};e.prototype.getBearing=function(){return this.transform.bearing};e.prototype.setBearing=function(a,c){this.jumpTo({bearing:a},c);return this};e.prototype.rotateTo=function(a,c,d){return this.easeTo(f.extend({bearing:a},c),d)};e.prototype.resetNorth=function(a,c){this.rotateTo(0,f.extend({duration:1E3},a),c);return this};e.prototype.snapToNorth=function(a,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(a,c):this};e.prototype.getPitch=function(){return this.transform.pitch};
e.prototype.setPitch=function(a,c){this.jumpTo({pitch:a},c);return this};e.prototype.fitBounds=function(a,d,e){d=f.extend({padding:{top:0,bottom:0,right:0,left:0},offset:[0,0],maxZoom:this.transform.maxZoom},d);if("number"===typeof d.padding){var b=d.padding;d.padding={top:b,bottom:b,right:b,left:b}}if(f.deepEqual(Object.keys(d.padding).sort(function(a,b){return a<b?-1:a>b?1:0}),["bottom","left","right","top"])){a=c.convert(a);var h=[d.padding.left-d.padding.right,d.padding.top-d.padding.bottom],
l=Math.min(d.padding.right,d.padding.left),b=Math.min(d.padding.top,d.padding.bottom);d.offset=[d.offset[0]+h[0],d.offset[1]+h[1]];var k=g.convert(d.offset),h=this.transform,p=h.project(a.getNorthWest());a=h.project(a.getSouthEast());var n=a.sub(p),l=(h.width-2*l-2*Math.abs(k.x))/n.x,b=(h.height-2*b-2*Math.abs(k.y))/n.y;if(0>b||0>l)f.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");else return d.center=h.unproject(p.add(a).div(2)),d.zoom=Math.min(h.scaleZoom(h.scale*
Math.min(l,b)),d.maxZoom),d.bearing=0,d.linear?this.easeTo(d,e):this.flyTo(d,e)}else f.warnOnce("options.padding must be a positive number, or an Object with keys 'bottom', 'left', 'right', 'top'")};e.prototype.jumpTo=function(a,c){this.stop();var b=this.transform,d=!1,e=!1,f=!1;"zoom"in a&&b.zoom!==+a.zoom&&(d=!0,b.zoom=+a.zoom);"center"in a&&(b.center=l.convert(a.center));"bearing"in a&&b.bearing!==+a.bearing&&(e=!0,b.bearing=+a.bearing);"pitch"in a&&b.pitch!==+a.pitch&&(f=!0,b.pitch=+a.pitch);
this.fire("movestart",c).fire("move",c);d&&this.fire("zoomstart",c).fire("zoom",c).fire("zoomend",c);e&&this.fire("rotate",c);f&&this.fire("pitchstart",c).fire("pitch",c).fire("pitchend",c);return this.fire("moveend",c)};e.prototype.easeTo=function(a,c){var b=this;this.stop();a=f.extend({offset:[0,0],duration:500,easing:f.ease},a);!1===a.animate&&(a.duration=0);a.smoothEasing&&0!==a.duration&&(a.easing=this._smoothOutEasing(a.duration));var e=this.transform,h=this.getZoom(),k=this.getBearing(),n=
this.getPitch(),p="zoom"in a?+a.zoom:h,m="bearing"in a?this._normalizeBearing(a.bearing,k):k,B="pitch"in a?+a.pitch:n,w=e.centerPoint.add(g.convert(a.offset)),x=e.pointLocation(w),C=l.convert(a.center||x);this._normalizeCenter(C);var z=e.project(x),E=e.project(C).sub(z),D=e.zoomScale(p-h),H,I;a.around&&(H=l.convert(a.around),I=e.locationPoint(H));this.zooming=p!==h;this.rotating=k!==m;this.pitching=B!==n;this._prepareEase(c,a.noMoveStart);clearTimeout(this._onEaseEnd);this._ease(function(a){this.zooming&&
(e.zoom=d(h,p,a));this.rotating&&(e.bearing=d(k,m,a));this.pitching&&(e.pitch=d(n,B,a));if(H)e.setLocationAtPoint(H,I);else{var b=e.zoomScale(e.zoom-h);a=e.unproject(z.add(E.mult(a*Math.pow(p>h?Math.min(2,D):Math.max(.5,D),1-a))).mult(b));e.setLocationAtPoint(e.renderWorldCopies?a.wrap():a,w)}this._fireMoveEvents(c)},function(){a.delayEndEvents?b._onEaseEnd=setTimeout(function(){return b._easeToEnd(c)},a.delayEndEvents):b._easeToEnd(c)},a);return this};e.prototype._prepareEase=function(a,c){this.moving=
!0;c||this.fire("movestart",a);this.zooming&&this.fire("zoomstart",a);this.pitching&&this.fire("pitchstart",a)};e.prototype._fireMoveEvents=function(a){this.fire("move",a);this.zooming&&this.fire("zoom",a);this.rotating&&this.fire("rotate",a);this.pitching&&this.fire("pitch",a)};e.prototype._easeToEnd=function(a){var b=this.zooming,c=this.pitching;this.pitching=this.rotating=this.zooming=this.moving=!1;b&&this.fire("zoomend",a);c&&this.fire("pitchend",a);this.fire("moveend",a)};e.prototype.flyTo=
function(a,c){function b(a){a=(K*K-F*F+(a?-1:1)*L*L*J*J)/(2*(a?K:F)*L*J);return Math.log(Math.sqrt(a*a+1)-a)}function e(a){return(Math.exp(a)+Math.exp(-a))/2}var h=this;this.stop();a=f.extend({offset:[0,0],speed:1.2,curve:1.42,easing:f.ease},a);var k=this.transform,n=this.getZoom(),p=this.getBearing(),m=this.getPitch(),B="zoom"in a?f.clamp(+a.zoom,k.minZoom,k.maxZoom):n,w="bearing"in a?this._normalizeBearing(a.bearing,p):p,x="pitch"in a?+a.pitch:m,C=k.zoomScale(B-n),z=k.centerPoint.add(g.convert(a.offset)),
E=k.pointLocation(z),D=l.convert(a.center||E);this._normalizeCenter(D);var H=k.project(E),I=k.project(D).sub(H),G=a.curve,F=Math.max(k.width,k.height),K=F/C,J=I.mag();"minZoom"in a&&(B=f.clamp(Math.min(a.minZoom,n,B),k.minZoom,k.maxZoom),B=F/k.zoomScale(B-n),G=Math.sqrt(B/J*2));var L=G*G,N=b(0),S=function(a){return e(N)/e(N+G*a)},O=function(a){var b=e(N);a=N+G*a;a=(Math.exp(a)-Math.exp(-a))/2/e(a);return(b*a-(Math.exp(N)-Math.exp(-N))/2)/L*F/J},P=(b(1)-N)/G;if(1E-6>Math.abs(J)||isNaN(P)){if(1E-6>
Math.abs(F-K))return this.easeTo(a,c);var Q=K<F?-1:1,P=Math.abs(Math.log(K/F))/G,O=function(){return 0},S=function(a){return Math.exp(Q*G*a)}}a.duration="duration"in a?+a.duration:1E3*P/("screenSpeed"in a?+a.screenSpeed/G:+a.speed);this.zooming=!0;this.rotating=p!==w;this.pitching=x!==m;this._prepareEase(c,!1);this._ease(function(a){var b=a*P,e=1/S(b);k.zoom=n+k.scaleZoom(e);this.rotating&&(k.bearing=d(p,w,a));this.pitching&&(k.pitch=d(m,x,a));a=k.unproject(H.add(I.mult(O(b))).mult(e));k.setLocationAtPoint(k.renderWorldCopies?
a.wrap():a,z);this._fireMoveEvents(c)},function(){return h._easeToEnd(c)},a);return this};e.prototype.isEasing=function(){return!!this._abortFn};e.prototype.isMoving=function(){return this.moving};e.prototype.stop=function(){this._abortFn&&(this._abortFn(),this._finishEase());return this};e.prototype._ease=function(a,c,d){this._finishFn=c;this._abortFn=n.timed(function(b){a.call(this,d.easing(b));1===b&&this._finishEase()},!1===d.animate?0:d.duration,this)};e.prototype._finishEase=function(){delete this._abortFn;
var a=this._finishFn;delete this._finishFn;a.call(this)};e.prototype._normalizeBearing=function(a,c){a=f.wrap(a,-180,180);var b=Math.abs(a-c);Math.abs(a-360-c)<b&&(a-=360);Math.abs(a+360-c)<b&&(a+=360);return a};e.prototype._normalizeCenter=function(a){var b=this.transform;b.renderWorldCopies&&!b.lngRange&&(b=a.lng-b.center.lng,a.lng+=180<b?-360:-180>b?360:0)};e.prototype._smoothOutEasing=function(a){var b=f.ease;if(this._prevEase)var b=this._prevEase,c=(Date.now()-b.start)/b.duration,b=b.easing(c+
.01)-b.easing(c),b=.27/Math.sqrt(b*b+1E-4)*.01,b=f.bezier(b,Math.sqrt(.0729-b*b),.25,1);this._prevEase={start:(new Date).getTime(),duration:a,easing:b};return b};return e}(a("../util/evented"));k.exports=a},{"../geo/lng_lat":62,"../geo/lng_lat_bounds":63,"../style-spec/util/interpolate":124,"../util/browser":196,"../util/evented":204,"../util/util":217,"point-geometry":26}],177:[function(a,k,m){var f=a("../../util/dom"),d=a("../../util/util"),n=a("../../util/config");a=function(a){this.options=a;
d.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};a.prototype.getDefaultPosition=function(){return"bottom-right"};a.prototype.onAdd=function(a){var c=this.options&&this.options.compact;this._map=a;this._container=f.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib");c&&this._container.classList.add("mapboxgl-compact");this._updateAttributions();this._updateEditLink();this._map.on("sourcedata",this._updateData);this._map.on("moveend",this._updateEditLink);void 0===c&&(this._map.on("resize",
this._updateCompact),this._updateCompact());return this._container};a.prototype.onRemove=function(){this._container.parentNode.removeChild(this._container);this._map.off("sourcedata",this._updateData);this._map.off("moveend",this._updateEditLink);this._map.off("resize",this._updateCompact);this._map=void 0};a.prototype._updateEditLink=function(){this._editLink||(this._editLink=this._container.querySelector(".mapbox-improve-map"));var a=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},
{key:"access_token",value:n.ACCESS_TOKEN}];if(this._editLink){var c=a.reduce(function(c,d,e){void 0!==d.value&&(c+=d.key+"="+d.value+(e<a.length-1?"&":""));return c},"?");this._editLink.href="https://www.mapbox.com/feedback/"+c+(this._map._hash?this._map._hash.getHashString(!0):"")}};a.prototype._updateData=function(a){a&&"metadata"===a.sourceDataType&&(this._updateAttributions(),this._updateEditLink())};a.prototype._updateAttributions=function(){if(this._map.style){var a=[];if(this._map.style.stylesheet){var c=
this._map.style.stylesheet;this.styleOwner=c.owner;this.styleId=c.id}var c=this._map.style.sourceCaches,d;for(d in c){var f=c[d].getSource();f.attribution&&0>a.indexOf(f.attribution)&&a.push(f.attribution)}a.sort(function(a,b){return a.length-b.length});a=a.filter(function(c,b){for(var d=b+1;d<a.length;d++)if(0<=a[d].indexOf(c))return!1;return!0});this._container.innerHTML=a.join(" | ");this._editLink=null}};a.prototype._updateCompact=function(){var a=640>=this._map.getCanvasContainer().offsetWidth;
this._container.classList[a?"add":"remove"]("mapboxgl-compact")};k.exports=a},{"../../util/config":200,"../../util/dom":203,"../../util/util":217}],178:[function(a,k,m){var f=a("../../util/dom"),d=a("../../util/util"),n=a("../../util/window");a=function(){this._fullscreen=!1;d.bindAll(["_onClickFullscreen","_changeIcon"],this);"onfullscreenchange"in n.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in n.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in
n.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in n.document&&(this._fullscreenchange="MSFullscreenChange")};a.prototype.onAdd=function(a){var c=this._container=f.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),d=this._fullscreenButton=f.create("button","mapboxgl-ctrl-icon mapboxgl-ctrl-fullscreen",this._container);d.setAttribute("aria-label","Toggle fullscreen");d.type="button";this._fullscreenButton.addEventListener("click",this._onClickFullscreen);this._mapContainer=
a.getContainer();n.document.addEventListener(this._fullscreenchange,this._changeIcon);return c};a.prototype.onRemove=function(){this._container.parentNode.removeChild(this._container);this._map=null;n.document.removeEventListener(this._fullscreenchange,this._changeIcon)};a.prototype._isFullscreen=function(){return this._fullscreen};a.prototype._changeIcon=function(){(n.document.fullscreenElement||n.document.mozFullScreenElement||n.document.webkitFullscreenElement||n.document.msFullscreenElement)===
this._mapContainer!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"))};a.prototype._onClickFullscreen=function(){this._isFullscreen()?n.document.exitFullscreen?n.document.exitFullscreen():n.document.mozCancelFullScreen?n.document.mozCancelFullScreen():n.document.msExitFullscreen?n.document.msExitFullscreen():n.document.webkitCancelFullScreen&&n.document.webkitCancelFullScreen():
this._mapContainer.requestFullscreen?this._mapContainer.requestFullscreen():this._mapContainer.mozRequestFullScreen?this._mapContainer.mozRequestFullScreen():this._mapContainer.msRequestFullscreen?this._mapContainer.msRequestFullscreen():this._mapContainer.webkitRequestFullscreen&&this._mapContainer.webkitRequestFullscreen()};k.exports=a},{"../../util/dom":203,"../../util/util":217,"../../util/window":198}],179:[function(a,k,m){function f(a){void 0!==g?a(g):void 0!==n.navigator.permissions?n.navigator.permissions.query({name:"geolocation"}).then(function(c){g=
"denied"!==c.state;a(g)}):(g=!!n.navigator.geolocation,a(g))}m=a("../../util/evented");var d=a("../../util/dom"),n=a("../../util/window"),l=a("../../util/util"),c={enableHighAccuracy:!1,timeout:6E3},g;a=function(a){function e(b){a.call(this);this.options=b||{};l.bindAll(["_onSuccess","_onError","_finish","_setupUI"],this)}a&&(e.__proto__=a);e.prototype=Object.create(a&&a.prototype);e.prototype.constructor=e;e.prototype.onAdd=function(a){this._map=a;this._container=d.create("div","mapboxgl-ctrl mapboxgl-ctrl-group");
f(this._setupUI);return this._container};e.prototype.onRemove=function(){this._container.parentNode.removeChild(this._container);this._map=void 0};e.prototype._onSuccess=function(a){this._map.jumpTo({center:[a.coords.longitude,a.coords.latitude],zoom:17,bearing:0,pitch:0});this.fire("geolocate",a);this._finish()};e.prototype._onError=function(a){this.fire("error",a);this._finish()};e.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId);this._timeoutId=void 0};e.prototype._setupUI=
function(a){!1!==a&&(this._container.addEventListener("contextmenu",function(a){return a.preventDefault()}),this._geolocateButton=d.create("button","mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",this._container),this._geolocateButton.type="button",this._geolocateButton.setAttribute("aria-label","Geolocate"),this.options.watchPosition&&this._geolocateButton.setAttribute("aria-pressed",!1),this._geolocateButton.addEventListener("click",this._onClickGeolocate.bind(this)))};e.prototype._onClickGeolocate=
function(){var a=l.extend(c,this.options&&this.options.positionOptions||{});this.options.watchPosition?void 0!==this._geolocationWatchID?(this._geolocateButton.classList.remove("mapboxgl-watching"),this._geolocateButton.setAttribute("aria-pressed",!1),n.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0):(this._geolocateButton.classList.add("mapboxgl-watching"),this._geolocateButton.setAttribute("aria-pressed",!0),this._geolocationWatchID=n.navigator.geolocation.watchPosition(this._onSuccess,
this._onError,a)):(n.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,a),this._timeoutId=setTimeout(this._finish,1E4))};return e}(m);k.exports=a},{"../../util/dom":203,"../../util/evented":204,"../../util/util":217,"../../util/window":198}],180:[function(a,k,m){var f=a("../../util/dom"),d=a("../../util/util");a=function(){d.bindAll(["_updateLogo"],this)};a.prototype.onAdd=function(a){this._map=a;this._container=f.create("div","mapboxgl-ctrl");this._map.on("sourcedata",this._updateLogo);
this._updateLogo();return this._container};a.prototype.onRemove=function(){this._container.parentNode.removeChild(this._container);this._map.off("sourcedata",this._updateLogo)};a.prototype.getDefaultPosition=function(){return"bottom-left"};a.prototype._updateLogo=function(a){if(a&&"metadata"===a.sourceDataType)if(!this._container.childNodes.length&&this._logoRequired())a=f.create("a","mapboxgl-ctrl-logo"),a.target="_blank",a.href="https://www.mapbox.com/",a.setAttribute("aria-label","Mapbox logo"),
this._container.appendChild(a),this._map.off("data",this._updateLogo);else if(this._container.childNodes.length&&!this._logoRequired())this.onRemove()};a.prototype._logoRequired=function(){if(this._map.style){var a=this._map.style.sourceCaches,d;for(d in a)if(a[d].getSource().mapbox_logo)return!0;return!1}};k.exports=a},{"../../util/dom":203,"../../util/util":217}],181:[function(a,k,m){function f(a){return new n.MouseEvent(a.type,{button:2,buttons:2,bubbles:!0,cancelable:!0,detail:a.detail,view:a.view,
screenX:a.screenX,screenY:a.screenY,clientX:a.clientX,clientY:a.clientY,movementX:a.movementX,movementY:a.movementY,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,altKey:a.altKey,metaKey:a.metaKey})}var d=a("../../util/dom"),n=a("../../util/window"),l=a("../../util/util");a=function(){l.bindAll(["_rotateCompassArrow"],this)};a.prototype._rotateCompassArrow=function(){this._compassArrow.style.transform="rotate("+180/Math.PI*this._map.transform.angle+"deg)"};a.prototype.onAdd=function(a){this._map=a;this._container=
d.create("div","mapboxgl-ctrl mapboxgl-ctrl-group",a.getContainer());this._container.addEventListener("contextmenu",this._onContextMenu.bind(this));this._zoomInButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-in","Zoom In",a.zoomIn.bind(a));this._zoomOutButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-out","Zoom Out",a.zoomOut.bind(a));this._compass=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-compass","Reset North",a.resetNorth.bind(a));this._compassArrow=
d.create("span","mapboxgl-ctrl-compass-arrow",this._compass);this._compass.addEventListener("mousedown",this._onCompassDown.bind(this));this._onCompassMove=this._onCompassMove.bind(this);this._onCompassUp=this._onCompassUp.bind(this);this._map.on("rotate",this._rotateCompassArrow);this._rotateCompassArrow();return this._container};a.prototype.onRemove=function(){this._container.parentNode.removeChild(this._container);this._map.off("rotate",this._rotateCompassArrow);this._map=void 0};a.prototype._onContextMenu=
function(a){a.preventDefault()};a.prototype._onCompassDown=function(a){0===a.button&&(d.disableDrag(),n.document.addEventListener("mousemove",this._onCompassMove),n.document.addEventListener("mouseup",this._onCompassUp),this._map.getCanvasContainer().dispatchEvent(f(a)),a.stopPropagation())};a.prototype._onCompassMove=function(a){0===a.button&&(this._map.getCanvasContainer().dispatchEvent(f(a)),a.stopPropagation())};a.prototype._onCompassUp=function(a){0===a.button&&(n.document.removeEventListener("mousemove",
this._onCompassMove),n.document.removeEventListener("mouseup",this._onCompassUp),d.enableDrag(),this._map.getCanvasContainer().dispatchEvent(f(a)),a.stopPropagation())};a.prototype._createButton=function(a,f,h){a=d.create("button",a,this._container);a.type="button";a.setAttribute("aria-label",f);a.addEventListener("click",function(){h()});return a};k.exports=a},{"../../util/dom":203,"../../util/util":217,"../../util/window":198}],182:[function(a,k,m){function f(a,c,d,f){var e;e=Math.pow(10,(""+Math.floor(d)).length-
1);var b=d/e;e*=10<=b?10:5<=b?5:3<=b?3:2<=b?2:1;d=e/d;"m"===f&&1E3<=e&&(e/=1E3,f="km");a.style.width=c*d+"px";a.innerHTML=e+f}var d=a("../../util/dom"),n=a("../../util/util");a=function(a){this.options=a;n.bindAll(["_onMove"],this)};a.prototype.getDefaultPosition=function(){return"bottom-left"};a.prototype._onMove=function(){var a=this._map,c=this._container,d=this.options,h=d&&d.maxWidth||100,e=a._container.clientHeight/2,b;b=a.unproject([0,e]);var a=a.unproject([h,e]),e=Math.PI/180,k=b.lat*e,n=
a.lat*e;b=6371E3*Math.acos(Math.min(Math.sin(k)*Math.sin(n)+Math.cos(k)*Math.cos(n)*Math.cos((a.lng-b.lng)*e),1));d&&"imperial"===d.unit?(d=3.2808*b,5280<d?f(c,h,d/5280,"mi"):f(c,h,d,"ft")):f(c,h,b,"m")};a.prototype.onAdd=function(a){this._map=a;this._container=d.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",a.getContainer());this._map.on("move",this._onMove);this._onMove();return this._container};a.prototype.onRemove=function(){this._container.parentNode.removeChild(this._container);this._map.off("move",
this._onMove);this._map=void 0};k.exports=a},{"../../util/dom":203,"../../util/util":217}],183:[function(a,k,m){var f=a("../../util/dom"),d=a("../../geo/lng_lat_bounds"),n=a("../../util/util"),l=a("../../util/window");a=function(a){this._map=a;this._el=a.getCanvasContainer();this._container=a.getContainer();n.bindAll(["_onMouseDown","_onMouseMove","_onMouseUp","_onKeyDown"],this)};a.prototype.isEnabled=function(){return!!this._enabled};a.prototype.isActive=function(){return!!this._active};a.prototype.enable=
function(){this.isEnabled()||(this._map.dragPan&&this._map.dragPan.disable(),this._el.addEventListener("mousedown",this._onMouseDown,!1),this._map.dragPan&&this._map.dragPan.enable(),this._enabled=!0)};a.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("mousedown",this._onMouseDown),this._enabled=!1)};a.prototype._onMouseDown=function(a){a.shiftKey&&0===a.button&&(l.document.addEventListener("mousemove",this._onMouseMove,!1),l.document.addEventListener("keydown",this._onKeyDown,
!1),l.document.addEventListener("mouseup",this._onMouseUp,!1),f.disableDrag(),this._startPos=f.mousePos(this._el,a),this._active=!0)};a.prototype._onMouseMove=function(a){var c=this._startPos,d=f.mousePos(this._el,a);this._box||(this._box=f.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",a));a=Math.min(c.x,d.x);var e=Math.max(c.x,d.x),b=Math.min(c.y,d.y),c=Math.max(c.y,d.y);f.setTransform(this._box,"translate("+a+
"px,"+b+"px)");this._box.style.width=e-a+"px";this._box.style.height=c-b+"px"};a.prototype._onMouseUp=function(a){if(0===a.button){var c=this._startPos,h=f.mousePos(this._el,a),e=(new d).extend(this._map.unproject(c)).extend(this._map.unproject(h));this._finish();c.x===h.x&&c.y===h.y?this._fireEvent("boxzoomcancel",a):this._map.fitBounds(e,{linear:!0}).fire("boxzoomend",{originalEvent:a,boxZoomBounds:e})}};a.prototype._onKeyDown=function(a){27===a.keyCode&&(this._finish(),this._fireEvent("boxzoomcancel",
a))};a.prototype._finish=function(){this._active=!1;l.document.removeEventListener("mousemove",this._onMouseMove,!1);l.document.removeEventListener("keydown",this._onKeyDown,!1);l.document.removeEventListener("mouseup",this._onMouseUp,!1);this._container.classList.remove("mapboxgl-crosshair");this._box&&(this._box.parentNode.removeChild(this._box),this._box=null);f.enableDrag()};a.prototype._fireEvent=function(a,d){return this._map.fire(a,{originalEvent:d})};k.exports=a},{"../../geo/lng_lat_bounds":63,
"../../util/dom":203,"../../util/util":217,"../../util/window":198}],184:[function(a,k,m){a=function(a){this._map=a;this._onDblClick=this._onDblClick.bind(this)};a.prototype.isEnabled=function(){return!!this._enabled};a.prototype.enable=function(){this.isEnabled()||(this._map.on("dblclick",this._onDblClick),this._enabled=!0)};a.prototype.disable=function(){this.isEnabled()&&(this._map.off("dblclick",this._onDblClick),this._enabled=!1)};a.prototype._onDblClick=function(a){this._map.zoomTo(this._map.getZoom()+
(a.originalEvent.shiftKey?-1:1),{around:a.lngLat},a)};k.exports=a},{}],185:[function(a,k,m){var f=a("../../util/dom"),d=a("../../util/util"),n=a("../../util/window"),l=d.bezier(0,0,.3,1);a=function(a){this._map=a;this._el=a.getCanvasContainer();d.bindAll(["_onDown","_onMove","_onUp","_onTouchEnd","_onMouseUp"],this)};a.prototype.isEnabled=function(){return!!this._enabled};a.prototype.isActive=function(){return!!this._active};a.prototype.enable=function(){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-drag-pan"),
this._el.addEventListener("mousedown",this._onDown),this._el.addEventListener("touchstart",this._onDown),this._enabled=!0)};a.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-drag-pan"),this._el.removeEventListener("mousedown",this._onDown),this._el.removeEventListener("touchstart",this._onDown),this._enabled=!1)};a.prototype._onDown=function(a){this._ignoreEvent(a)||this.isActive()||(a.touches?(n.document.addEventListener("touchmove",this._onMove),n.document.addEventListener("touchend",
this._onTouchEnd)):(n.document.addEventListener("mousemove",this._onMove),n.document.addEventListener("mouseup",this._onMouseUp)),n.addEventListener("blur",this._onMouseUp),this._active=!1,this._startPos=this._pos=f.mousePos(this._el,a),this._inertia=[[Date.now(),this._pos]])};a.prototype._onMove=function(a){if(!this._ignoreEvent(a)){this.isActive()||(this._active=!0,this._map.moving=!0,this._fireEvent("dragstart",a),this._fireEvent("movestart",a));var c=f.mousePos(this._el,a),d=this._map;d.stop();
this._drainInertiaBuffer();this._inertia.push([Date.now(),c]);d.transform.setLocationAtPoint(d.transform.pointLocation(this._pos),c);this._fireEvent("drag",a);this._fireEvent("move",a);this._pos=c;a.preventDefault()}};a.prototype._onUp=function(a){var c=this;if(this.isActive()){this._active=!1;this._fireEvent("dragend",a);this._drainInertiaBuffer();var d=function(){c._map.moving=!1;c._fireEvent("moveend",a)},e=this._inertia;if(2>e.length)d();else{var b=e[e.length-1],e=e[0],f=b[1].sub(e[1]),k=(b[0]-
e[0])/1E3;0===k||b[1].equals(e[1])?d():(d=f.mult(.3/k),b=d.mag(),1400<b&&(b=1400,d._unit()._mult(b)),b/=750,d=d.mult(-b/2),this._map.panBy(d,{duration:1E3*b,easing:l,noMoveStart:!0},{originalEvent:a}))}}};a.prototype._onMouseUp=function(a){this._ignoreEvent(a)||(this._onUp(a),n.document.removeEventListener("mousemove",this._onMove),n.document.removeEventListener("mouseup",this._onMouseUp),n.removeEventListener("blur",this._onMouseUp))};a.prototype._onTouchEnd=function(a){this._ignoreEvent(a)||(this._onUp(a),
n.document.removeEventListener("touchmove",this._onMove),n.document.removeEventListener("touchend",this._onTouchEnd))};a.prototype._fireEvent=function(a,d){return this._map.fire(a,{originalEvent:d})};a.prototype._ignoreEvent=function(a){var c=this._map;return c.boxZoom&&c.boxZoom.isActive()||c.dragRotate&&c.dragRotate.isActive()?!0:a.touches?1<a.touches.length:a.ctrlKey?!0:"mousemove"===a.type?a.buttons&0:a.button&&0!==a.button};a.prototype._drainInertiaBuffer=function(){for(var a=this._inertia,d=
Date.now();0<a.length&&160<d-a[0][0];)a.shift()};k.exports=a},{"../../util/dom":203,"../../util/util":217,"../../util/window":198}],186:[function(a,k,m){var f=a("../../util/dom"),d=a("../../util/util"),n=a("../../util/window"),l=d.bezier(0,0,.25,1);a=function(a,f){this._map=a;this._el=a.getCanvasContainer();this._bearingSnap=f.bearingSnap;this._pitchWithRotate=!1!==f.pitchWithRotate;d.bindAll(["_onDown","_onMove","_onUp"],this)};a.prototype.isEnabled=function(){return!!this._enabled};a.prototype.isActive=
function(){return!!this._active};a.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("mousedown",this._onDown),this._enabled=!0)};a.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("mousedown",this._onDown),this._enabled=!1)};a.prototype._onDown=function(a){this._ignoreEvent(a)||this.isActive()||(n.document.addEventListener("mousemove",this._onMove),n.document.addEventListener("mouseup",this._onUp),n.addEventListener("blur",this._onUp),this._active=
!1,this._inertia=[[Date.now(),this._map.getBearing()]],this._startPos=this._pos=f.mousePos(this._el,a),this._center=this._map.transform.centerPoint,a.preventDefault())};a.prototype._onMove=function(a){if(!this._ignoreEvent(a)){this.isActive()||(this._active=!0,this._map.moving=!0,this._fireEvent("rotatestart",a),this._fireEvent("movestart",a),this._pitchWithRotate&&this._fireEvent("pitchstart",a));var c=this._map;c.stop();var d=this._pos,e=f.mousePos(this._el,a),b=.8*(d.x-e.x),d=-.5*(d.y-e.y),b=c.getBearing()-
b,d=c.getPitch()-d,k=this._inertia,l=k[k.length-1];this._drainInertiaBuffer();k.push([Date.now(),c._normalizeBearing(b,l[1])]);c.transform.bearing=b;this._pitchWithRotate&&(this._fireEvent("pitch",a),c.transform.pitch=d);this._fireEvent("rotate",a);this._fireEvent("move",a);this._pos=e}};a.prototype._onUp=function(a){var c=this;if(!this._ignoreEvent(a)&&(n.document.removeEventListener("mousemove",this._onMove),n.document.removeEventListener("mouseup",this._onUp),n.removeEventListener("blur",this._onUp),
this.isActive())){this._active=!1;this._fireEvent("rotateend",a);this._drainInertiaBuffer();var d=this._map,e=d.getBearing(),b=this._inertia,f=function(){Math.abs(e)<c._bearingSnap?d.resetNorth({noMoveStart:!0},{originalEvent:a}):(c._map.moving=!1,c._fireEvent("moveend",a));c._pitchWithRotate&&c._fireEvent("pitchend",a)};if(2>b.length)f();else{var k=b[0],m=b[b.length-1],b=d._normalizeBearing(e,b[b.length-2][1]),u=m[1]-k[1],A=0>u?-1:1,k=(m[0]-k[0])/1E3;0===u||0===k?f():(f=Math.abs(.25/k*u),180<f&&
(f=180),k=f/180,b+=k/2*f*A,Math.abs(d._normalizeBearing(b,0))<this._bearingSnap&&(b=d._normalizeBearing(0,b)),d.rotateTo(b,{duration:1E3*k,easing:l,noMoveStart:!0},{originalEvent:a}))}}};a.prototype._fireEvent=function(a,d){return this._map.fire(a,{originalEvent:d})};a.prototype._ignoreEvent=function(a){var c=this._map;if(c.boxZoom&&c.boxZoom.isActive()||c.dragPan&&c.dragPan.isActive())return!0;if(a.touches)return 1<a.touches.length;var c=a.ctrlKey?1:2,d=a.ctrlKey?0:2,e=a.button;"undefined"!==typeof InstallTrigger&&
2===a.button&&a.ctrlKey&&0<=n.navigator.platform.toUpperCase().indexOf("MAC")&&(e=0);return"mousemove"===a.type?a.buttons&0===c:!this.isActive()&&e!==d};a.prototype._drainInertiaBuffer=function(){for(var a=this._inertia,d=Date.now();0<a.length&&160<d-a[0][0];)a.shift()};k.exports=a},{"../../util/dom":203,"../../util/util":217,"../../util/window":198}],187:[function(a,k,m){function f(a){return a*(2-a)}a=function(a){this._map=a;this._el=a.getCanvasContainer();this._onKeyDown=this._onKeyDown.bind(this)};
a.prototype.isEnabled=function(){return!!this._enabled};a.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("keydown",this._onKeyDown,!1),this._enabled=!0)};a.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("keydown",this._onKeyDown),this._enabled=!1)};a.prototype._onKeyDown=function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var d=0,k=0,c=0,g=0,h=0;switch(a.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;
case 37:a.shiftKey?k=-1:(a.preventDefault(),g=-1);break;case 39:a.shiftKey?k=1:(a.preventDefault(),g=1);break;case 38:a.shiftKey?c=1:(a.preventDefault(),h=-1);break;case 40:a.shiftKey?c=-1:(h=1,a.preventDefault());break;default:return}var e=this._map,b=e.getZoom(),d={duration:300,delayEndEvents:500,easing:f,zoom:d?Math.round(b)+d*(a.shiftKey?2:1):b,bearing:e.getBearing()+15*k,pitch:e.getPitch()+10*c,offset:[100*-g,100*-h],center:e.getCenter()};e.easeTo(d,{originalEvent:a})}};k.exports=a},{}],188:[function(a,
k,m){var f=a("../../util/dom"),d=a("../../util/util"),n=a("../../util/browser"),l=a("../../util/window");a=l.navigator.userAgent.toLowerCase();var c=-1!==a.indexOf("firefox"),g=-1!==a.indexOf("safari")&&-1===a.indexOf("chrom");a=function(a){this._map=a;this._el=a.getCanvasContainer();d.bindAll(["_onWheel","_onTimeout"],this)};a.prototype.isEnabled=function(){return!!this._enabled};a.prototype.enable=function(a){this.isEnabled()||(this._el.addEventListener("wheel",this._onWheel,!1),this._el.addEventListener("mousewheel",
this._onWheel,!1),this._enabled=!0,this._aroundCenter=a&&"center"===a.around)};a.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("wheel",this._onWheel),this._el.removeEventListener("mousewheel",this._onWheel),this._enabled=!1)};a.prototype._onWheel=function(a){var d;"wheel"===a.type?(d=a.deltaY,c&&a.deltaMode===l.WheelEvent.DOM_DELTA_PIXEL&&(d/=n.devicePixelRatio),a.deltaMode===l.WheelEvent.DOM_DELTA_LINE&&(d*=40)):"mousewheel"===a.type&&(d=-a.wheelDeltaY,g&&(d/=3));var b=
n.now(),h=b-(this._time||0);this._pos=f.mousePos(this._el,a);this._time=b;0!==d&&0===d%4.000244140625?this._type="wheel":0!==d&&4>Math.abs(d)?this._type="trackpad":400<h?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40)):this._type||(this._type=200>Math.abs(h*d)?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue));a.shiftKey&&d&&(d/=4);this._type&&this._zoom(-d,a);a.preventDefault()};a.prototype._onTimeout=function(){this._type=
"wheel";this._zoom(-this._lastValue)};a.prototype._zoom=function(a,c){if(0!==a){var b=this._map,d=2/(1+Math.exp(-Math.abs(a/100)));0>a&&0!==d&&(d=1/d);d=b.transform.scaleZoom((b.ease?b.ease.to:b.transform.scale)*d);b.zoomTo(d,{duration:"wheel"===this._type?200:0,around:this._aroundCenter?b.getCenter():b.unproject(this._pos),delayEndEvents:200,smoothEasing:!0},{originalEvent:c})}};k.exports=a},{"../../util/browser":196,"../../util/dom":203,"../../util/util":217,"../../util/window":198}],189:[function(a,
k,m){var f=a("../../util/dom"),d=a("../../util/util"),n=a("../../util/window"),l=d.bezier(0,0,.15,1);a=function(a){this._map=a;this._el=a.getCanvasContainer();d.bindAll(["_onStart","_onMove","_onEnd"],this)};a.prototype.isEnabled=function(){return!!this._enabled};a.prototype.enable=function(a){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-zoom-rotate"),this._el.addEventListener("touchstart",this._onStart,!1),this._enabled=!0,this._aroundCenter=a&&"center"===a.around)};a.prototype.disable=
function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-zoom-rotate"),this._el.removeEventListener("touchstart",this._onStart),this._enabled=!1)};a.prototype.disableRotation=function(){this._rotationDisabled=!0};a.prototype.enableRotation=function(){this._rotationDisabled=!1};a.prototype._onStart=function(a){if(2===a.touches.length){var c=f.mousePos(this._el,a.touches[0]);a=f.mousePos(this._el,a.touches[1]);this._startVec=c.sub(a);this._startScale=this._map.transform.scale;this._startBearing=
this._map.transform.bearing;this._gestureIntent=void 0;this._inertia=[];n.document.addEventListener("touchmove",this._onMove,!1);n.document.addEventListener("touchend",this._onEnd,!1)}};a.prototype._onMove=function(a){if(2===a.touches.length){var c=f.mousePos(this._el,a.touches[0]),d=f.mousePos(this._el,a.touches[1]),e=c.add(d).div(2),b=c.sub(d),k=b.mag()/this._startVec.mag(),c=this._rotationDisabled?0:180*b.angleWith(this._startVec)/Math.PI,d=this._map;if(this._gestureIntent){b={duration:0,around:d.unproject(e)};
"rotate"===this._gestureIntent&&(b.bearing=this._startBearing+c);if("zoom"===this._gestureIntent||"rotate"===this._gestureIntent)b.zoom=d.transform.scaleZoom(this._startScale*k);d.stop();this._drainInertiaBuffer();this._inertia.push([Date.now(),k,e]);d.easeTo(b,{originalEvent:a})}else e=.15<Math.abs(1-k),4<Math.abs(c)?this._gestureIntent="rotate":e&&(this._gestureIntent="zoom"),this._gestureIntent&&(this._startVec=b,this._startScale=d.transform.scale,this._startBearing=d.transform.bearing);a.preventDefault()}};
a.prototype._onEnd=function(a){n.document.removeEventListener("touchmove",this._onMove);n.document.removeEventListener("touchend",this._onEnd);this._drainInertiaBuffer();var c=this._inertia,d=this._map;if(2>c.length)d.snapToNorth({},{originalEvent:a});else{var e=c[c.length-1],b=c[0],c=d.transform.scaleZoom(this._startScale*e[1]),f=d.transform.scaleZoom(this._startScale*b[1]),k=c-f,b=(e[0]-b[0])/1E3,e=e[2];0===b||c===f?d.snapToNorth({},{originalEvent:a}):(k=.15*k/b,2.5<Math.abs(k)&&(k=0<k?2.5:-2.5),
f=1E3*Math.abs(k/(12*.15)),c+=k*f/2E3,0>c&&(c=0),d.easeTo({zoom:c,duration:f,easing:l,around:this._aroundCenter?d.getCenter():d.unproject(e)},{originalEvent:a}))}};a.prototype._drainInertiaBuffer=function(){for(var a=this._inertia,d=Date.now();2<a.length&&160<d-a[0][0];)a.shift()};k.exports=a},{"../../util/dom":203,"../../util/util":217,"../../util/window":198}],190:[function(a,k,m){var f=a("../util/util"),d=a("../util/window");a=function(){f.bindAll(["_onHashChange","_updateHash"],this)};a.prototype.addTo=
function(a){this._map=a;d.addEventListener("hashchange",this._onHashChange,!1);this._map.on("moveend",this._updateHash);return this};a.prototype.remove=function(){d.removeEventListener("hashchange",this._onHashChange,!1);this._map.off("moveend",this._updateHash);delete this._map;return this};a.prototype.getHashString=function(a){var d=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,f=Math.max(0,Math.ceil(Math.log(c)/Math.LN2)),h=Math.round(d.lng*Math.pow(10,f))/Math.pow(10,f),d=Math.round(d.lat*
Math.pow(10,f))/Math.pow(10,f),f=this._map.getBearing(),e=this._map.getPitch(),b="",b=a?b+("#/"+h+"/"+d+"/"+c):b+("#"+c+"/"+d+"/"+h);if(f||e)b+="/"+Math.round(10*f)/10;e&&(b+="/"+Math.round(e));return b};a.prototype._onHashChange=function(){var a=d.location.hash.replace("#","").split("/");return 3<=a.length?(this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:+(a[3]||0),pitch:+(a[4]||0)}),!0):!1};a.prototype._updateHash=function(){var a=this.getHashString();d.history.replaceState("","",a)};
k.exports=a},{"../util/util":217,"../util/window":198}],191:[function(a,k,m){var f=a("../util/util"),d=a("../util/browser"),n=a("../util/window"),l=a("../util/dom"),c=a("../util/ajax"),g=a("../style/style"),h=a("../style/animation_loop"),e=a("../render/painter"),b=a("../geo/transform"),p=a("./hash"),q=a("./bind_handlers");m=a("./camera");var r=a("../geo/lng_lat"),u=a("../geo/lng_lat_bounds"),A=a("point-geometry"),y=a("./control/attribution_control"),t=a("./control/logo_control"),v=a("mapbox-gl-supported"),
B={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:0,maxZoom:22,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,bearingSnap:7,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0};a=function(a){function k(c){var d=this;c=f.extend({},B,c);if(null!=c.minZoom&&null!=c.maxZoom&&c.minZoom>c.maxZoom)throw Error("maxZoom must be greater than minZoom");
var e=new b(c.minZoom,c.maxZoom,c.renderWorldCopies);a.call(this,e,c);this._interactive=c.interactive;this._failIfMajorPerformanceCaveat=c.failIfMajorPerformanceCaveat;this._preserveDrawingBuffer=c.preserveDrawingBuffer;this._trackResize=c.trackResize;this._bearingSnap=c.bearingSnap;this._refreshExpiredTiles=c.refreshExpiredTiles;if("string"===typeof c.container){if(this._container=n.document.getElementById(c.container),!this._container)throw Error("Container '"+c.container+"' not found.");}else this._container=
c.container;this.animationLoop=new h;c.maxBounds&&this.setMaxBounds(c.maxBounds);f.bindAll("_onWindowOnline _onWindowResize _contextLost _contextRestored _update _render _onData _onDataLoading".split(" "),this);this._setupContainer();this._setupPainter();this.on("move",this._update.bind(this,!1));this.on("zoom",this._update.bind(this,!0));this.on("moveend",function(){d.animationLoop.set(300);d._rerender()});"undefined"!==typeof n&&(n.addEventListener("online",this._onWindowOnline,!1),n.addEventListener("resize",
this._onWindowResize,!1));q(this,c);(this._hash=c.hash&&(new p).addTo(this))&&this._hash._onHashChange()||this.jumpTo({center:c.center,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch});this._classes=[];this.resize();c.classes&&this.setClasses(c.classes);c.style&&this.setStyle(c.style);c.attributionControl&&this.addControl(new y);this.addControl(new t,c.logoPosition);this.on("style.load",function(){this.transform.unmodified&&this.jumpTo(this.style.stylesheet);this.style.update(this._classes,{transition:!1})});
this.on("data",this._onData);this.on("dataloading",this._onDataLoading)}a&&(k.__proto__=a);k.prototype=Object.create(a&&a.prototype);k.prototype.constructor=k;var m={showTileBoundaries:{},showCollisionBoxes:{},showOverdrawInspector:{},repaint:{},vertices:{}};k.prototype.addControl=function(a,b){void 0===b&&a.getDefaultPosition&&(b=a.getDefaultPosition());void 0===b&&(b="top-right");var c=a.onAdd(this),d=this._controlPositions[b];-1!==b.indexOf("bottom")?d.insertBefore(c,d.firstChild):d.appendChild(c);
return this};k.prototype.removeControl=function(a){a.onRemove(this);return this};k.prototype.addClass=function(a,b){f.warnOnce("Style classes are deprecated and will be removed in an upcoming release of Mapbox GL JS.");if(0<=this._classes.indexOf(a)||""===a)return this;this._classes.push(a);this._classOptions=b;this.style&&this.style.updateClasses();return this._update(!0)};k.prototype.removeClass=function(a,b){f.warnOnce("Style classes are deprecated and will be removed in an upcoming release of Mapbox GL JS.");
var c=this._classes.indexOf(a);if(0>c||""===a)return this;this._classes.splice(c,1);this._classOptions=b;this.style&&this.style.updateClasses();return this._update(!0)};k.prototype.setClasses=function(a,b){f.warnOnce("Style classes are deprecated and will be removed in an upcoming release of Mapbox GL JS.");for(var c={},d=0;d<a.length;d++)""!==a[d]&&(c[a[d]]=!0);this._classes=Object.keys(c);this._classOptions=b;this.style&&this.style.updateClasses();return this._update(!0)};k.prototype.hasClass=function(a){f.warnOnce("Style classes are deprecated and will be removed in an upcoming release of Mapbox GL JS.");
return 0<=this._classes.indexOf(a)};k.prototype.getClasses=function(){f.warnOnce("Style classes are deprecated and will be removed in an upcoming release of Mapbox GL JS.");return this._classes};k.prototype.resize=function(){var a=this._containerDimensions(),b=a[0],a=a[1];this._resizeCanvas(b,a);this.transform.resize(b,a);this.painter.resize(b,a);return this.fire("movestart").fire("move").fire("resize").fire("moveend")};k.prototype.getBounds=function(){var a=new u(this.transform.pointLocation(new A(0,
this.transform.height)),this.transform.pointLocation(new A(this.transform.width,0)));if(this.transform.angle||this.transform.pitch)a.extend(this.transform.pointLocation(new A(this.transform.size.x,0))),a.extend(this.transform.pointLocation(new A(0,this.transform.size.y)));return a};k.prototype.setMaxBounds=function(a){if(a)a=u.convert(a),this.transform.lngRange=[a.getWest(),a.getEast()],this.transform.latRange=[a.getSouth(),a.getNorth()],this.transform._constrain(),this._update();else if(null===a||
void 0===a)this.transform.lngRange=[],this.transform.latRange=[],this._update();return this};k.prototype.setMinZoom=function(a){a=null===a||void 0===a?0:a;if(0<=a&&a<=this.transform.maxZoom)return this.transform.minZoom=a,this._update(),this.getZoom()<a&&this.setZoom(a),this;throw Error("minZoom must be between 0 and the current maxZoom, inclusive");};k.prototype.getMinZoom=function(){return this.transform.minZoom};k.prototype.setMaxZoom=function(a){a=null===a||void 0===a?22:a;if(a>=this.transform.minZoom)return this.transform.maxZoom=
a,this._update(),this.getZoom()>a&&this.setZoom(a),this;throw Error("maxZoom must be greater than the current minZoom");};k.prototype.getMaxZoom=function(){return this.transform.maxZoom};k.prototype.project=function(a){return this.transform.locationPoint(r.convert(a))};k.prototype.unproject=function(a){return this.transform.pointLocation(A.convert(a))};k.prototype.on=function(b,c,d){var e=this;if(void 0===d)return a.prototype.on.call(this,b,c);var g=function(){if("mouseenter"===b||"mouseover"===b){var a=
!1;return{layer:c,listener:d,delegates:{mousemove:function(g){var h=e.queryRenderedFeatures(g.point,{layers:[c]});h.length?a||(a=!0,d.call(e,f.extend({features:h},g,{type:b}))):a=!1},mouseout:function(){a=!1}}}}if("mouseleave"===b||"mouseout"===b){var g=!1;return{layer:c,listener:d,delegates:{mousemove:function(a){e.queryRenderedFeatures(a.point,{layers:[c]}).length?g=!0:g&&(g=!1,d.call(e,f.extend({},a,{type:b})))},mouseout:function(a){g&&(g=!1,d.call(e,f.extend({},a,{type:b})))}}}}return{layer:c,
listener:d,delegates:(h={},h[b]=function(a){var b=e.queryRenderedFeatures(a.point,{layers:[c]});b.length&&d.call(e,f.extend({features:b},a))},h)};var h}();this._delegatedListeners=this._delegatedListeners||{};this._delegatedListeners[b]=this._delegatedListeners[b]||[];this._delegatedListeners[b].push(g);for(var h in g.delegates)e.on(h,g.delegates[h]);return this};k.prototype.off=function(b,c,d){if(void 0===d)return a.prototype.off.call(this,b,c);if(this._delegatedListeners&&this._delegatedListeners[b]){b=
this._delegatedListeners[b];for(var e=0;e<b.length;e++){var f=b[e];if(f.layer===c&&f.listener===d){for(var g in f.delegates)this.off(g,f.delegates[g]);b.splice(e,1);return this}}}};k.prototype.queryRenderedFeatures=function(){var a={},b;if(2===arguments.length)b=arguments[0],a=arguments[1];else{var c;if(c=1===arguments.length)c=arguments[0],c=c instanceof A||Array.isArray(c);c?b=arguments[0]:1===arguments.length&&(a=arguments[0])}return this.style?this.style.queryRenderedFeatures(this._makeQueryGeometry(b),
a,this.transform.zoom,this.transform.angle):[]};k.prototype._makeQueryGeometry=function(a){var b=this;void 0===a&&(a=[A.convert([0,0]),A.convert([this.transform.width,this.transform.height])]);a instanceof A||"number"===typeof a[0]?a=[A.convert(a)]:(a=[A.convert(a[0]),A.convert(a[1])],a=[a[0],new A(a[1].x,a[0].y),a[1],new A(a[0].x,a[1].y),a[0]]);return a=a.map(function(a){return b.transform.pointCoordinate(a)})};k.prototype.querySourceFeatures=function(a,b){return this.style.querySourceFeatures(a,
b)};k.prototype.setStyle=function(a,b){if(!(b&&!1===b.diff||!this.style||!a||a instanceof g)&&"string"!==typeof a)try{return this.style.setState(a)&&this._update(!0),this}catch(D){f.warnOnce("Unable to perform style diff: "+(D.message||D.error||D)+".  Rebuilding the style from scratch.")}this.style&&(this.style.setEventedParent(null),this.style._remove(),this.off("rotate",this.style._redoPlacement),this.off("pitch",this.style._redoPlacement),this.off("move",this.style._redoPlacement));if(a)this.style=
a instanceof g?a:new g(a,this);else return this.style=null,this;this.style.setEventedParent(this,{style:this.style});this.on("rotate",this.style._redoPlacement);this.on("pitch",this.style._redoPlacement);this.on("move",this.style._redoPlacement);return this};k.prototype.getStyle=function(){if(this.style)return this.style.serialize()};k.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():f.warnOnce("There is no style added to the map.")};k.prototype.addSource=function(a,b){this.style.addSource(a,
b);this._update(!0);return this};k.prototype.isSourceLoaded=function(a){var b=this.style&&this.style.sourceCaches[a];if(void 0===b)this.fire("error",{error:Error("There is no source with ID '"+a+"'")});else return b.loaded()};k.prototype.areTilesLoaded=function(){var a=this.style&&this.style.sourceCaches,b;for(b in a){var c=a[b]._tiles,d;for(d in c){var e=c[d];if("loaded"!==e.state&&"errored"!==e.state)return!1}}return!0};k.prototype.addSourceType=function(a,b,c){return this.style.addSourceType(a,
b,c)};k.prototype.removeSource=function(a){this.style.removeSource(a);this._update(!0);return this};k.prototype.getSource=function(a){return this.style.getSource(a)};k.prototype.addImage=function(a,b,c){this.style.spriteAtlas.addImage(a,b,c)};k.prototype.removeImage=function(a){this.style.spriteAtlas.removeImage(a)};k.prototype.loadImage=function(a,b){c.getImage(a,b)};k.prototype.addLayer=function(a,b){this.style.addLayer(a,b);this._update(!0);return this};k.prototype.moveLayer=function(a,b){this.style.moveLayer(a,
b);this._update(!0);return this};k.prototype.removeLayer=function(a){this.style.removeLayer(a);this._update(!0);return this};k.prototype.getLayer=function(a){return this.style.getLayer(a)};k.prototype.setFilter=function(a,b){this.style.setFilter(a,b);this._update(!0);return this};k.prototype.setLayerZoomRange=function(a,b,c){this.style.setLayerZoomRange(a,b,c);this._update(!0);return this};k.prototype.getFilter=function(a){return this.style.getFilter(a)};k.prototype.setPaintProperty=function(a,b,
c,d){this.style.setPaintProperty(a,b,c,d);this._update(!0);return this};k.prototype.getPaintProperty=function(a,b,c){return this.style.getPaintProperty(a,b,c)};k.prototype.setLayoutProperty=function(a,b,c){this.style.setLayoutProperty(a,b,c);this._update(!0);return this};k.prototype.getLayoutProperty=function(a,b){return this.style.getLayoutProperty(a,b)};k.prototype.setLight=function(a){this.style.setLight(a);this._update(!0);return this};k.prototype.getLight=function(){return this.style.getLight()};
k.prototype.getContainer=function(){return this._container};k.prototype.getCanvasContainer=function(){return this._canvasContainer};k.prototype.getCanvas=function(){return this._canvas};k.prototype._containerDimensions=function(){var a=0,b=0;this._container&&(a=this._container.offsetWidth||400,b=this._container.offsetHeight||300);return[a,b]};k.prototype._setupContainer=function(){var a=this._container;a.classList.add("mapboxgl-map");var b=this._canvasContainer=l.create("div","mapboxgl-canvas-container",
a);this._interactive&&b.classList.add("mapboxgl-interactive");this._canvas=l.create("canvas","mapboxgl-canvas",b);this._canvas.style.position="absolute";this._canvas.addEventListener("webglcontextlost",this._contextLost,!1);this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1);this._canvas.setAttribute("tabindex",0);this._canvas.setAttribute("aria-label","Map");b=this._containerDimensions();this._resizeCanvas(b[0],b[1]);var c=this._controlContainer=l.create("div","mapboxgl-control-container",
a),d=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(a){d[a]=l.create("div","mapboxgl-ctrl-"+a,c)})};k.prototype._resizeCanvas=function(a,b){var c=n.devicePixelRatio||1;this._canvas.width=c*a;this._canvas.height=c*b;this._canvas.style.width=a+"px";this._canvas.style.height=b+"px"};k.prototype._setupPainter=function(){var a=f.extend({failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer},v.webGLContextAttributes);
(a=this._canvas.getContext("webgl",a)||this._canvas.getContext("experimental-webgl",a))?this.painter=new e(a,this.transform):this.fire("error",{error:Error("Failed to initialize WebGL")})};k.prototype._contextLost=function(a){a.preventDefault();this._frameId&&(d.cancelFrame(this._frameId),this._frameId=null);this.fire("webglcontextlost",{originalEvent:a})};k.prototype._contextRestored=function(a){this._setupPainter();this.resize();this._update();this.fire("webglcontextrestored",{originalEvent:a})};
k.prototype.loaded=function(){return this._styleDirty||this._sourcesDirty||!this.style||!this.style.loaded()?!1:!0};k.prototype._update=function(a){if(!this.style)return this;this._styleDirty=this._styleDirty||a;this._sourcesDirty=!0;this._rerender();return this};k.prototype._render=function(){this.style&&this._styleDirty&&(this._styleDirty=!1,this.style.update(this._classes,this._classOptions),this._classOptions=null,this.style._recalculate(this.transform.zoom));this.style&&this._sourcesDirty&&(this._sourcesDirty=
!1,this.style._updateSources(this.transform));this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.rotating,zooming:this.zooming});this.fire("render");this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire("load"));this._frameId=null;this.animationLoop.stopped()||(this._styleDirty=!0);(this._sourcesDirty||this._repaint||this._styleDirty)&&this._rerender();return this};k.prototype.remove=function(){this._hash&&
this._hash.remove();d.cancelFrame(this._frameId);this._frameId=null;this.setStyle(null);"undefined"!==typeof n&&(n.removeEventListener("resize",this._onWindowResize,!1),n.removeEventListener("online",this._onWindowOnline,!1));var a=this.painter.gl.getExtension("WEBGL_lose_context");a&&a.loseContext();a=this._canvasContainer;a.parentNode&&a.parentNode.removeChild(a);a=this._controlContainer;a.parentNode&&a.parentNode.removeChild(a);this._container.classList.remove("mapboxgl-map");this.fire("remove")};
k.prototype._rerender=function(){this.style&&!this._frameId&&(this._frameId=d.frame(this._render))};k.prototype._onWindowOnline=function(){this._update()};k.prototype._onWindowResize=function(){this._trackResize&&this.stop().resize()._update()};m.showTileBoundaries.get=function(){return!!this._showTileBoundaries};m.showTileBoundaries.set=function(a){this._showTileBoundaries!==a&&(this._showTileBoundaries=a,this._update())};m.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes};m.showCollisionBoxes.set=
function(a){this._showCollisionBoxes!==a&&(this._showCollisionBoxes=a,this.style._redoPlacement())};m.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector};m.showOverdrawInspector.set=function(a){this._showOverdrawInspector!==a&&(this._showOverdrawInspector=a,this._update())};m.repaint.get=function(){return!!this._repaint};m.repaint.set=function(a){this._repaint=a;this._update()};m.vertices.get=function(){return!!this._vertices};m.vertices.set=function(a){this._vertices=a;this._update()};
k.prototype._onData=function(a){this._update("style"===a.dataType);this.fire(a.dataType+"data",a)};k.prototype._onDataLoading=function(a){this.fire(a.dataType+"dataloading",a)};Object.defineProperties(k.prototype,m);return k}(m);k.exports=a},{"../geo/lng_lat":62,"../geo/lng_lat_bounds":63,"../geo/transform":64,"../render/painter":78,"../style/animation_loop":147,"../style/style":150,"../util/ajax":195,"../util/browser":196,"../util/dom":203,"../util/util":217,"../util/window":198,"./bind_handlers":175,
"./camera":176,"./control/attribution_control":177,"./control/logo_control":180,"./hash":190,"mapbox-gl-supported":23,"point-geometry":26}],192:[function(a,k,m){var f=a("../util/dom"),d=a("../geo/lng_lat"),n=a("point-geometry"),l=a("../util/smart_wrap");a=function(a,d){this._offset=n.convert(d&&d.offset||[0,0]);this._update=this._update.bind(this);this._onMapClick=this._onMapClick.bind(this);a||(a=f.create("div"));a.classList.add("mapboxgl-marker");this._element=a;this._popup=null};a.prototype.addTo=
function(a){this.remove();this._map=a;a.getCanvasContainer().appendChild(this._element);a.on("move",this._update);a.on("moveend",this._update);this._update();this._map.on("click",this._onMapClick);return this};a.prototype.remove=function(){this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map=null);f.remove(this._element);this._popup&&this._popup.remove();return this};a.prototype.getLngLat=function(){return this._lngLat};
a.prototype.setLngLat=function(a){this._lngLat=d.convert(a);this._pos=null;this._popup&&this._popup.setLngLat(this._lngLat);this._update();return this};a.prototype.getElement=function(){return this._element};a.prototype.setPopup=function(a){this._popup&&(this._popup.remove(),this._popup=null);a&&(this._popup=a,this._popup.setLngLat(this._lngLat));return this};a.prototype._onMapClick=function(a){a=a.originalEvent.target;var c=this._element;this._popup&&(a===c||c.contains(a))&&this.togglePopup()};a.prototype.getPopup=
function(){return this._popup};a.prototype.togglePopup=function(){var a=this._popup;a&&(a.isOpen()?a.remove():a.addTo(this._map))};a.prototype._update=function(a){this._map&&(this._map.transform.renderWorldCopies&&(this._lngLat=l(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset),a&&"moveend"!==a.type||(this._pos=this._pos.round()),f.setTransform(this._element,"translate("+this._pos.x+"px, "+this._pos.y+"px)"))};k.exports=a},{"../geo/lng_lat":62,
"../util/dom":203,"../util/smart_wrap":213,"point-geometry":26}],193:[function(a,k,m){function f(a){if(a){if("number"===typeof a){var b=Math.round(Math.sqrt(.5*Math.pow(a,2)));return{top:new c(0,a),"top-left":new c(b,b),"top-right":new c(-b,b),bottom:new c(0,-a),"bottom-left":new c(b,-b),"bottom-right":new c(-b,-b),left:new c(a,0),right:new c(-a,0)}}return a instanceof c||Array.isArray(a)?(a=c.convert(a),{top:a,"top-left":a,"top-right":a,bottom:a,"bottom-left":a,"bottom-right":a,left:a,right:a}):
{top:c.convert(a.top||[0,0]),"top-left":c.convert(a["top-left"]||[0,0]),"top-right":c.convert(a["top-right"]||[0,0]),bottom:c.convert(a.bottom||[0,0]),"bottom-left":c.convert(a["bottom-left"]||[0,0]),"bottom-right":c.convert(a["bottom-right"]||[0,0]),left:c.convert(a.left||[0,0]),right:c.convert(a.right||[0,0])}}return f(new c(0,0))}var d=a("../util/util");m=a("../util/evented");var n=a("../util/dom"),l=a("../geo/lng_lat"),c=a("point-geometry"),g=a("../util/window"),h=a("../util/smart_wrap"),e={closeButton:!0,
closeOnClick:!0};a=function(a){function b(b){a.call(this);this.options=d.extend(Object.create(e),b);d.bindAll(["_update","_onClickClose"],this)}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);b.prototype.constructor=b;b.prototype.addTo=function(a){this._map=a;this._map.on("move",this._update);if(this.options.closeOnClick)this._map.on("click",this._onClickClose);this._update();return this};b.prototype.isOpen=function(){return!!this._map};b.prototype.remove=function(){this._content&&this._content.parentNode&&
this._content.parentNode.removeChild(this._content);this._container&&(this._container.parentNode.removeChild(this._container),delete this._container);this._map&&(this._map.off("move",this._update),this._map.off("click",this._onClickClose),delete this._map);this.fire("close");return this};b.prototype.getLngLat=function(){return this._lngLat};b.prototype.setLngLat=function(a){this._lngLat=l.convert(a);this._pos=null;this._update();return this};b.prototype.setText=function(a){return this.setDOMContent(g.document.createTextNode(a))};
b.prototype.setHTML=function(a){var b=g.document.createDocumentFragment(),c=g.document.createElement("body");for(c.innerHTML=a;;){a=c.firstChild;if(!a)break;b.appendChild(a)}return this.setDOMContent(b)};b.prototype.setDOMContent=function(a){this._createContent();this._content.appendChild(a);this._update();return this};b.prototype._createContent=function(){this._content&&this._content.parentNode&&this._content.parentNode.removeChild(this._content);this._content=n.create("div","mapboxgl-popup-content",
this._container);this.options.closeButton&&(this._closeButton=n.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))};b.prototype._update=function(){if(this._map&&this._lngLat&&this._content){this._container||(this._container=n.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=n.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content));
this._map.transform.renderWorldCopies&&(this._lngLat=h(this._lngLat,this._pos,this._map.transform));this._pos=this._map.project(this._lngLat);var a=this.options.anchor,b=f(this.options.offset);if(!a){var c=this._container.offsetWidth,a=this._container.offsetHeight,a=this._pos.y+b.bottom.y<a?["top"]:this._pos.y>this._map.transform.height-a?["bottom"]:[];this._pos.x<c/2?a.push("left"):this._pos.x>this._map.transform.width-c/2&&a.push("right");a=0===a.length?"bottom":a.join("-")}var b=this._pos.add(b[a]).round(),
c={top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},d=this._container.classList,e;for(e in c)d.remove("mapboxgl-popup-anchor-"+e);d.add("mapboxgl-popup-anchor-"+a);n.setTransform(this._container,c[a]+" translate("+b.x+"px,"+b.y+"px)")}};b.prototype._onClickClose=function(){this.remove()};return b}(m);k.exports=
a},{"../geo/lng_lat":62,"../util/dom":203,"../util/evented":204,"../util/smart_wrap":213,"../util/util":217,"../util/window":198,"point-geometry":26}],194:[function(a,k,m){a=function(a,d,k){this.target=a;this.parent=d;this.mapId=k;this.callbacks={};this.callbackID=0;this.receive=this.receive.bind(this);this.target.addEventListener("message",this.receive,!1)};a.prototype.send=function(a,d,k,l,c){var f=k?this.mapId+":"+this.callbackID++:null;k&&(this.callbacks[f]=k);this.target.postMessage({targetMapId:c,
sourceMapId:this.mapId,type:a,id:String(f),data:d},l)};a.prototype.receive=function(a){var d=this;a=a.data;var f=a.id,k;if(!a.targetMapId||this.mapId===a.targetMapId)if(k=function(a,c,e){d.target.postMessage({sourceMapId:d.mapId,type:"<response>",id:String(f),error:a?String(a):null,data:c},e)},"<response>"===a.type)k=this.callbacks[a.id],delete this.callbacks[a.id],k&&k(a.error||null,a.data);else if("undefined"!==typeof a.id&&this.parent[a.type])this.parent[a.type](a.sourceMapId,a.data,k);else if("undefined"!==
typeof a.id&&this.parent.getWorkerSource){var c=a.type.split(".");this.parent.getWorkerSource(a.sourceMapId,c[0])[c[1]](a.data,k)}else this.parent[a.type](a.data)};a.prototype.remove=function(){this.target.removeEventListener("message",this.receive,!1)};k.exports=a},{}],195:[function(a,k,m){function f(a){var c=d.document.createElement("a");c.href=a;return c.protocol===d.document.location.protocol&&c.host===d.document.location.host}var d=a("./window"),n=function(a){function c(c,d){a.call(this,c);this.status=
d}a&&(c.__proto__=a);c.prototype=Object.create(a&&a.prototype);return c.prototype.constructor=c}(Error);m.getJSON=function(a,c){var f=new d.XMLHttpRequest;f.open("GET",a,!0);f.setRequestHeader("Accept","application/json");f.onerror=function(a){c(a)};f.onload=function(){if(200<=f.status&&300>f.status&&f.response){var a;try{a=JSON.parse(f.response)}catch(e){return c(e)}c(null,a)}else c(new n(f.statusText,f.status))};f.send();return f};m.getArrayBuffer=function(a,c){var f=new d.XMLHttpRequest;f.open("GET",
a,!0);f.responseType="arraybuffer";f.onerror=function(a){c(a)};f.onload=function(){if(0===f.response.byteLength&&200===f.status)return c(Error("http status 200 returned without content."));200<=f.status&&300>f.status&&f.response?c(null,{data:f.response,cacheControl:f.getResponseHeader("Cache-Control"),expires:f.getResponseHeader("Expires")}):c(new n(f.statusText,f.status))};f.send();return f};m.getImage=function(a,c){return m.getArrayBuffer(a,function(a,f){if(a)return c(a);var e=new d.Image,b=d.URL||
d.webkitURL;e.onload=function(){c(null,e);b.revokeObjectURL(e.src)};var g=new d.Blob([new Uint8Array(f.data)],{type:"image/png"});e.cacheControl=f.cacheControl;e.expires=f.expires;e.src=f.data.byteLength?b.createObjectURL(g):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="})};m.getVideo=function(a,c){var g=d.document.createElement("video");g.onloadstart=function(){c(null,g)};for(var h=0;h<a.length;h++){var e=d.document.createElement("source");
f(a[h])||(g.crossOrigin="Anonymous");e.src=a[h];g.appendChild(e)}return g}},{"./window":198}],196:[function(a,k,m){var f=a("./window"),d=k.exports,n;n=f.performance&&f.performance.now?f.performance.now.bind(f.performance):Date.now.bind(Date);d.now=n;var l=f.requestAnimationFrame||f.mozRequestAnimationFrame||f.webkitRequestAnimationFrame||f.msRequestAnimationFrame;m.frame=function(a){return l(a)};var c=f.cancelAnimationFrame||f.mozCancelAnimationFrame||f.webkitCancelAnimationFrame||f.msCancelAnimationFrame;
m.cancelFrame=function(a){c(a)};m.timed=function(a,c,d){function b(g){e||(g=k.exports.now(),g>=f+c?a.call(d,1):(a.call(d,(g-f)/c),m.frame(b)))}if(!c)return a.call(d,1),null;var e=!1,f=k.exports.now();m.frame(b);return function(){e=!0}};m.getImageData=function(a){var c=f.document.createElement("canvas"),d=c.getContext("2d");c.width=a.width;c.height=a.height;d.drawImage(a,0,0,a.width,a.height);return d.getImageData(0,0,a.width,a.height).data};m.supported=a("mapbox-gl-supported");m.hardwareConcurrency=
f.navigator.hardwareConcurrency||4;Object.defineProperty(m,"devicePixelRatio",{get:function(){return f.devicePixelRatio}});m.supportsWebp=!1;a=f.document.createElement("img");a.onload=function(){m.supportsWebp=!0};a.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="},{"./window":198,"mapbox-gl-supported":23}],197:[function(a,k,m){m=a("webworkify");var f=a("../window"),d=f.URL.createObjectURL(new m(a("../../source/worker"),{bare:!0}));k.exports=function(){return new f.Worker(d)}},
{"../../source/worker":101,"../window":198,webworkify:41}],198:[function(a,k,m){k.exports=self},{}],199:[function(a,k,m){function f(a,c){return c.area-a.area}var d=a("quickselect"),n=a("./util").calculateSignedArea;k.exports=function(a,c){var g=a.length;if(1>=g)return[a];for(var h=[],e,b,k=0;k<g;k++){var l=n(a[k]);0!==l&&(a[k].area=Math.abs(l),void 0===b&&(b=0>l),b===0>l?(e&&h.push(e),e=[a[k]]):e.push(a[k]))}e&&h.push(e);if(1<c)for(g=0;g<h.length;g++)h[g].length<=c||(d(h[g],c,1,h[g].length-1,f),h[g]=
h[g].slice(0,c));return h}},{"./util":217,quickselect:28}],200:[function(a,k,m){k.exports={API_URL:"https://api.mapbox.com",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null}},{}],201:[function(a,k,m){var f=a("assert");a=function(a){this._stringToNumber={};this._numberToString=[];for(var d=0;d<a.length;d++){var f=a[d];this._stringToNumber[f]=d;this._numberToString[d]=f}};a.prototype.encode=function(a){f(a in this._stringToNumber);return this._stringToNumber[a]};a.prototype.decode=function(a){f(a<this._numberToString.length);
return this._numberToString[a]};k.exports=a},{assert:5}],202:[function(a,k,m){var f=a("./util"),d=a("./actor");a=function(a,k){this.workerPool=a;this.actors=[];this.currentActor=0;this.id=f.uniqueId();for(var c=this.workerPool.acquire(this.id),g=0;g<c.length;g++){var h=new d(c[g],k,this.id);h.name="Worker "+g;this.actors.push(h)}};a.prototype.broadcast=function(a,d,c){f.asyncAll(this.actors,function(c,f){c.send(a,d,f)},c||function(){})};a.prototype.send=function(a,d,c,f,h){if("number"!==typeof f||
isNaN(f))f=this.currentActor=(this.currentActor+1)%this.actors.length;this.actors[f].send(a,d,c,h);return f};a.prototype.remove=function(){this.actors.forEach(function(a){a.remove()});this.actors=[];this.workerPool.release(this.id)};k.exports=a},{"./actor":194,"./util":217}],203:[function(a,k,m){function f(a){for(var b=0;b<a.length;b++)if(a[b]in c)return a[b];return a[0]}function d(a){a.preventDefault();a.stopPropagation();l.removeEventListener("click",d,!0)}var n=a("point-geometry"),l=a("./window");
m.create=function(a,c,d){a=l.document.createElement(a);c&&(a.className=c);d&&d.appendChild(a);return a};var c=l.document.documentElement.style,g=f(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),h;m.disableDrag=function(){g&&(h=c[g],c[g]="none")};m.enableDrag=function(){g&&(c[g]=h)};var e=f(["transform","WebkitTransform"]);m.setTransform=function(a,c){a.style[e]=c};m.suppressClick=function(){l.addEventListener("click",d,!0);l.setTimeout(function(){l.removeEventListener("click",d,
!0)},0)};m.mousePos=function(a,c){var b=a.getBoundingClientRect();c=c.touches?c.touches[0]:c;return new n(c.clientX-b.left-a.clientLeft,c.clientY-b.top-a.clientTop)};m.touchPos=function(a,c){for(var b=a.getBoundingClientRect(),d=[],e="touchend"===c.type?c.changedTouches:c.touches,f=0;f<e.length;f++)d.push(new n(e[f].clientX-b.left-a.clientLeft,e[f].clientY-b.top-a.clientTop));return d};m.remove=function(a){a.parentNode&&a.parentNode.removeChild(a)}},{"./window":198,"point-geometry":26}],204:[function(a,
k,m){function f(a,d,c){c&&c[a]&&(d=c[a].indexOf(d),-1!==d&&c[a].splice(d,1))}var d=a("./util");a=function(){};a.prototype.on=function(a,d){var c=this._listeners=this._listeners||{};c[a]=c[a]||[];c[a].push(d);return this};a.prototype.off=function(a,d){f(a,d,this._listeners);f(a,d,this._oneTimeListeners);return this};a.prototype.once=function(a,d){var c=this._oneTimeListeners=this._oneTimeListeners||{};c[a]=c[a]||[];c[a].push(d);return this};a.prototype.fire=function(a,k){if(this.listens(a)){k=d.extend({},
k,{type:a,target:this});for(var c=this._listeners&&this._listeners[a]?this._listeners[a].slice():[],g=0;g<c.length;g++)c[g].call(this,k);c=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[];for(g=0;g<c.length;g++)c[g].call(this,k),f(a,c[g],this._oneTimeListeners);this._eventedParent&&this._eventedParent.fire(a,d.extend({},k,"function"===typeof this._eventedParentData?this._eventedParentData():this._eventedParentData))}else d.endsWith(a,"error")&&console.error(k&&
k.error||k||"Empty error event");return this};a.prototype.listens=function(a){return this._listeners&&this._listeners[a]&&0<this._listeners[a].length||this._oneTimeListeners&&this._oneTimeListeners[a]&&0<this._oneTimeListeners[a].length||this._eventedParent&&this._eventedParent.listens(a)};a.prototype.setEventedParent=function(a,d){this._eventedParent=a;this._eventedParentData=d;return this};k.exports=a},{"./util":217}],205:[function(a,k,m){function f(a,c){return c.max-a.max}function d(a,d,e,b){this.p=
new l(a,d);this.h=e;a=this.p;d=!1;e=Infinity;for(var f=0;f<b.length;f++)for(var g=b[f],h=0,k=g.length,m=k-1;h<k;m=h++){var n=g[h],m=g[m];n.y>a.y!==m.y>a.y&&a.x<(m.x-n.x)*(a.y-n.y)/(m.y-n.y)+n.x&&(d=!d);e=Math.min(e,c(a,n,m))}this.d=(d?1:-1)*Math.sqrt(e);this.max=this.d+this.h*Math.SQRT2}var n=a("tinyqueue"),l=a("point-geometry"),c=a("./intersection_tests").distToSegmentSquared;k.exports=function(a,c,e){c=c||1;for(var b,g,h,k,l=a[0],m=0;m<l.length;m++){var y=l[m];if(!m||y.x<b)b=y.x;if(!m||y.y<g)g=
y.y;if(!m||y.x>h)h=y.x;if(!m||y.y>k)k=y.y}y=Math.min(h-b,k-g);m=y/2;l=new n(null,f);if(0===y)return[b,g];for(;b<h;b+=y)for(var t=g;t<k;t+=y)l.push(new d(b+m,t+m,m,a));k=h=g=0;m=a[0];b=0;for(var y=m.length,v=y-1;b<y;v=b++){var t=m[b],v=m[v],B=t.x*v.y-v.x*t.y;h+=(t.x+v.x)*B;k+=(t.y+v.y)*B;g+=3*B}g=new d(h/g,k/g,0,a);for(h=l.length;l.length;){k=l.pop();if(k.d>g.d||!g.d)g=k,e&&console.log("found best %d after %d probes",Math.round(1E4*k.d)/1E4,h);k.max-g.d<=c||(m=k.h/2,l.push(new d(k.p.x-m,k.p.y-m,m,
a)),l.push(new d(k.p.x+m,k.p.y-m,m,a)),l.push(new d(k.p.x-m,k.p.y+m,m,a)),l.push(new d(k.p.x+m,k.p.y+m,m,a)),h+=4)}e&&(console.log("num probes: "+h),console.log("best distance: "+g.d));return g.p}},{"./intersection_tests":208,"point-geometry":26,tinyqueue:30}],206:[function(a,k,m){var f=a("./worker_pool"),d;k.exports=function(){d||(d=new f);return d}},{"./worker_pool":220}],207:[function(a,k,m){function f(a,c,f){1===a&&(a=f.readMessage(d,{glyphs:{}}),c.push(a))}function d(a,c,d){1===a?c.name=d.readString():
2===a?c.range=d.readString():3===a&&(a=d.readMessage(n,{}),c.glyphs[a.id]=a)}function n(a,c,d){1===a?c.id=d.readVarint():2===a?c.bitmap=d.readBytes():3===a?c.width=d.readVarint():4===a?c.height=d.readVarint():5===a?c.left=d.readSVarint():6===a?c.top=d.readSVarint():7===a&&(c.advance=d.readVarint())}k.exports=function(a,c){this.stacks=a.readFields(f,[],c)}},{}],208:[function(a,k,m){function f(a,c){if(0===a.length||0===c.length)return!1;for(var b=0;b<a.length-1;b++)for(var d=a[b],e=a[b+1],f=0;f<c.length-
1;f++){var h=d,k=e,l=c[f],m=c[f+1];if(g(h,l,m)!==g(k,l,m)&&g(h,k,l)!==g(h,k,m))return!0}return!1}function d(a,c,b){b*=b;if(1===c.length)return a.distSqr(c[0])<b;for(var d=1;d<c.length;d++)if(n(a,c[d-1],c[d])<b)return!0;return!1}function n(a,c,b){var d=c.distSqr(b);if(0===d)return a.distSqr(c);d=((a.x-c.x)*(b.x-c.x)+(a.y-c.y)*(b.y-c.y))/d;return 0>d?a.distSqr(c):1<d?a.distSqr(b):a.distSqr(b.sub(c)._mult(d)._add(c))}function l(a,c){for(var b=!1,d,e,f,g=0;g<a.length;g++){d=a[g];var h=0;for(f=d.length-
1;h<d.length;f=h++)e=d[h],f=d[f],e.y>c.y!==f.y>c.y&&c.x<(f.x-e.x)*(c.y-e.y)/(f.y-e.y)+e.x&&(b=!b)}return b}function c(a,c){for(var b=!1,d=0,e=a.length-1;d<a.length;e=d++){var f=a[d],e=a[e];f.y>c.y!==e.y>c.y&&c.x<(e.x-f.x)*(c.y-f.y)/(e.y-f.y)+f.x&&(b=!b)}return b}var g=a("./util").isCounterClockwise;k.exports={multiPolygonIntersectsBufferedMultiPoint:function(a,e,b){for(var f=0;f<a.length;f++)for(var g=a[f],h=0;h<e.length;h++)for(var k=e[h],l=0;l<k.length;l++){var m=k[l];if(c(g,m)||d(m,g,b))return!0}return!1},
multiPolygonIntersectsMultiPolygon:function(a,c){if(1===a.length&&1===a[0].length)return l(c,a[0][0]);for(var b=0;b<c.length;b++)for(var d=c[b],e=0;e<d.length;e++)if(l(a,d[e]))return!0;for(b=0;b<a.length;b++){d=a[b];for(e=0;e<d.length;e++)if(l(c,d[e]))return!0;for(e=0;e<c.length;e++)if(f(d,c[e]))return!0}return!1},multiPolygonIntersectsBufferedMultiLine:function(a,e,b){for(var g=0;g<e.length;g++)for(var h=e[g],k=0;k<a.length;k++){var l=a[k];if(3<=l.length)for(var m=0;m<h.length;m++)if(c(l,h[m]))return!0;
a:{var m=h,n=b;if(1<l.length){if(f(l,m)){l=!0;break a}for(var t=0;t<m.length;t++)if(d(m[t],l,n)){l=!0;break a}}for(t=0;t<l.length;t++)if(d(l[t],m,n)){l=!0;break a}l=!1}if(l)return!0}return!1},polygonIntersectsPolygon:function(a,d){for(var b=0;b<a.length;b++)if(c(d,a[b]))return!0;for(b=0;b<d.length;b++)if(c(a,d[b]))return!0;return f(a,d)?!0:!1},distToSegmentSquared:n}},{"./util":217}],209:[function(a,k,m){k.exports={"Latin-1 Supplement":function(a){return 128<=a&&255>=a},Arabic:function(a){return 1536<=
a&&1791>=a},"Arabic Supplement":function(a){return 1872<=a&&1919>=a},"Arabic Extended-A":function(a){return 2208<=a&&2303>=a},"Hangul Jamo":function(a){return 4352<=a&&4607>=a},"Unified Canadian Aboriginal Syllabics":function(a){return 5120<=a&&5759>=a},"Unified Canadian Aboriginal Syllabics Extended":function(a){return 6320<=a&&6399>=a},"General Punctuation":function(a){return 8192<=a&&8303>=a},"Letterlike Symbols":function(a){return 8448<=a&&8527>=a},"Number Forms":function(a){return 8528<=a&&8591>=
a},"Miscellaneous Technical":function(a){return 8960<=a&&9215>=a},"Control Pictures":function(a){return 9216<=a&&9279>=a},"Optical Character Recognition":function(a){return 9280<=a&&9311>=a},"Enclosed Alphanumerics":function(a){return 9312<=a&&9471>=a},"Geometric Shapes":function(a){return 9632<=a&&9727>=a},"Miscellaneous Symbols":function(a){return 9728<=a&&9983>=a},"Miscellaneous Symbols and Arrows":function(a){return 11008<=a&&11263>=a},"CJK Radicals Supplement":function(a){return 11904<=a&&12031>=
a},"Kangxi Radicals":function(a){return 12032<=a&&12255>=a},"Ideographic Description Characters":function(a){return 12272<=a&&12287>=a},"CJK Symbols and Punctuation":function(a){return 12288<=a&&12351>=a},Hiragana:function(a){return 12352<=a&&12447>=a},Katakana:function(a){return 12448<=a&&12543>=a},Bopomofo:function(a){return 12544<=a&&12591>=a},"Hangul Compatibility Jamo":function(a){return 12592<=a&&12687>=a},Kanbun:function(a){return 12688<=a&&12703>=a},"Bopomofo Extended":function(a){return 12704<=
a&&12735>=a},"CJK Strokes":function(a){return 12736<=a&&12783>=a},"Katakana Phonetic Extensions":function(a){return 12784<=a&&12799>=a},"Enclosed CJK Letters and Months":function(a){return 12800<=a&&13055>=a},"CJK Compatibility":function(a){return 13056<=a&&13311>=a},"CJK Unified Ideographs Extension A":function(a){return 13312<=a&&19903>=a},"Yijing Hexagram Symbols":function(a){return 19904<=a&&19967>=a},"CJK Unified Ideographs":function(a){return 19968<=a&&40959>=a},"Yi Syllables":function(a){return 40960<=
a&&42127>=a},"Yi Radicals":function(a){return 42128<=a&&42191>=a},"Hangul Jamo Extended-A":function(a){return 43360<=a&&43391>=a},"Hangul Syllables":function(a){return 44032<=a&&55215>=a},"Hangul Jamo Extended-B":function(a){return 55216<=a&&55295>=a},"Private Use Area":function(a){return 57344<=a&&63743>=a},"CJK Compatibility Ideographs":function(a){return 63744<=a&&64255>=a},"Arabic Presentation Forms-A":function(a){return 64336<=a&&65023>=a},"Vertical Forms":function(a){return 65040<=a&&65055>=
a},"CJK Compatibility Forms":function(a){return 65072<=a&&65103>=a},"Small Form Variants":function(a){return 65104<=a&&65135>=a},"Arabic Presentation Forms-B":function(a){return 65136<=a&&65279>=a},"Halfwidth and Fullwidth Forms":function(a){return 65280<=a&&65519>=a}}},{}],210:[function(a,k,m){a=function(a,d){this.max=a;this.onRemove=d;this.reset()};a.prototype.reset=function(){for(var a in this.data)this.onRemove(this.data[a]);this.data={};this.order=[];return this};a.prototype.add=function(a,d){if(this.has(a))this.order.splice(this.order.indexOf(a),
1),this.data[a]=d,this.order.push(a);else if(this.data[a]=d,this.order.push(a),this.order.length>this.max){var f=this.get(this.order[0]);if(f)this.onRemove(f)}return this};a.prototype.has=function(a){return a in this.data};a.prototype.keys=function(){return this.order};a.prototype.get=function(a){if(!this.has(a))return null;var d=this.data[a];delete this.data[a];this.order.splice(this.order.indexOf(a),1);return d};a.prototype.getWithoutRemoving=function(a){return this.has(a)?this.data[a]:null};a.prototype.remove=
function(a){if(!this.has(a))return this;var d=this.data[a];delete this.data[a];this.onRemove(d);this.order.splice(this.order.indexOf(a),1);return this};a.prototype.setMaxSize=function(a){for(this.max=a;this.order.length>this.max;)if(a=this.get(this.order[0]))this.onRemove(a);return this};k.exports=a},{}],211:[function(a,k,m){function f(a,d){var b=n(c.API_URL);a.protocol=b.protocol;a.authority=b.authority;if(!c.REQUIRE_ACCESS_TOKEN)return l(a);d=d||c.ACCESS_TOKEN;if(!d)throw Error("An API access token is required to use Mapbox GL. See https://www.mapbox.com/api-documentation/#access-tokens");
if("s"===d[0])throw Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). See https://www.mapbox.com/api-documentation/#access-tokens");a.params.push("access_token="+d);return l(a)}function d(a){return 0===a.indexOf("mapbox:")}function n(a){a=a.match(e);if(!a)throw Error("Unable to parse URL object");return{protocol:a[1],authority:a[2],path:a[3]||"/",params:a[4]?a[4].split("&"):[]}}function l(a){var b=a.params.length?"?"+a.params.join("&"):"";return a.protocol+
"://"+a.authority+a.path+b}var c=a("./config"),g=a("./browser");m.isMapboxURL=d;m.normalizeStyleURL=function(a,c){if(!d(a))return a;var b=n(a);b.path="/styles/v1"+b.path;return f(b,c)};m.normalizeGlyphsURL=function(a,c){if(!d(a))return a;var b=n(a);b.path="/fonts/v1"+b.path;return f(b,c)};m.normalizeSourceURL=function(a,c){if(!d(a))return a;var b=n(a);b.path="/v4/"+b.authority+".json";b.params.push("secure");return f(b,c)};m.normalizeSpriteURL=function(a,c,e,g){var b=n(a);if(!d(a))return b.path+=
""+c+e,l(b);b.path="/styles/v1"+b.path+"/sprite"+c+e;return f(b,g)};var h=/(\.(png|jpg)\d*)(?=$)/;m.normalizeTileURL=function(a,e,f){if(!e||!d(e))return a;a=n(a);a.path=a.path.replace(h,""+(2<=g.devicePixelRatio||512===f?"@2x":"")+(g.supportsWebp?".webp":"$1"));f=a.params;for(e=0;e<f.length;e++)0===f[e].indexOf("access_token=tk.")&&(f[e]="access_token="+(c.ACCESS_TOKEN||""));return l(a)};var e=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/},{"./browser":196,"./config":200}],212:[function(a,k,m){var f=a("./is_char_in_unicode_block");
k.exports.allowsIdeographicBreaking=function(a){for(var d=0;d<a.length;d+=1)if(!m.charAllowsIdeographicBreaking(a[d].charCodeAt(0)))return!1;return!0};k.exports.allowsVerticalWritingMode=function(a){for(var d=0;d<a.length;d+=1)if(m.charHasUprightVerticalOrientation(a[d].charCodeAt(0)))return!0;return!1};k.exports.allowsLetterSpacing=function(a){for(var d=0;d<a.length;d+=1)if(!m.charAllowsLetterSpacing(a[d].charCodeAt(0)))return!1;return!0};k.exports.charAllowsLetterSpacing=function(a){return f.Arabic(a)||
f["Arabic Supplement"](a)||f["Arabic Extended-A"](a)||f["Arabic Presentation Forms-A"](a)||f["Arabic Presentation Forms-B"](a)?!1:!0};k.exports.charAllowsIdeographicBreaking=function(a){return 11904>a?!1:f["Bopomofo Extended"](a)||f.Bopomofo(a)||f["CJK Compatibility Forms"](a)||f["CJK Compatibility Ideographs"](a)||f["CJK Compatibility"](a)||f["CJK Radicals Supplement"](a)||f["CJK Strokes"](a)||f["CJK Symbols and Punctuation"](a)||f["CJK Unified Ideographs Extension A"](a)||f["CJK Unified Ideographs"](a)||
f["Enclosed CJK Letters and Months"](a)||f["Halfwidth and Fullwidth Forms"](a)||f.Hiragana(a)||f["Ideographic Description Characters"](a)||f["Kangxi Radicals"](a)||f["Katakana Phonetic Extensions"](a)||f.Katakana(a)||f["Vertical Forms"](a)||f["Yi Radicals"](a)||f["Yi Syllables"](a)?!0:!1};m.charHasUprightVerticalOrientation=function(a){return 746===a||747===a?!0:4352>a?!1:f["Bopomofo Extended"](a)||f.Bopomofo(a)||f["CJK Compatibility Forms"](a)&&!(65097<=a&&65103>=a)||f["CJK Compatibility Ideographs"](a)||
f["CJK Compatibility"](a)||f["CJK Radicals Supplement"](a)||f["CJK Strokes"](a)||f["CJK Symbols and Punctuation"](a)&&!(12296<=a&&12305>=a||12308<=a&&12319>=a)&&12336!==a||f["CJK Unified Ideographs Extension A"](a)||f["CJK Unified Ideographs"](a)||f["Enclosed CJK Letters and Months"](a)||f["Hangul Compatibility Jamo"](a)||f["Hangul Jamo Extended-A"](a)||f["Hangul Jamo Extended-B"](a)||f["Hangul Jamo"](a)||f["Hangul Syllables"](a)||f.Hiragana(a)||f["Ideographic Description Characters"](a)||f.Kanbun(a)||
f["Kangxi Radicals"](a)||f["Katakana Phonetic Extensions"](a)||f.Katakana(a)&&12540!==a||f["Halfwidth and Fullwidth Forms"](a)&&!(65288===a||65289===a||65293===a||65306<=a&&65310>=a||65339===a||65341===a||65343===a||65371<=a&&65503>=a||65507===a||65512<=a&&65519>=a)||f["Small Form Variants"](a)&&!(65112<=a&&65118>=a||65123<=a&&65126>=a)||f["Unified Canadian Aboriginal Syllabics"](a)||f["Unified Canadian Aboriginal Syllabics Extended"](a)||f["Vertical Forms"](a)||f["Yijing Hexagram Symbols"](a)||f["Yi Syllables"](a)||
f["Yi Radicals"](a)?!0:!1};m.charHasNeutralVerticalOrientation=function(a){return f["Latin-1 Supplement"](a)&&(167===a||169===a||174===a||177===a||188===a||189===a||190===a||215===a||247===a)||f["General Punctuation"](a)&&(8214===a||8224===a||8225===a||8240===a||8241===a||8251===a||8252===a||8258===a||8263===a||8264===a||8265===a||8273===a)||f["Letterlike Symbols"](a)||f["Number Forms"](a)||f["Miscellaneous Technical"](a)&&(8960<=a&&8967>=a||8972<=a&&8991>=a||8996<=a&&9E3>=a||9003===a||9085<=a&&9114>=
a||9150<=a&&9165>=a||9167===a||9169<=a&&9179>=a||9186<=a&&9215>=a)||f["Control Pictures"](a)&&9251!==a||f["Optical Character Recognition"](a)||f["Enclosed Alphanumerics"](a)||f["Geometric Shapes"](a)||f["Miscellaneous Symbols"](a)&&!(9754<=a&&9759>=a)||f["Miscellaneous Symbols and Arrows"](a)&&(11026<=a&&11055>=a||11088<=a&&11097>=a||11192<=a&&11243>=a)||f["CJK Symbols and Punctuation"](a)||f.Katakana(a)||f["Private Use Area"](a)||f["CJK Compatibility Forms"](a)||f["Small Form Variants"](a)||f["Halfwidth and Fullwidth Forms"](a)||
8734===a||8756===a||8757===a||9984<=a&&10087>=a||10102<=a&&10131>=a||65532===a||65533===a?!0:!1};m.charHasRotatedVerticalOrientation=function(a){return!(m.charHasUprightVerticalOrientation(a)||m.charHasNeutralVerticalOrientation(a))}},{"./is_char_in_unicode_block":209}],213:[function(a,k,m){var f=a("../geo/lng_lat");k.exports=function(a,k,l){a=new f(a.lng,a.lat);if(k){var c=new f(a.lng-360,a.lat),d=new f(a.lng+360,a.lat),h=l.locationPoint(a).distSqr(k);l.locationPoint(c).distSqr(k)<h?a=c:l.locationPoint(d).distSqr(k)<
h&&(a=d)}for(;180<Math.abs(a.lng-l.center.lng);){k=l.locationPoint(a);if(0<=k.x&&0<=k.y&&k.x<=l.width&&k.y<=l.height)break;a.lng=a.lng>l.center.lng?a.lng-360:a.lng+360}return a}},{"../geo/lng_lat":62}],214:[function(a,k,m){function f(a,c){return Math.ceil(a/c)*c}function d(a,d){for(var b=[],e=[],f="var i = this.length;\nthis.resize(this.length + 1);\n",g=0;g<a.length;g+=1){var h=a[g],k=c[h.type].BYTES_PER_ELEMENT;0>b.indexOf(k)&&(b.push(k),f+="var o"+k.toFixed(0)+" = i * "+(d/k).toFixed(0)+";\n");
for(var l=0;l<h.components;l++){var m="v"+e.length,n="o"+k.toFixed(0)+" + "+(h.offset/k+l).toFixed(0),f=f+("this."+h.type.toLowerCase()+"["+n+"] = "+m+";\n");e.push(m)}}return new Function(e.toString(),f+"return i;")}function n(a,d){var b="this._pos"+c[a.type].BYTES_PER_ELEMENT.toFixed(0),e=(a.offset/c[a.type].BYTES_PER_ELEMENT+d).toFixed(0),b=b+" + "+e;return"this._structArray."+a.type.toLowerCase()+"["+b+"]"}var l=a("assert");k.exports=function(a){var b=JSON.stringify(a);if(e[b])return e[b];var k=
void 0===a.alignment?1:a.alignment,m=0,u=0,A=["Uint8"];a=a.members.map(function(a){l(a.name.length);l(a.type in c);0>A.indexOf(a.type)&&A.push(a.type);var b=c[a.type].BYTES_PER_ELEMENT,d=m=f(m,Math.max(k,b)),e=a.components||1;u=Math.max(u,b);m+=b*e;return{name:a.name,type:a.type,components:e,offset:d}});var y=f(m,Math.max(u,k)),t=function(a){function b(){a.apply(this,arguments)}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);return b.prototype.constructor=b}(g);t.prototype.alignment=
k;t.prototype.size=y;for(var v=0;v<a.length;v+=1)for(var B=a[v],w=0;w<B.components;w++)Object.defineProperty(t.prototype,B.name+(1===B.components?"":w),{get:new Function("return "+n(B,w)+";"),set:new Function("x",n(B,w)+" = x;")});v=function(a){function b(){a.apply(this,arguments)}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);return b.prototype.constructor=b}(h);v.prototype.members=a;v.prototype.StructType=t;v.prototype.bytesPerElement=y;v.prototype.emplaceBack=d(a,y);v.prototype._usedTypes=
A;return e[b]=v};var c={Int8:Int8Array,Uint8:Uint8Array,Uint8Clamped:Uint8ClampedArray,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array,Float64:Float64Array},g=function(a,c){this._structArray=a;this._pos1=c*this.size;this._pos2=this._pos1/2;this._pos4=this._pos1/4;this._pos8=this._pos1/8},h=function(a){this.isTransferred=!1;void 0!==a?(this.arrayBuffer=a.arrayBuffer,this.length=a.length,this.capacity=this.arrayBuffer.byteLength/this.bytesPerElement,this._refreshViews()):
(this.capacity=-1,this.resize(0))};h.serialize=function(){return{members:this.prototype.members,alignment:this.prototype.StructType.prototype.alignment,bytesPerElement:this.prototype.bytesPerElement}};h.prototype.serialize=function(a){l(!this.isTransferred);this._trim();a&&(this.isTransferred=!0,a.push(this.arrayBuffer));return{length:this.length,arrayBuffer:this.arrayBuffer}};h.prototype.get=function(a){l(!this.isTransferred);return new this.StructType(this,a)};h.prototype._trim=function(){this.length!==
this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())};h.prototype.resize=function(a){l(!this.isTransferred);this.length=a;a>this.capacity&&(this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement),a=this.uint8,this._refreshViews(),a&&this.uint8.set(a))};h.prototype._refreshViews=function(){for(var a=0,d=this._usedTypes;a<d.length;a+=1){var e=
d[a];this[e.toLowerCase()]=new c[e](this.arrayBuffer)}};h.prototype.toArray=function(a,c){l(!this.isTransferred);for(var b=[],d=a;d<c;d++){var e=this.get(d);b.push(e)}return b};var e={}},{assert:5}],215:[function(a,k,m){var f=a("./browser");a=function(a,f){this.frequency=a;this.throttledFunction=f;this.lastInvocation=0};a.prototype.invoke=function(){var a=this;if(!this.pendingInvocation){var k=0===this.lastInvocation?0:this.lastInvocation+this.frequency-f.now();0>=k?(this.lastInvocation=f.now(),this.throttledFunction()):
this.pendingInvocation=setTimeout(function(){a.pendingInvocation=void 0;a.lastInvocation=f.now();a.throttledFunction()},k)}};a.prototype.stop=function(){this.pendingInvocation&&(clearTimeout(this.pendingInvocation),this.pendingInvocation=void 0)};k.exports=a},{"./browser":196}],216:[function(a,k,m){k.exports=function(a,d){return d.replace(/{([^{}]+)}/g,function(d,f){return f in a?a[f]:""})}},{}],217:[function(a,k,m){var f=a("@mapbox/unitbezier"),d=a("../geo/coordinate");a("point-geometry");m.easeCubicInOut=
function(a){if(0>=a)return 0;if(1<=a)return 1;var c=a*a,d=c*a;return 4*(.5>a?d:3*(a-c)+d-.75)};m.bezier=function(a,d,h,e){var b=new f(a,d,h,e);return function(a){return b.solve(a)}};m.ease=m.bezier(.25,.1,.25,1);m.clamp=function(a,d,f){return Math.min(f,Math.max(d,a))};m.wrap=function(a,d,f){var c=f-d;a=((a-d)%c+c)%c+d;return a===d?f:a};m.asyncAll=function(a,d,f){if(!a.length)return f(null,[]);var c=a.length,b=Array(a.length),g=null;a.forEach(function(a,e){d(a,function(a,d){a&&(g=a);b[e]=d;0===--c&&
f(g,b)})})};m.values=function(a){var c=[],d;for(d in a)c.push(a[d]);return c};m.keysDifference=function(a,d){var c=[],e;for(e in a)e in d||c.push(e);return c};m.extend=function(a){for(var c=[],d=arguments.length-1;0<d--;)c[d]=arguments[d+1];for(d=0;d<c.length;d+=1){var e=c[d],b;for(b in e)a[b]=e[b]}return a};m.pick=function(a,d){for(var c={},e=0;e<d.length;e++){var b=d[e];b in a&&(c[b]=a[b])}return c};var n=1;m.uniqueId=function(){return n++};m.bindAll=function(a,d){a.forEach(function(a){d[a]&&(d[a]=
d[a].bind(d))})};m.getCoordinatesCenter=function(a){for(var c=Infinity,f=Infinity,e=-Infinity,b=-Infinity,k=0;k<a.length;k++)c=Math.min(c,a[k].column),f=Math.min(f,a[k].row),e=Math.max(e,a[k].column),b=Math.max(b,a[k].row);a=Math.max(0,Math.floor(-Math.log(Math.max(e-c,b-f))/Math.LN2));return(new d((c+e)/2,(f+b)/2,0)).zoomTo(a)};m.endsWith=function(a,d){return-1!==a.indexOf(d,a.length-d.length)};m.mapObject=function(a,d,f){var c={},b;for(b in a)c[b]=d.call(f||this,a[b],b,a);return c};m.filterObject=
function(a,d,f){var c={},b;for(b in a)d.call(f||this,a[b],b,a)&&(c[b]=a[b]);return c};m.deepEqual=function(a,d){if(Array.isArray(a)){if(!Array.isArray(d)||a.length!==d.length)return!1;for(var c=0;c<a.length;c++)if(!m.deepEqual(a[c],d[c]))return!1;return!0}if("object"===typeof a&&null!==a&&null!==d){if("object"!==typeof d||Object.keys(a).length!==Object.keys(d).length)return!1;for(c in a)if(!m.deepEqual(a[c],d[c]))return!1;return!0}return a===d};m.clone=function(a){return Array.isArray(a)?a.map(m.clone):
"object"===typeof a&&a?m.mapObject(a,m.clone):a};m.arraysIntersect=function(a,d){for(var c=0;c<a.length;c++)if(0<=d.indexOf(a[c]))return!0;return!1};var l={};m.warnOnce=function(a){l[a]||("undefined"!==typeof console&&console.warn(a),l[a]=!0)};m.isCounterClockwise=function(a,d,f){return(f.y-a.y)*(d.x-a.x)>(d.y-a.y)*(f.x-a.x)};m.calculateSignedArea=function(a){for(var c=0,d=0,e=a.length,b=e-1,f;d<e;b=d++)f=a[d],b=a[b],c+=(b.x-f.x)*(f.y+b.y);return c};m.isClosedPolygon=function(a){if(4>a.length)return!1;
var c=a[0],d=a[a.length-1];return 0<Math.abs(c.x-d.x)||0<Math.abs(c.y-d.y)?!1:.01<Math.abs(m.calculateSignedArea(a))};m.sphericalToCartesian=function(a){var c=a[0],d=a[1];a=a[2];d=Math.PI/180*(d+90);a*=Math.PI/180;return[c*Math.cos(d)*Math.sin(a),c*Math.sin(d)*Math.sin(a),c*Math.cos(a)]};m.parseCacheControl=function(a){var c={};a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(a,
d,b,f){a=b||f;c[d]=a?a.toLowerCase():!0;return""});c["max-age"]&&(a=parseInt(c["max-age"],10),isNaN(a)?delete c["max-age"]:c["max-age"]=a);return c}},{"../geo/coordinate":61,"@mapbox/unitbezier":3,"point-geometry":26}],218:[function(a,k,m){a=function(a,d,k,l){this.type="Feature";this._vectorTileFeature=a;a._z=d;a._x=k;a._y=l;this.properties=a.properties;null!=a.id&&(this.id=a.id)};m={geometry:{}};m.geometry.get=function(){void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,
this._vectorTileFeature._y,this._vectorTileFeature._z).geometry);return this._geometry};m.geometry.set=function(a){this._geometry=a};a.prototype.toJSON=function(){var a={geometry:this.geometry},d;for(d in this)"_geometry"!==d&&"_vectorTileFeature"!==d&&(a[d]=this[d]);return a};Object.defineProperties(a.prototype,m);k.exports=a},{}],219:[function(a,k,m){var f=a("./script_detection");k.exports=function(a){for(var d="",l=0;l<a.length;l++)var c=a.charCodeAt(l+1)||null,g=a.charCodeAt(l-1)||null,d=c&&f.charHasRotatedVerticalOrientation(c)&&
!k.exports.lookup[a[l+1]]||g&&f.charHasRotatedVerticalOrientation(g)&&!k.exports.lookup[a[l-1]]||!k.exports.lookup[a[l]]?d+a[l]:d+k.exports.lookup[a[l]];return d};k.exports.lookup={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33",
"`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\u00a2":"\uffe0","\u00a3":"\uffe1","\u00a5":"\uffe5","\u00a6":"\uffe4","\u00ac":"\uffe2","\u00af":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44",
"\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"}},
{"./script_detection":212}],220:[function(a,k,m){var f=a("assert"),d=a("./web_worker");m=function(){this.active={}};m.prototype.acquire=function(k){if(!this.workers){var l=a("../").workerCount;f("number"===typeof l&&Infinity>l);for(this.workers=[];this.workers.length<l;)this.workers.push(new d)}this.active[k]=!0;return this.workers.slice()};m.prototype.release=function(a){delete this.active[a];0===Object.keys(this.active).length&&(this.workers.forEach(function(a){a.terminate()}),this.workers=null)};
k.exports=m},{"../":65,"./web_worker":197,assert:5}]},{},[65])(65)});
